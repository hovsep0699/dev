{"ast":null,"code":"import _toConsumableArray from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import React from'react';import AdminSection from'./AdminSection';import ObservableComponent from\"../../../observableComponent/observableComponent\";import{useDialog}from'../../dashboard/modals/useDialog';import GlobalVariadicForm from\"../../../components/forms/GlobalVariadicForm\";import ModalFormFooter from\"../../../widgets/ModlFormFooter\";import{principaloptionsvalues}from\"../../../constants/options/options\";import{PrincipalULAdminTypeOptions}from\"../../../constants/initialValues/PrincipalFormInitialValues\";import{serviceLocator}from\"../../../../di/app_component\";import GeneralSectionOptions from\"../../Sections/page/GeneralSectionOptions\";var PrincipalSection=function PrincipalSection(_ref){var principals=_ref.principals,presenter=_ref.presenter,principalManager=_ref.principalManager,baseWidth=_ref.baseWidth,showAdminForm=_ref.showAdminForm,expandedWidth=_ref.expandedWidth;// const [testPrincipal, setTestPrincipal] = useState(manager.getPrincipals());\n//\n// useEffect(() => {\n//   setTestPrincipal(manager.getPrincipals());\n// }, [testPrincipal]);\nconsole.log(\"[[[[[[[[[]]]]]]]]]]\",principals);var _useDialog=useDialog(),hideDialog=_useDialog.hideDialog,openDialog=_useDialog.openDialog;var _handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(formData,index,isEditMode){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(isEditMode){principalManager.editPrincipal(index,formData);}else principalManager.addPrincipal(formData);presenter.update();console.log(\"principals-----------------\");console.log(principalManager.getPrincipals());// setTestPrincipal(manager.getPrincipals());\nconsole.log(principalManager.getPrincipals());hideDialog();case 6:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x,_x2,_x3){return _ref2.apply(this,arguments);};}();var showForm=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e,index,isEditMode){var selelctedPrincipal;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return principalManager.getPrincipals()[index];case 2:selelctedPrincipal=_context2.sent;// console.log(\";;;;;;;;;;;;;;;;;;;;;;;;;;;\",selelctedPrincipal.getFields() ?? '');\nopenDialog({alignment:\"center\",content:/*#__PURE__*/React.createElement(ObservableComponent,{builder:function builder(state){var _selelctedPrincipal$g;return/*#__PURE__*/React.createElement(GlobalVariadicForm,{isSubmitting:state.isSubmitting,onStateChange:presenter.onFormStateChange,defaultValues:(_selelctedPrincipal$g=selelctedPrincipal===null||selelctedPrincipal===void 0?void 0:selelctedPrincipal.getFields())!==null&&_selelctedPrincipal$g!==void 0?_selelctedPrincipal$g:'',initialFields:principaloptionsvalues,formTypes:PrincipalULAdminTypeOptions,handleSubmit:function handleSubmit(e){return _handleSubmit(e,index,isEditMode);},close:hideDialog});},create:function create(){return presenter;}}),position:\"fixed\",maxHeight:\"90%\",width:\"704px\",footer:/*#__PURE__*/React.createElement(ModalFormFooter,{state:presenter.getState()}),// positionOffset: {\n//   top: \"10%\",\n//   left: \"10%\"\n//\n// },\ntitle:'Поиск по МЧД'},e);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function showForm(_x4,_x5,_x6){return _ref3.apply(this,arguments);};}();// const [admin, setAdmin] = useState<object[]>([]);\n// const [selectedAdmin, setSelectedAdmin] = useState(null);\n// const [isModalOpen, setIsModalOpen] = useState(false);\nvar handleRemovePrincipal=function handleRemovePrincipal(index){var updatedPrincipals=_toConsumableArray(presenter.getState().principals);updatedPrincipals.splice(index,1);principalManager.removePrincipal(index);// setTestPrincipal(manager.getPrincipals().splice(index, 1));\npresenter.update();console.log(\"principals-----------------\");console.log(principalManager.getPrincipals());console.log(\"removed\");};console.log(\"principals\");console.log();return/*#__PURE__*/React.createElement(ObservableComponent,{builder:function builder(state){return/*#__PURE__*/React.createElement(GeneralSectionOptions,{presenter:serviceLocator.get(\"SectionPresenter\"),sectionData:state.principals,onShowForm:function onShowForm(e,index){return showForm(e,index,false);},onRemove:handleRemovePrincipal,onEdit:function onEdit(e,index){return showForm(e,index,true);},baseWidth:baseWidth,expandedWidth:expandedWidth,isRequired:true,sectionTitle:\"Доверитель\",getInn:function getInn(section){return section.getFields()[\"inn\"];},builder:function builder(index,principal){return(principal===null||principal===void 0?void 0:principal.getFields()[\"type\"])!=='IP'&&/*#__PURE__*/React.createElement(AdminSection,{principalManager:serviceLocator.get(\"PrincipalManager\"),presenter:presenter,admin:principal.getAdmins(),principalIndex:index});}});},create:function create(){return presenter;}});};export default PrincipalSection;","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/POA/MCHD_ROOT/presentation/pages/SubTrust/sections/PrincipalSection.tsx"],"names":["React","AdminSection","ObservableComponent","useDialog","GlobalVariadicForm","ModalFormFooter","principaloptionsvalues","PrincipalULAdminTypeOptions","serviceLocator","GeneralSectionOptions","PrincipalSection","principals","presenter","principalManager","baseWidth","showAdminForm","expandedWidth","console","log","hideDialog","openDialog","handleSubmit","formData","index","isEditMode","editPrincipal","addPrincipal","update","getPrincipals","showForm","e","selelctedPrincipal","alignment","content","state","isSubmitting","onFormStateChange","getFields","position","maxHeight","width","footer","getState","title","handleRemovePrincipal","updatedPrincipals","splice","removePrincipal","get","section","principal","getAdmins"],"mappings":"sgBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,YAAP,KAAyB,gBAAzB,CACA,MAAOC,CAAAA,mBAAP,KAAgC,kDAAhC,CACA,OAASC,SAAT,KAA0B,kCAA1B,CACA,MAAOC,CAAAA,kBAAP,KAA+B,8CAA/B,CACA,MAAOC,CAAAA,eAAP,KAA4B,iCAA5B,CAIA,OAAQC,sBAAR,KAAqC,oCAArC,CACA,OAAQC,2BAAR,KAA0C,6DAA1C,CAEA,OAAQC,cAAR,KAA6B,8BAA7B,CACA,MAAOC,CAAAA,qBAAP,KAAkC,2CAAlC,CAcA,GAAOC,CAAAA,gBAAiD,CAAG,QAApDA,CAAAA,gBAAoD,MAAgH,IAA9GC,CAAAA,UAA8G,MAA9GA,UAA8G,CAAlGC,SAAkG,MAAlGA,SAAkG,CAAvFC,gBAAuF,MAAvFA,gBAAuF,CAArEC,SAAqE,MAArEA,SAAqE,CAA1DC,aAA0D,MAA1DA,aAA0D,CAA3CC,aAA2C,MAA3CA,aAA2C,CAEzK;AACA;AACA;AACA;AACA;AAEFC,OAAO,CAACC,GAAR,CAAY,qBAAZ,CAAkCP,UAAlC,EAR2K,eAWtIR,SAAS,EAX6H,CAWjKgB,UAXiK,YAWjKA,UAXiK,CAWrJC,UAXqJ,YAWrJA,UAXqJ,CAazK,GAAMC,CAAAA,aAAY,2FAAE,iBAAQC,QAAR,CAAsBC,KAAtB,CAAqCC,UAArC,kHAClB,GAAGA,UAAH,CAAc,CACVX,gBAAgB,CAACY,aAAjB,CAA+BF,KAA/B,CAAsCD,QAAtC,EACH,CAFD,IAIIT,CAAAA,gBAAgB,CAACa,YAAjB,CAA8BJ,QAA9B,EAEFV,SAAS,CAACe,MAAV,GACAV,OAAO,CAACC,GAAR,CAAY,6BAAZ,EACAD,OAAO,CAACC,GAAR,CAAYL,gBAAgB,CAACe,aAAjB,EAAZ,EAEA;AACAX,OAAO,CAACC,GAAR,CAAYL,gBAAgB,CAACe,aAAjB,EAAZ,EACAT,UAAU,GAbM,sDAAF,kBAAZE,CAAAA,YAAY,qDAAlB,CAiBA,GAAMQ,CAAAA,QAAQ,2FAAG,kBAAMC,CAAN,CAAcP,KAAd,CAA6BC,UAA7B,oKACiBX,CAAAA,gBAAgB,CAACe,aAAjB,GAAiCL,KAAjC,CADjB,QACTQ,kBADS,gBAEf;AAEAX,UAAU,CAAC,CACPY,SAAS,CAAE,QADJ,CAEPC,OAAO,cACH,oBAAC,mBAAD,EACI,OAAO,CAAE,iBAACC,KAAD,+CACL,oBAAC,kBAAD,EACI,YAAY,CAAEA,KAAK,CAACC,YADxB,CAEI,aAAa,CAAEvB,SAAS,CAACwB,iBAF7B,CAGI,aAAa,wBAAEL,kBAAF,SAAEA,kBAAF,iBAAEA,kBAAkB,CAAEM,SAApB,EAAF,+DAAqC,EAHtD,CAII,aAAa,CAAE/B,sBAJnB,CAKI,SAAS,CAAEC,2BALf,CAMI,YAAY,CAAE,sBAACuB,CAAD,QAAUT,CAAAA,aAAY,CAACS,CAAD,CAAIP,KAAJ,CAAWC,UAAX,CAAtB,EANlB,CAOI,KAAK,CAAEL,UAPX,EADK,EADb,CAYI,MAAM,CAAE,wBAAIP,CAAAA,SAAJ,EAZZ,EAHG,CAiBP0B,QAAQ,CAAE,OAjBH,CAkBPC,SAAS,CAAE,KAlBJ,CAmBPC,KAAK,CAAE,OAnBA,CAoBPC,MAAM,cAAE,oBAAC,eAAD,EAAiB,KAAK,CAAE7B,SAAS,CAAC8B,QAAV,EAAxB,EApBD,CAqBP;AACA;AACA;AACA;AACA;AACAC,KAAK,CAAE,cA1BA,CAAD,CA2BPb,CA3BO,CAAV,CAJe,wDAAH,kBAARD,CAAAA,QAAQ,sDAAd,CAmCA;AACA;AACA;AAEA,GAAMe,CAAAA,qBAAqB,CAAG,QAAxBA,CAAAA,qBAAwB,CAACrB,KAAD,CAAmB,CAC/C,GAAMsB,CAAAA,iBAAiB,oBAAOjC,SAAS,CAAC8B,QAAV,GAAqB/B,UAA5B,CAAvB,CACAkC,iBAAiB,CAACC,MAAlB,CAAyBvB,KAAzB,CAAgC,CAAhC,EACAV,gBAAgB,CAACkC,eAAjB,CAAiCxB,KAAjC,EACA;AACAX,SAAS,CAACe,MAAV,GACAV,OAAO,CAACC,GAAR,CAAY,6BAAZ,EACAD,OAAO,CAACC,GAAR,CAAYL,gBAAgB,CAACe,aAAjB,EAAZ,EACAX,OAAO,CAACC,GAAR,CAAY,SAAZ,EAED,CAVD,CAYAD,OAAO,CAACC,GAAR,CAAY,YAAZ,EACAD,OAAO,CAACC,GAAR,GAIA,mBACE,oBAAC,mBAAD,EACI,OAAO,CAAE,iBAACgB,KAAD,qBACL,oBAAC,qBAAD,EACI,SAAS,CAAE1B,cAAc,CAACwC,GAAf,CAAqC,kBAArC,CADf,CAEI,WAAW,CAAEd,KAAK,CAACvB,UAFvB,CAGI,UAAU,CAAE,oBAACmB,CAAD,CAASP,KAAT,QAAwBM,CAAAA,QAAQ,CAACC,CAAD,CAAIP,KAAJ,CAAW,KAAX,CAAhC,EAHhB,CAII,QAAQ,CAAEqB,qBAJd,CAKI,MAAM,CAAE,gBAACd,CAAD,CAASP,KAAT,QAAwBM,CAAAA,QAAQ,CAACC,CAAD,CAAIP,KAAJ,CAAW,IAAX,CAAhC,EALZ,CAMI,SAAS,CAAET,SANf,CAOI,aAAa,CAAEE,aAPnB,CAQI,UAAU,CAAE,IARhB,CASI,YAAY,CAAE,YATlB,CAUI,MAAM,CAAE,gBAACiC,OAAD,QAAiBA,CAAAA,OAAO,CAACZ,SAAR,GAAoB,KAApB,CAAjB,EAVZ,CAWI,OAAO,CAAE,iBAACd,KAAD,CAAgB2B,SAAhB,CAAiC,CACtC,MAAO,CAAAA,SAAS,OAAT,EAAAA,SAAS,SAAT,QAAAA,SAAS,CAAEb,SAAX,GAAuB,MAAvB,KAAmC,IAAnC,eACH,oBAAC,YAAD,EACI,gBAAgB,CAAE7B,cAAc,CAACwC,GAAf,CAAqC,kBAArC,CADtB,CAEI,SAAS,CAAEpC,SAFf,CAGI,KAAK,CAAEsC,SAAS,CAACC,SAAV,EAHX,CAII,cAAc,CAAE5B,KAJpB,EADJ,CAOE,CAnBV,EADK,EADb,CAyBI,MAAM,CAAE,wBAAIX,CAAAA,SAAJ,EAzBZ,EADF,CA6BD,CAnHD,CAqHA,cAAeF,CAAAA,gBAAf","sourcesContent":["import React from 'react';\r\nimport AdminSection from './AdminSection';\r\nimport ObservableComponent from \"../../../observableComponent/observableComponent\";\r\nimport { useDialog } from '../../dashboard/modals/useDialog';\r\nimport GlobalVariadicForm from \"../../../components/forms/GlobalVariadicForm\";\r\nimport ModalFormFooter from \"../../../widgets/ModlFormFooter\";\r\nimport {PrincipalManager} from \"../../../../core/PrincipalManager\";\r\nimport {Principal} from \"../../../../domain/model/Principal\";\r\nimport {SubTrustPresenter} from \"../presenter/SubTrustPresenter\";\r\nimport {principaloptionsvalues} from \"../../../constants/options/options\";\r\nimport {PrincipalULAdminTypeOptions} from \"../../../constants/initialValues/PrincipalFormInitialValues\";\r\nimport {SubTrustPresenterState} from \"../presenter/SubTrustPresenterState\";\r\nimport {serviceLocator} from \"../../../../di/app_component\";\r\nimport GeneralSectionOptions from \"../../Sections/page/GeneralSectionOptions\";\r\nimport {SectionPresenter} from \"../../Sections/presenter/SectionPresenter\";\r\nimport {SubTrustPresenterViewModel} from \"../presenter/SubTrustPresenterViewModel\";\r\n\r\ninterface PrincipalSectionProps {\r\n    principals: Principal[];\r\n\r\n    baseWidth?: string;\r\n    principalManager: PrincipalManager;\r\n    presenter: SubTrustPresenter;\r\n    showAdminForm?: (e: any)=>void;\r\n    expandedWidth?: string;\r\n}\r\n\r\nconst  PrincipalSection: React.FC<PrincipalSectionProps> = ({principals, presenter, principalManager, baseWidth, showAdminForm, expandedWidth }: PrincipalSectionProps) => {\r\n\r\n  // const [testPrincipal, setTestPrincipal] = useState(manager.getPrincipals());\r\n  //\r\n  // useEffect(() => {\r\n  //   setTestPrincipal(manager.getPrincipals());\r\n  // }, [testPrincipal]);\r\n\r\nconsole.log(\"[[[[[[[[[]]]]]]]]]]\",principals);\r\n\r\n\r\n  const { hideDialog, openDialog } = useDialog();\r\n\r\n  const handleSubmit =async ( formData: any,index: number, isEditMode: boolean) => {\r\n    if(isEditMode){\r\n        principalManager.editPrincipal(index, formData);\r\n    }\r\n    else\r\n        principalManager.addPrincipal(formData);\r\n    \r\n      presenter.update();\r\n      console.log(\"principals-----------------\");\r\n      console.log(principalManager.getPrincipals());\r\n      \r\n      // setTestPrincipal(manager.getPrincipals());\r\n      console.log(principalManager.getPrincipals());\r\n      hideDialog();\r\n      \r\n  };\r\n\r\n  const showForm = async(e: any, index: number, isEditMode: boolean) => {\r\n    const selelctedPrincipal =await principalManager.getPrincipals()[index];\r\n    // console.log(\";;;;;;;;;;;;;;;;;;;;;;;;;;;\",selelctedPrincipal.getFields() ?? '');\r\n    \r\n    openDialog({\r\n        alignment: \"center\",\r\n        content:\r\n            <ObservableComponent<SubTrustPresenterViewModel, SubTrustPresenterState, SubTrustPresenter>\r\n                builder={(state)=>(\r\n                    <GlobalVariadicForm\r\n                        isSubmitting={state.isSubmitting}\r\n                        onStateChange={presenter.onFormStateChange}\r\n                        defaultValues={selelctedPrincipal?.getFields() ?? ''}\r\n                        initialFields={principaloptionsvalues}\r\n                        formTypes={PrincipalULAdminTypeOptions}\r\n                        handleSubmit={(e: any)=>handleSubmit(e, index, isEditMode)}\r\n                        close={hideDialog}\r\n                    />\r\n                )}\r\n                create={()=>presenter}\r\n            />,\r\n        position: \"fixed\",\r\n        maxHeight: \"90%\",\r\n        width: \"704px\",\r\n        footer: <ModalFormFooter state={presenter.getState()}/>,\r\n        // positionOffset: {\r\n        //   top: \"10%\",\r\n        //   left: \"10%\"\r\n        //\r\n        // },\r\n        title: 'Поиск по МЧД',\r\n    }, e)\r\n}\r\n\r\n\r\n  // const [admin, setAdmin] = useState<object[]>([]);\r\n  // const [selectedAdmin, setSelectedAdmin] = useState(null);\r\n  // const [isModalOpen, setIsModalOpen] = useState(false);\r\n\r\n  const handleRemovePrincipal = (index: number) => {\r\n    const updatedPrincipals = [...presenter.getState().principals];\r\n    updatedPrincipals.splice(index, 1);\r\n    principalManager.removePrincipal(index);\r\n    // setTestPrincipal(manager.getPrincipals().splice(index, 1));\r\n    presenter.update();\r\n    console.log(\"principals-----------------\");\r\n    console.log(principalManager.getPrincipals());\r\n    console.log(\"removed\");\r\n    \r\n  };\r\n\r\n  console.log(\"principals\");\r\n  console.log();\r\n\r\n\r\n  \r\n  return (\r\n    <ObservableComponent<SubTrustPresenterViewModel, SubTrustPresenterState, SubTrustPresenter>\r\n        builder={(state: SubTrustPresenterState)=>(\r\n            <GeneralSectionOptions\r\n                presenter={serviceLocator.get<SectionPresenter>(\"SectionPresenter\")}\r\n                sectionData={state.principals}\r\n                onShowForm={(e: any, index:number)=>showForm(e, index, false)}\r\n                onRemove={handleRemovePrincipal}\r\n                onEdit={(e: any, index:number)=>showForm(e, index, true)}\r\n                baseWidth={baseWidth}\r\n                expandedWidth={expandedWidth}\r\n                isRequired={true}\r\n                sectionTitle={\"Доверитель\"}\r\n                getInn={(section: any)=> section.getFields()[\"inn\"]}\r\n                builder={(index: number, principal: any)=>{\r\n                    return principal?.getFields()[\"type\"] !== 'IP' && (\r\n                        <AdminSection\r\n                            principalManager={serviceLocator.get<PrincipalManager>(\"PrincipalManager\")}\r\n                            presenter={presenter}\r\n                            admin={principal.getAdmins()}\r\n                            principalIndex={index}\r\n                        />\r\n                    )}\r\n                }\r\n            />\r\n        )}\r\n        create={()=>presenter}\r\n    />\r\n  );\r\n}\r\n\r\nexport default PrincipalSection;\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}