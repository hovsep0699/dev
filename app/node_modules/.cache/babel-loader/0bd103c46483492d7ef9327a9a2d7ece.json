{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React from'react';import{useDispatch,useSelector}from'react-redux';import{Modal,Button,Icons}from'@distate/components';import'./style.css';import{Pagination}from'../../../../common/pagination';import{getContractorGroups,deleteContractorGroup,getCompanyInfo}from'../../store/actions';import{currentContractor as currentContractorSelector}from'../../store/selectors';import{SubModalGroups}from'./SubModalGroups';import{addressToString}from'../../helpers/contractors.helpers';import{DestinationType}from'../../helpers/contractors.typings';/** Карточка контрагента ЮЛ */export var LegalEntityCard=function LegalEntityCard(props){var _currentContractor$gr,_currentContractor$gr2;var isVisible=props.isVisible,_hide=props.hide,userId=props.userId,contractorId=props.contractorId;var dispatch=useDispatch();var currentContractor=useSelector(currentContractorSelector);var rows=(currentContractor===null||currentContractor===void 0?void 0:(_currentContractor$gr=currentContractor.groups)===null||_currentContractor$gr===void 0?void 0:_currentContractor$gr.rows)||[];var _ref=currentContractor.company||{},name=_ref.name,fnsUid=_ref.fnsUid,inn=_ref.inn,kpp=_ref.kpp,ogrn=_ref.ogrn,taxAuthorityCode=_ref.taxAuthorityCode,taxAuthorityTitle=_ref.taxAuthorityTitle,addressIsStrict=_ref.addressIsStrict,addressLooselyTypedAddress=_ref.addressLooselyTypedAddress,addressCountryTitle=_ref.addressCountryTitle,addressRegionTitle=_ref.addressRegionTitle,addressPostalCode=_ref.addressPostalCode,addressDistrict=_ref.addressDistrict,addressCity=_ref.addressCity,addressSettlement=_ref.addressSettlement,addressStreet=_ref.addressStreet,addressHouse=_ref.addressHouse,addressBuilding=_ref.addressBuilding,addressRoom=_ref.addressRoom,bankBik=_ref.bankBik,bankTitle=_ref.bankTitle,accountNumber=_ref.accountNumber,externalType=_ref.externalType,externalOperator=_ref.externalOperator,network=_ref.network;var _React$useState=React.useState(),_React$useState2=_slicedToArray(_React$useState,2),offset=_React$useState2[0],setOffset=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),isOpenSubmodal=_React$useState4[0],setIsOpenSubmodal=_React$useState4[1];var address=addressIsStrict?addressToString([addressCountryTitle,addressPostalCode,addressRegionTitle,addressDistrict,addressCity,addressSettlement,addressStreet,addressHouse,addressBuilding,addressRoom]):addressLooselyTypedAddress;React.useEffect(function(){/** получение списка групп контрагента */contractorId&&dispatch(getContractorGroups({id:contractorId,offset:offset,limit:10}));/** получение информации о контрагенте */userId&&dispatch(getCompanyInfo(userId));},[dispatch,userId,offset,contractorId]);var onDeleteGroup=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(groupId){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return dispatch(deleteContractorGroup({groupId:groupId,contractorId:contractorId}));case 2:_context.next=4;return dispatch(getContractorGroups({id:contractorId,offset:offset,limit:10}));case 4:case\"end\":return _context.stop();}}},_callee);}));return function onDeleteGroup(_x){return _ref2.apply(this,arguments);};}();var onAddGroup=function onAddGroup(){setIsOpenSubmodal(true);};/** обработчик закрытия модалки */var hideSubmodal=function hideSubmodal(){setIsOpenSubmodal(!isOpenSubmodal);dispatch(getContractorGroups({id:contractorId,offset:offset,limit:10}));};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Modal,{hide:function hide(){return _hide();},isVisible:isVisible},/*#__PURE__*/React.createElement(Modal.Header,{title:name}),/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(\"h3\",{className:\"header\"},\"\\u0418\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u044F \\u043E \\u043A\\u043E\\u043C\\u043F\\u0430\\u043D\\u0438\\u0438\"),/*#__PURE__*/React.createElement(\"table\",{className:\"natural-entity-card-table\"},/*#__PURE__*/React.createElement(\"tbody\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},\"\\u0418\\u0434\\u0435\\u043D\\u0442\\u0438\\u0444\\u0438\\u043A\\u0430\\u0442\\u043E\\u0440 \\u042D\\u0414\\u041E\"),/*#__PURE__*/React.createElement(\"td\",null,fnsUid)),/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},\"\\u0418\\u041D\\u041D\",kpp&&'/КПП'),/*#__PURE__*/React.createElement(\"td\",null,inn,kpp&&\" / \".concat(kpp))),ogrn&&/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},\"\\u041E\\u0413\\u0420\\u041D\"),/*#__PURE__*/React.createElement(\"td\",null,ogrn)),taxAuthorityCode&&taxAuthorityTitle&&/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},\"\\u041A\\u043E\\u0434 \\u043D\\u0430\\u043B\\u043E\\u0433\\u043E\\u0432\\u043E\\u0433\\u043E \\u043E\\u0440\\u0433\\u0430\\u043D\\u0430\"),/*#__PURE__*/React.createElement(\"td\",null,taxAuthorityCode&&taxAuthorityCode+' ',taxAuthorityTitle&&taxAuthorityTitle+' ')),address&&/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},\"\\u0410\\u0434\\u0440\\u0435\\u0441\"),/*#__PURE__*/React.createElement(\"td\",null,address)),bankBik&&bankTitle&&/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},\"\\u0411\\u0430\\u043D\\u043A\"),/*#__PURE__*/React.createElement(\"td\",null,bankBik&&bankBik+' ',bankTitle&&bankTitle)),accountNumber&&/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},\"\\u0420\\u0430\\u0441\\u0441\\u0447\\u0435\\u0442\\u043D\\u044B\\u0439 \\u0441\\u0447\\u0435\\u0442\"),/*#__PURE__*/React.createElement(\"td\",null,accountNumber)),externalType===DestinationType.LoaclRoaming&&/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},\"\\u0422\\u0438\\u043F\"),/*#__PURE__*/React.createElement(\"td\",null,\"\\u041B\\u043E\\u043A\\u0430\\u043B\\u044C\\u043D\\u044B\\u0439 \\u0440\\u043E\\u0443\\u043C\\u0438\\u043D\\u0433\",' '+network&&network)),externalType===DestinationType.Hub1c&&/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},\"\\u0422\\u0438\\u043F\"),/*#__PURE__*/React.createElement(\"td\",null,\"1\\u0421-\\u042D\\u0414\\u041E\",' '+externalOperator&&externalOperator)),externalType===DestinationType.Roaming&&/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},\"\\u0422\\u0438\\u043F\"),/*#__PURE__*/React.createElement(\"td\",null,\"\\u0420\\u043E\\u0443\\u043C\\u0438\\u043D\\u0433\",' '+externalOperator&&externalOperator)))),/*#__PURE__*/React.createElement(\"h3\",{className:\"header\"},\"\\u0413\\u0440\\u0443\\u043F\\u043F\\u044B \\u043A\\u043E\\u043D\\u0442\\u0440\\u0430\\u0433\\u0435\\u043D\\u0442\\u0430\"),/*#__PURE__*/React.createElement(\"table\",{className:\"table\"},/*#__PURE__*/React.createElement(\"thead\",{className:\"common-table-head\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435\"),/*#__PURE__*/React.createElement(\"td\",null))),/*#__PURE__*/React.createElement(\"tbody\",null,rows.map(function(item){return/*#__PURE__*/React.createElement(\"tr\",{key:item.id},/*#__PURE__*/React.createElement(\"td\",null,item.title),/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},/*#__PURE__*/React.createElement(Button,{icon:/*#__PURE__*/React.createElement(Icons.IconTrash,{fill:\"currentColor\"}),onClick:function onClick(){return onDeleteGroup(item.id);}},\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\")));})),/*#__PURE__*/React.createElement(\"tfoot\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(Button,{icon:/*#__PURE__*/React.createElement(Icons.IconPlus,{fill:\"currentColor\"}),onClick:function onClick(){return onAddGroup();}},\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\")),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"pagination-right\"},/*#__PURE__*/React.createElement(Pagination,{listLength:currentContractor===null||currentContractor===void 0?void 0:(_currentContractor$gr2=currentContractor.groups)===null||_currentContractor$gr2===void 0?void 0:_currentContractor$gr2.recordsTotal,setOffset:setOffset})))))))),/*#__PURE__*/React.createElement(SubModalGroups,{contractorId:contractorId,isVisible:isOpenSubmodal,hide:hideSubmodal}));};","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/contractors/components/legal-entity/LegalEntityCard.tsx"],"names":["React","useDispatch","useSelector","Modal","Button","Icons","Pagination","getContractorGroups","deleteContractorGroup","getCompanyInfo","currentContractor","currentContractorSelector","SubModalGroups","addressToString","DestinationType","LegalEntityCard","props","isVisible","hide","userId","contractorId","dispatch","rows","groups","company","name","fnsUid","inn","kpp","ogrn","taxAuthorityCode","taxAuthorityTitle","addressIsStrict","addressLooselyTypedAddress","addressCountryTitle","addressRegionTitle","addressPostalCode","addressDistrict","addressCity","addressSettlement","addressStreet","addressHouse","addressBuilding","addressRoom","bankBik","bankTitle","accountNumber","externalType","externalOperator","network","useState","offset","setOffset","isOpenSubmodal","setIsOpenSubmodal","address","useEffect","id","limit","onDeleteGroup","groupId","onAddGroup","hideSubmodal","LoaclRoaming","Hub1c","Roaming","map","item","title","recordsTotal"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Modal, Button, Icons } from '@distate/components';\r\n\r\nimport './style.css';\r\nimport { Pagination } from '../../../../common/pagination';\r\nimport { getContractorGroups, deleteContractorGroup, getCompanyInfo } from '../../store/actions';\r\nimport { currentContractor as currentContractorSelector } from '../../store/selectors';\r\nimport { SubModalGroups } from './SubModalGroups';\r\nimport { addressToString } from '../../helpers/contractors.helpers';\r\nimport { DestinationType } from '../../helpers/contractors.typings';\r\n\r\ntype Props = {\r\n  isVisible: boolean;\r\n  hide: () => void;\r\n  userId: number;\r\n  contractorId: number;\r\n};\r\n\r\n/** Карточка контрагента ЮЛ */\r\nexport const LegalEntityCard = (props: Props) => {\r\n  const { isVisible, hide, userId, contractorId } = props;\r\n  const dispatch = useDispatch();\r\n\r\n  const currentContractor = useSelector(currentContractorSelector);\r\n  const rows = currentContractor?.groups?.rows || [];\r\n\r\n  const {\r\n    name,\r\n    fnsUid,\r\n    inn,\r\n    kpp,\r\n    ogrn,\r\n    taxAuthorityCode,\r\n    taxAuthorityTitle,\r\n    addressIsStrict,\r\n    addressLooselyTypedAddress,\r\n    addressCountryTitle,\r\n    addressRegionTitle,\r\n    addressPostalCode,\r\n    addressDistrict,\r\n    addressCity,\r\n    addressSettlement,\r\n    addressStreet,\r\n    addressHouse,\r\n    addressBuilding,\r\n    addressRoom,\r\n    bankBik,\r\n    bankTitle,\r\n    accountNumber,\r\n    externalType,\r\n    externalOperator,\r\n    network\r\n  } = currentContractor.company || {};\r\n\r\n  const [offset, setOffset] = React.useState();\r\n  const [isOpenSubmodal, setIsOpenSubmodal] = React.useState(false);\r\n\r\n  const address: string | undefined = addressIsStrict\r\n    ? addressToString([\r\n        addressCountryTitle,\r\n        addressPostalCode,\r\n        addressRegionTitle,\r\n        addressDistrict,\r\n        addressCity,\r\n        addressSettlement,\r\n        addressStreet,\r\n        addressHouse,\r\n        addressBuilding,\r\n        addressRoom\r\n      ])\r\n    : addressLooselyTypedAddress;\r\n\r\n  React.useEffect(() => {\r\n    /** получение списка групп контрагента */\r\n    contractorId && dispatch(getContractorGroups({ id: contractorId, offset, limit: 10 }));\r\n    /** получение информации о контрагенте */\r\n    userId && dispatch(getCompanyInfo(userId));\r\n  }, [dispatch, userId, offset, contractorId]);\r\n\r\n  const onDeleteGroup = async (groupId: number) => {\r\n    await dispatch(deleteContractorGroup({ groupId, contractorId }));\r\n    await dispatch(getContractorGroups({ id: contractorId, offset, limit: 10 }));\r\n  };\r\n\r\n  const onAddGroup = () => {\r\n    setIsOpenSubmodal(true);\r\n  };\r\n\r\n  /** обработчик закрытия модалки */\r\n  const hideSubmodal = () => {\r\n    setIsOpenSubmodal(!isOpenSubmodal);\r\n    dispatch(getContractorGroups({ id: contractorId, offset, limit: 10 }));\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Modal hide={() => hide()} isVisible={isVisible}>\r\n        <Modal.Header title={name} />\r\n        <Modal.Body>\r\n          <h3 className=\"header\">Информация о компании</h3>\r\n\r\n          <table className=\"natural-entity-card-table\">\r\n            <tbody>\r\n              <tr>\r\n                <td align=\"right\">Идентификатор ЭДО</td>\r\n                <td>{fnsUid}</td>\r\n              </tr>\r\n              <tr>\r\n                {/** у ИП нет КПП */}\r\n                <td align=\"right\">ИНН{kpp && '/КПП'}</td>\r\n                <td>\r\n                  {inn}\r\n                  {kpp && ` / ${kpp}`}\r\n                </td>\r\n              </tr>\r\n              {ogrn && (\r\n                <tr>\r\n                  <td align=\"right\">ОГРН</td>\r\n                  <td>{ogrn}</td>\r\n                </tr>\r\n              )}\r\n              {taxAuthorityCode && taxAuthorityTitle && (\r\n                <tr>\r\n                  <td align=\"right\">Код налогового органа</td>\r\n                  <td>\r\n                    {taxAuthorityCode && taxAuthorityCode + ' '}\r\n                    {taxAuthorityTitle && taxAuthorityTitle + ' '}\r\n                  </td>\r\n                </tr>\r\n              )}\r\n              {address && (\r\n                <tr>\r\n                  <td align=\"right\">Адрес</td>\r\n                  <td>{address}</td>\r\n                </tr>\r\n              )}\r\n              {bankBik && bankTitle && (\r\n                <tr>\r\n                  <td align=\"right\">Банк</td>\r\n                  <td>\r\n                    {bankBik && bankBik + ' '}\r\n                    {bankTitle && bankTitle}\r\n                  </td>\r\n                </tr>\r\n              )}\r\n              {accountNumber && (\r\n                <tr>\r\n                  <td align=\"right\">Рассчетный счет</td>\r\n                  <td>{accountNumber}</td>\r\n                </tr>\r\n              )}\r\n              {externalType === DestinationType.LoaclRoaming && (\r\n                <tr>\r\n                  <td align=\"right\">Тип</td>\r\n                  <td>Локальный роуминг{' ' + network && network}</td>\r\n                </tr>\r\n              )}\r\n              {externalType === DestinationType.Hub1c && (\r\n                <tr>\r\n                  <td align=\"right\">Тип</td>\r\n                  <td>1С-ЭДО{' ' + externalOperator && externalOperator}</td>\r\n                </tr>\r\n              )}\r\n              {externalType === DestinationType.Roaming && (\r\n                <tr>\r\n                  <td align=\"right\">Тип</td>\r\n                  <td>Роуминг{' ' + externalOperator && externalOperator}</td>\r\n                </tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n\r\n          <h3 className=\"header\">Группы контрагента</h3>\r\n\r\n          <table className=\"table\">\r\n            <thead className=\"common-table-head\">\r\n              <tr>\r\n                <td>Название</td>\r\n                <td></td>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {rows.map(item => (\r\n                <tr key={item.id}>\r\n                  <td>{item.title}</td>\r\n                  <td align=\"right\">\r\n                    <Button\r\n                      icon={<Icons.IconTrash fill=\"currentColor\" />}\r\n                      onClick={() => onDeleteGroup(item.id)}\r\n                    >\r\n                      Удалить\r\n                    </Button>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n            <tfoot>\r\n              <tr>\r\n                <td>\r\n                  <Button\r\n                    icon={<Icons.IconPlus fill=\"currentColor\" />}\r\n                    onClick={() => onAddGroup()}\r\n                  >\r\n                    Добавить\r\n                  </Button>\r\n                </td>\r\n                <td>\r\n                  <div className=\"pagination-right\">\r\n                    <Pagination\r\n                      listLength={currentContractor?.groups?.recordsTotal}\r\n                      setOffset={setOffset}\r\n                    />\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            </tfoot>\r\n          </table>\r\n        </Modal.Body>\r\n      </Modal>\r\n\r\n      <SubModalGroups contractorId={contractorId} isVisible={isOpenSubmodal} hide={hideSubmodal} />\r\n    </>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}