{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport CertificateHandler from './handlers/sign/CertificateHandler';\nimport RolesHandler from './handlers/sign/RolesHandler';\nimport ReceiptsHandler from './handlers/sign/ReceiptsHandler';\nimport SignDocumentsProcessHandler from './handlers/sign/SignDocumentsProcessHandler';\nimport SignReceiptsProcessHandler from './handlers/sign/SignReceiptsProcessHandler';\nimport SignContainerProcessHandler from './handlers/sign/SignContainerProcessHandler';\nimport DocumentContentHandler from './handlers/sign/DocumentContentHandler';\nimport CreateSignHandler from './handlers/sign/CreateSignHandler';\nimport SendSignHandler from './handlers/sign/SendSignHandler';\nimport SendDocumentHandler from './handlers/sign/SendDocumentHandler';\nimport SignEventManager from './SignEventManager';\nimport SignRequest from './SignRequest';\n\nvar SignService = /*#__PURE__*/function () {\n  function SignService() {\n    _classCallCheck(this, SignService);\n\n    this._isAborted = false;\n    this._events = new SignEventManager();\n\n    this._getSignAndSendReceiptsChain = function () {\n      var certificateHandler = new CertificateHandler();\n      var rolesHandler = new RolesHandler();\n      var receiptsHandler = new ReceiptsHandler();\n      var signProcessHandler = new SignReceiptsProcessHandler();\n      certificateHandler.setNext(rolesHandler).setNext(receiptsHandler).setNext(signProcessHandler);\n      return certificateHandler;\n    };\n\n    this._getSignAndSendDocumentsChain = function () {\n      var certificateHandler = new CertificateHandler();\n      var rolesHandler = new RolesHandler();\n      var signProcessHandler = new SignDocumentsProcessHandler();\n      certificateHandler.setNext(rolesHandler).setNext(signProcessHandler);\n      return certificateHandler;\n    };\n\n    this._getSignAndSendContainerChain = function () {\n      var certificateHandler = new CertificateHandler();\n      var rolesHandler = new RolesHandler();\n      var signProcessHandler = new SignContainerProcessHandler();\n      certificateHandler.setNext(rolesHandler).setNext(signProcessHandler);\n      return certificateHandler;\n    };\n\n    this._receiptsForSigningChain = function () {\n      var certificateHandler = new CertificateHandler();\n      var rolesHandler = new RolesHandler();\n      var receiptsHandler = new ReceiptsHandler();\n      certificateHandler.setNext(rolesHandler).setNext(receiptsHandler);\n      return certificateHandler;\n    };\n\n    this.signAndSendReceiptsChain = this._getSignAndSendReceiptsChain();\n    this.signAndSendDocumentsChain = this._getSignAndSendDocumentsChain();\n    this.signAndSendContainerChain = this._getSignAndSendContainerChain();\n    this.receiptsForSigningChain = this._receiptsForSigningChain();\n    this.events.subscribe('abortSigning', this.abortSigning.bind(this));\n  }\n\n  _createClass(SignService, [{\n    key: \"abortSigning\",\n    value: function abortSigning() {\n      this._isAborted = true;\n    }\n  }, {\n    key: \"resetIsAbortedFlag\",\n    value: function resetIsAbortedFlag() {\n      this._isAborted = false;\n    }\n  }, {\n    key: \"getSignAndSendReceiptsProcessChain\",\n    value: function getSignAndSendReceiptsProcessChain() {\n      var documentContentHandler = new DocumentContentHandler();\n      var createSignHandler = new CreateSignHandler();\n      var sendSignHandler = new SendSignHandler();\n      var signProcessHandler = new SignReceiptsProcessHandler();\n      documentContentHandler.setNext(createSignHandler).setNext(sendSignHandler).setNext(signProcessHandler);\n      return documentContentHandler;\n    }\n  }, {\n    key: \"getSignAndSendDocumentsProcessChain\",\n    value: function getSignAndSendDocumentsProcessChain() {\n      var documentContentHandler = new DocumentContentHandler();\n      var createSignHandler = new CreateSignHandler();\n      var sendSignHandler = new SendSignHandler();\n      var sendDocumentHandler = new SendDocumentHandler();\n      var signProcessHandler = new SignDocumentsProcessHandler();\n      documentContentHandler.setNext(createSignHandler).setNext(sendSignHandler).setNext(sendDocumentHandler).setNext(signProcessHandler);\n      return documentContentHandler;\n    }\n  }, {\n    key: \"getSignContainerProcessChain\",\n    value: function getSignContainerProcessChain() {\n      var documentContentHandler = new DocumentContentHandler();\n      var createSignHandler = new CreateSignHandler();\n      var sendSignHandler = new SendSignHandler();\n      var signContainerProcessHandler = new SignContainerProcessHandler();\n      documentContentHandler.setNext(createSignHandler).setNext(sendSignHandler).setNext(signContainerProcessHandler);\n      return documentContentHandler;\n    }\n  }, {\n    key: \"getReceiptsForSigningList\",\n    value: function getReceiptsForSigningList() {\n      var _a;\n\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var request, res;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                request = new SignRequest();\n                _context.next = 3;\n                return this.receiptsForSigningChain.sign(request);\n\n              case 3:\n                res = _context.sent;\n                return _context.abrupt(\"return\", (_a = res === null || res === void 0 ? void 0 : res.data) === null || _a === void 0 ? void 0 : _a.documents);\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n    }\n  }, {\n    key: \"signReceipts\",\n    value: function signReceipts(request) {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                return _context2.abrupt(\"return\", this.signAndSendReceiptsChain.sign(request));\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n    }\n  }, {\n    key: \"signDocuments\",\n    value: function signDocuments(request) {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                return _context3.abrupt(\"return\", this.signAndSendDocumentsChain.sign(request));\n\n              case 1:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n    }\n  }, {\n    key: \"signContainer\",\n    value: function signContainer(request) {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                return _context4.abrupt(\"return\", this.signAndSendContainerChain.sign(request));\n\n              case 1:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n    }\n  }, {\n    key: \"events\",\n    get: function get() {\n      return this._events;\n    }\n  }, {\n    key: \"isAborted\",\n    get: function get() {\n      return this._isAborted;\n    }\n  }]);\n\n  return SignService;\n}();\n\nvar instance = new SignService();\nexport default instance;","map":{"version":3,"sources":["../../../src/application/sign/SignService.js"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport CertificateHandler from './handlers/sign/CertificateHandler';\r\nimport RolesHandler from './handlers/sign/RolesHandler';\r\nimport ReceiptsHandler from './handlers/sign/ReceiptsHandler';\r\nimport SignDocumentsProcessHandler from './handlers/sign/SignDocumentsProcessHandler';\r\nimport SignReceiptsProcessHandler from './handlers/sign/SignReceiptsProcessHandler';\r\nimport SignContainerProcessHandler from './handlers/sign/SignContainerProcessHandler';\r\nimport DocumentContentHandler from './handlers/sign/DocumentContentHandler';\r\nimport CreateSignHandler from './handlers/sign/CreateSignHandler';\r\nimport SendSignHandler from './handlers/sign/SendSignHandler';\r\nimport SendDocumentHandler from './handlers/sign/SendDocumentHandler';\r\nimport SignEventManager from './SignEventManager';\r\nimport SignRequest from './SignRequest';\r\nclass SignService {\r\n    constructor() {\r\n        this._isAborted = false;\r\n        this._events = new SignEventManager();\r\n        this._getSignAndSendReceiptsChain = () => {\r\n            const certificateHandler = new CertificateHandler();\r\n            const rolesHandler = new RolesHandler();\r\n            const receiptsHandler = new ReceiptsHandler();\r\n            const signProcessHandler = new SignReceiptsProcessHandler();\r\n            certificateHandler\r\n                .setNext(rolesHandler)\r\n                .setNext(receiptsHandler)\r\n                .setNext(signProcessHandler);\r\n            return certificateHandler;\r\n        };\r\n        this._getSignAndSendDocumentsChain = () => {\r\n            const certificateHandler = new CertificateHandler();\r\n            const rolesHandler = new RolesHandler();\r\n            const signProcessHandler = new SignDocumentsProcessHandler();\r\n            certificateHandler.setNext(rolesHandler).setNext(signProcessHandler);\r\n            return certificateHandler;\r\n        };\r\n        this._getSignAndSendContainerChain = () => {\r\n            const certificateHandler = new CertificateHandler();\r\n            const rolesHandler = new RolesHandler();\r\n            const signProcessHandler = new SignContainerProcessHandler();\r\n            certificateHandler.setNext(rolesHandler).setNext(signProcessHandler);\r\n            return certificateHandler;\r\n        };\r\n        this._receiptsForSigningChain = () => {\r\n            const certificateHandler = new CertificateHandler();\r\n            const rolesHandler = new RolesHandler();\r\n            const receiptsHandler = new ReceiptsHandler();\r\n            certificateHandler.setNext(rolesHandler).setNext(receiptsHandler);\r\n            return certificateHandler;\r\n        };\r\n        this.signAndSendReceiptsChain = this._getSignAndSendReceiptsChain();\r\n        this.signAndSendDocumentsChain = this._getSignAndSendDocumentsChain();\r\n        this.signAndSendContainerChain = this._getSignAndSendContainerChain();\r\n        this.receiptsForSigningChain = this._receiptsForSigningChain();\r\n        this.events.subscribe('abortSigning', this.abortSigning.bind(this));\r\n    }\r\n    get events() {\r\n        return this._events;\r\n    }\r\n    get isAborted() {\r\n        return this._isAborted;\r\n    }\r\n    abortSigning() {\r\n        this._isAborted = true;\r\n    }\r\n    resetIsAbortedFlag() {\r\n        this._isAborted = false;\r\n    }\r\n    getSignAndSendReceiptsProcessChain() {\r\n        const documentContentHandler = new DocumentContentHandler();\r\n        const createSignHandler = new CreateSignHandler();\r\n        const sendSignHandler = new SendSignHandler();\r\n        const signProcessHandler = new SignReceiptsProcessHandler();\r\n        documentContentHandler\r\n            .setNext(createSignHandler)\r\n            .setNext(sendSignHandler)\r\n            .setNext(signProcessHandler);\r\n        return documentContentHandler;\r\n    }\r\n    getSignAndSendDocumentsProcessChain() {\r\n        const documentContentHandler = new DocumentContentHandler();\r\n        const createSignHandler = new CreateSignHandler();\r\n        const sendSignHandler = new SendSignHandler();\r\n        const sendDocumentHandler = new SendDocumentHandler();\r\n        const signProcessHandler = new SignDocumentsProcessHandler();\r\n        documentContentHandler\r\n            .setNext(createSignHandler)\r\n            .setNext(sendSignHandler)\r\n            .setNext(sendDocumentHandler)\r\n            .setNext(signProcessHandler);\r\n        return documentContentHandler;\r\n    }\r\n    getSignContainerProcessChain() {\r\n        const documentContentHandler = new DocumentContentHandler();\r\n        const createSignHandler = new CreateSignHandler();\r\n        const sendSignHandler = new SendSignHandler();\r\n        const signContainerProcessHandler = new SignContainerProcessHandler();\r\n        documentContentHandler\r\n            .setNext(createSignHandler)\r\n            .setNext(sendSignHandler)\r\n            .setNext(signContainerProcessHandler);\r\n        return documentContentHandler;\r\n    }\r\n    getReceiptsForSigningList() {\r\n        var _a;\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const request = new SignRequest();\r\n            const res = yield this.receiptsForSigningChain.sign(request);\r\n            return (_a = res === null || res === void 0 ? void 0 : res.data) === null || _a === void 0 ? void 0 : _a.documents;\r\n        });\r\n    }\r\n    signReceipts(request) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return this.signAndSendReceiptsChain.sign(request);\r\n        });\r\n    }\r\n    signDocuments(request) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return this.signAndSendDocumentsChain.sign(request);\r\n        });\r\n    }\r\n    signContainer(request) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return this.signAndSendContainerChain.sign(request);\r\n        });\r\n    }\r\n}\r\nconst instance = new SignService();\r\nexport default instance;\r\n//# sourceMappingURL=SignService.js.map"]},"metadata":{},"sourceType":"module"}