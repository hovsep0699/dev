{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _get from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/get\";import _getPrototypeOf from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import _applyDecoratedDescriptor from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/applyDecoratedDescriptor\";var _class;import React from'react';import{NavLink,Redirect}from'react-router-dom';import CertFormBase from'./CertFormBase';import{Form}from'informed';import Core from'@distate/core/dist/application/Core';import{CertificateService as CertService}from'@distate/core/dist/application/certificate/CertificateService';import classNames from'classnames';import Flash from'../../../common/flash/Flash';import{COMPANY,DOCUMENT,REG_CERT}from'../../../common/Url';import{ENTER,GO_TO_REG_FORM}from'../../../common/Lbl';import NoRegisteredCert from'../components/certificate/NoRegisteredCert';import autobind from'autobind-decorator';var LoginByCertForm=(_class=/*#__PURE__*/function(_CertFormBase){_inherits(LoginByCertForm,_CertFormBase);var _super=_createSuper(LoginByCertForm);function LoginByCertForm(props){var _this;_classCallCheck(this,LoginByCertForm);_this=_super.call(this,props);_this.state=_objectSpread(_objectSpread({},_this.state),{},{redirectToReferrer:false});_this.submit=_this.submit.bind(_assertThisInitialized(_this));_this.setFormApi=_this.setFormApi.bind(_assertThisInitialized(_this));_this.handleEnterKeyDown=_this.handleEnterKeyDown.bind(_assertThisInitialized(_this));return _this;}_createClass(LoginByCertForm,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this._isMounted=true;document.addEventListener('keydown',this.handleEnterKeyDown);CertService.getLoginCertificates().then(this.handleCertsFromService).catch(function(error){_this2.handlePluginError(error);});}},{key:\"handleEnterKeyDown\",value:function handleEnterKeyDown(e){if(e.key==='Enter'){this.submit();}}},{key:\"renderNoCert\",value:function renderNoCert(){return/*#__PURE__*/React.createElement(NoRegisteredCert,null);}},{key:\"submit\",value:function submit(){var _this3=this;if(!this.state.certificates.length)return;var handleSuccess=function handleSuccess(loginResult){if(loginResult.success){_this3.setState({redirectToReferrer:true});}};var handleError=function handleError(error){Flash.error(error);};Core.auth({certificate:this.state.selectedCertificate}).then(handleSuccess).catch(handleError);}},{key:\"setFormApi\",value:function setFormApi(formApi){this.formApi=formApi;}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){_get(_getPrototypeOf(LoginByCertForm.prototype),\"componentWillUnmount\",this).call(this);document.removeEventListener('keydown',this.handleEnterKeyDown);}},{key:\"render\",value:function render(){if(this.state.redirectToReferrer){var isPhysic=!Core.company;if(isPhysic||Core.company.isComplete){return/*#__PURE__*/React.createElement(Redirect,{to:DOCUMENT});}else{return/*#__PURE__*/React.createElement(Redirect,{to:COMPANY});}}var overriddenSubmitBtnClasses=classNames({disabled:!this.state.certificates.length},this.submitBtnClasses);return/*#__PURE__*/React.createElement(\"div\",{className:\"tabcontent active\",id:\"loginCertificate\"},/*#__PURE__*/React.createElement(Form,{id:\"login-certificate-form\",getApi:this.setFormApi,onSubmit:this.submit},this.renderCertificates(),/*#__PURE__*/React.createElement(\"input\",{name:\"signed_data\",type:\"hidden\",\"data-bind\":\"value: signedData\",value:\"\"}),/*#__PURE__*/React.createElement(\"footer\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"ds-button-block width-fluid-full\"},/*#__PURE__*/React.createElement(\"input\",{className:overriddenSubmitBtnClasses,type:\"submit\",value:ENTER,tabIndex:2}),/*#__PURE__*/React.createElement(NavLink,{className:\"ds-button height-large width-fluid-full\",to:REG_CERT,tabIndex:3},GO_TO_REG_FORM)))));}}]);return LoginByCertForm;}(CertFormBase),(_applyDecoratedDescriptor(_class.prototype,\"renderNoCert\",[autobind],Object.getOwnPropertyDescriptor(_class.prototype,\"renderNoCert\"),_class.prototype)),_class);export default LoginByCertForm;","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/auth/forms/LoginByCertForm.js"],"names":["React","NavLink","Redirect","CertFormBase","Form","Core","CertificateService","CertService","classNames","Flash","COMPANY","DOCUMENT","REG_CERT","ENTER","GO_TO_REG_FORM","NoRegisteredCert","autobind","LoginByCertForm","props","state","redirectToReferrer","submit","bind","setFormApi","handleEnterKeyDown","_isMounted","document","addEventListener","getLoginCertificates","then","handleCertsFromService","catch","error","handlePluginError","e","key","certificates","length","handleSuccess","loginResult","success","setState","handleError","auth","certificate","selectedCertificate","formApi","removeEventListener","isPhysic","company","isComplete","overriddenSubmitBtnClasses","disabled","submitBtnClasses","renderCertificates"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { NavLink, Redirect } from 'react-router-dom';\r\nimport CertFormBase from './CertFormBase';\r\nimport { Form } from 'informed';\r\nimport Core from '@distate/core/dist/application/Core';\r\nimport { CertificateService as CertService } from '@distate/core/dist/application/certificate/CertificateService';\r\nimport classNames from 'classnames';\r\nimport Flash from '../../../common/flash/Flash';\r\nimport { COMPANY, DOCUMENT, REG_CERT } from '../../../common/Url';\r\nimport { ENTER, GO_TO_REG_FORM } from '../../../common/Lbl';\r\nimport NoRegisteredCert from '../components/certificate/NoRegisteredCert';\r\nimport autobind from 'autobind-decorator';\r\n\r\nclass LoginByCertForm extends CertFormBase {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { ...this.state, redirectToReferrer: false };\r\n    this.submit = this.submit.bind(this);\r\n    this.setFormApi = this.setFormApi.bind(this);\r\n    this.handleEnterKeyDown = this.handleEnterKeyDown.bind(this);\r\n  }\r\n  componentDidMount() {\r\n    this._isMounted = true;\r\n    document.addEventListener('keydown', this.handleEnterKeyDown);\r\n\r\n    CertService.getLoginCertificates()\r\n      .then(this.handleCertsFromService)\r\n      .catch(error => {\r\n        this.handlePluginError(error);\r\n      });\r\n  }\r\n  handleEnterKeyDown(e) {\r\n    if (e.key === 'Enter') {\r\n      this.submit();\r\n    }\r\n  }\r\n  @autobind\r\n  renderNoCert() {\r\n    return <NoRegisteredCert />;\r\n  }\r\n  submit() {\r\n    if (!this.state.certificates.length) return;\r\n\r\n    const handleSuccess = loginResult => {\r\n      if (loginResult.success) {\r\n        this.setState({ redirectToReferrer: true });\r\n      }\r\n    };\r\n    const handleError = error => {\r\n      Flash.error(error);\r\n    };\r\n    Core.auth({ certificate: this.state.selectedCertificate })\r\n      .then(handleSuccess)\r\n      .catch(handleError);\r\n  }\r\n  setFormApi(formApi) {\r\n    this.formApi = formApi;\r\n  }\r\n  componentWillUnmount() {\r\n    super.componentWillUnmount();\r\n    document.removeEventListener('keydown', this.handleEnterKeyDown);\r\n  }\r\n  render() {\r\n    if (this.state.redirectToReferrer) {\r\n      const isPhysic = !Core.company;\r\n      if (isPhysic || Core.company.isComplete) {\r\n        return <Redirect to={DOCUMENT} />;\r\n      } else {\r\n        return <Redirect to={COMPANY} />;\r\n      }\r\n    }\r\n\r\n    const overriddenSubmitBtnClasses = classNames(\r\n      { disabled: !this.state.certificates.length },\r\n      this.submitBtnClasses\r\n    );\r\n    return (\r\n      <div className=\"tabcontent active\" id=\"loginCertificate\">\r\n        <Form id=\"login-certificate-form\" getApi={this.setFormApi} onSubmit={this.submit}>\r\n          {this.renderCertificates()}\r\n\r\n          <input name=\"signed_data\" type=\"hidden\" data-bind=\"value: signedData\" value=\"\" />\r\n          <footer>\r\n            <div className=\"ds-button-block width-fluid-full\">\r\n              <input\r\n                className={overriddenSubmitBtnClasses}\r\n                type=\"submit\"\r\n                value={ENTER}\r\n                tabIndex={2}\r\n              />\r\n              <NavLink\r\n                className=\"ds-button height-large width-fluid-full\"\r\n                to={REG_CERT}\r\n                tabIndex={3}\r\n              >\r\n                {GO_TO_REG_FORM}\r\n              </NavLink>\r\n            </div>\r\n          </footer>\r\n        </Form>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default LoginByCertForm;\r\n"]},"metadata":{},"sourceType":"module"}