{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport CCertificate from './CCertificate';\n/** получение информации о сертификате */\n\nexport var getCertificateInfo = function getCertificateInfo(data) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var certificate;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return cadesplugin.CreateObjectAsync('CAPICOM.Certificate');\n\n          case 2:\n            certificate = _context.sent;\n            certificate.Import(data);\n            _context.t0 = CCertificate;\n            _context.t1 = certificate;\n            _context.next = 8;\n            return certificate.Thumbprint;\n\n          case 8:\n            _context.t2 = _context.sent;\n            _context.next = 11;\n            return certificate.Export(0);\n\n          case 11:\n            _context.t3 = _context.sent;\n            _context.next = 14;\n            return certificate.ValidFromDate;\n\n          case 14:\n            _context.t4 = _context.sent;\n            _context.next = 17;\n            return certificate.ValidToDate;\n\n          case 17:\n            _context.t5 = _context.sent;\n            _context.next = 20;\n            return certificate.SubjectName;\n\n          case 20:\n            _context.t6 = _context.sent;\n            _context.next = 23;\n            return certificate.SerialNumber;\n\n          case 23:\n            _context.t7 = _context.sent;\n            _context.next = 26;\n            return certificate.IssuerName;\n\n          case 26:\n            _context.t8 = _context.sent;\n            _context.t9 = {\n              thumbprint: _context.t2,\n              data: _context.t3,\n              validFrom: _context.t4,\n              validTo: _context.t5,\n              subjectName: _context.t6,\n              serialNumber: _context.t7,\n              issuerName: _context.t8\n            };\n            return _context.abrupt(\"return\", new _context.t0(_context.t1, _context.t9));\n\n          case 29:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n};\n/** расширение информации о сертификатах */\n\nexport var expandCertificateList = function expandCertificateList(certificateRows) {\n  var promises = certificateRows.map(function (item) {\n    return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var _a, _b, _c, _d, _e, _f, certificateInfo;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return getCertificateInfo(item.data, item.thumbprint);\n\n            case 2:\n              certificateInfo = _context2.sent;\n              return _context2.abrupt(\"return\", Object.assign(Object.assign({}, item), {\n                /** начало действия сертификата - временной формат */\n                dateFrom: certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.getValidFromDate(),\n\n                /** окончание дейсвтия сертификата - временной формат */\n                dateTo: certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.getValidToDate(),\n\n                /** ФИО */\n                fio: ((_a = certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.dnSubject) === null || _a === void 0 ? void 0 : _a.SN) + ' ' + ((_b = certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.dnSubject) === null || _b === void 0 ? void 0 : _b.G),\n\n                /** должность */\n                position: (_c = certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.dnSubject) === null || _c === void 0 ? void 0 : _c.T,\n\n                /** назване компании */\n                companyName: certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.Name,\n\n                /** ОГРН */\n                ogrn: (_d = certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.dnSubject) === null || _d === void 0 ? void 0 : _d.OGRN,\n\n                /** ИНН */\n                inn: ((_e = certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.dnSubject) === null || _e === void 0 ? void 0 : _e.INNLE) || ((_f = certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.dnSubject) === null || _f === void 0 ? void 0 : _f.INN)\n              }));\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n  });\n  return Promise.all(promises);\n};","map":{"version":3,"sources":["../../../src/application/certificate/CertificateHelper.js"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport CCertificate from './CCertificate';\r\n/** получение информации о сертификате */\r\nexport const getCertificateInfo = (data) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const certificate = yield cadesplugin.CreateObjectAsync('CAPICOM.Certificate');\r\n    certificate.Import(data);\r\n    return new CCertificate(certificate, {\r\n        thumbprint: yield certificate.Thumbprint,\r\n        data: yield certificate.Export(0),\r\n        validFrom: yield certificate.ValidFromDate,\r\n        validTo: yield certificate.ValidToDate,\r\n        subjectName: yield certificate.SubjectName,\r\n        serialNumber: yield certificate.SerialNumber,\r\n        issuerName: yield certificate.IssuerName\r\n    });\r\n});\r\n/** расширение информации о сертификатах */\r\nexport const expandCertificateList = (certificateRows) => {\r\n    const promises = certificateRows.map((item) => __awaiter(void 0, void 0, void 0, function* () {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        const certificateInfo = yield getCertificateInfo(item.data, item.thumbprint);\r\n        return Object.assign(Object.assign({}, item), { \r\n            /** начало действия сертификата - временной формат */\r\n            dateFrom: certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.getValidFromDate(), \r\n            /** окончание дейсвтия сертификата - временной формат */\r\n            dateTo: certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.getValidToDate(), \r\n            /** ФИО */\r\n            fio: ((_a = certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.dnSubject) === null || _a === void 0 ? void 0 : _a.SN) + ' ' + ((_b = certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.dnSubject) === null || _b === void 0 ? void 0 : _b.G), \r\n            /** должность */\r\n            position: (_c = certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.dnSubject) === null || _c === void 0 ? void 0 : _c.T, \r\n            /** назване компании */\r\n            companyName: certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.Name, \r\n            /** ОГРН */\r\n            ogrn: (_d = certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.dnSubject) === null || _d === void 0 ? void 0 : _d.OGRN, \r\n            /** ИНН */\r\n            inn: ((_e = certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.dnSubject) === null || _e === void 0 ? void 0 : _e.INNLE) || ((_f = certificateInfo === null || certificateInfo === void 0 ? void 0 : certificateInfo.dnSubject) === null || _f === void 0 ? void 0 : _f.INN) });\r\n    }));\r\n    return Promise.all(promises);\r\n};\r\n//# sourceMappingURL=CertificateHelper.js.map"]},"metadata":{},"sourceType":"module"}