{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useDispatch,useSelector}from'react-redux';import{Icons,Button,ButtonKinds,Input,CheckBox,Modal}from'@distate/components';import'./style.css';import{TariffTypeSwitcher}from'./TariffTypeSwitcher';import{LocksSettingsSwitcher}from'./LocksSettingsSwitcher';import{TariffListTable}from'./TariffListTable';import{createTariff,setTariffErrors}from'../../store/actions';import{titleErrorsSelector,periodicalCostErrorsSelector,periodErrorsSelector}from'../../store/selects';/** модалка создания тарифа */export var TariffCreate=function TariffCreate(props){var _hide=props.hide,isVisible=props.isVisible;var _useState=useState(),_useState2=_slicedToArray(_useState,2),tariffTitle=_useState2[0],setTariffTitle=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),tariffType=_useState4[0],setTariffType=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),tariffStatus=_useState6[0],setTariffStatus=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),pricingConnectionCost=_useState8[0],setPricingConnectionCost=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),pricingPeriodicalCost=_useState10[0],setPricingPeriodicalCost=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),pricingPeriodYear=_useState12[0],setPricingPeriodYear=_useState12[1];var _useState13=useState(1),_useState14=_slicedToArray(_useState13,2),pricingPeriodMonth=_useState14[0],setPricingPeriodMonth=_useState14[1];var _useState15=useState(0),_useState16=_slicedToArray(_useState15,2),pricingPeriodDay=_useState16[0],setPricingPeriodDay=_useState16[1];var _useState17=useState(1),_useState18=_slicedToArray(_useState17,2),locksSettingsType=_useState18[0],setLocksSettingsType=_useState18[1];var _useState19=useState(),_useState20=_slicedToArray(_useState19,2),locksSettingsNextTariff=_useState20[0],setLocksSettingsNextTariff=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),isPromotion=_useState22[0],setIsPromotion=_useState22[1];var _useState23=useState(),_useState24=_slicedToArray(_useState23,2),nextTariffTitle=_useState24[0],setNextTariffTitle=_useState24[1];var _useState25=useState(),_useState26=_slicedToArray(_useState25,2),nextTariffType=_useState26[0],setNextTariffType=_useState26[1];var dispatch=useDispatch();var _useState27=useState('0.00'),_useState28=_slicedToArray(_useState27,2),connectionCostInput=_useState28[0],setConnectionCostInput=_useState28[1];var _useState29=useState('0.00'),_useState30=_slicedToArray(_useState29,2),periodicalCostInput=_useState30[0],setPeriodicalCostInput=_useState30[1];var titleError=useSelector(titleErrorsSelector);var periodicalCostError=useSelector(periodicalCostErrorsSelector);var periodError=useSelector(periodErrorsSelector);/** Чекбокс изменения видимости в списке */var onChangeIsHidenInList=function onChangeIsHidenInList(){setTariffStatus(function(oldValue){return oldValue===2?1:2;});};/** Сохранить */var onSave=function onSave(){var formData=new FormData();tariffTitle&&formData.append('tariff[title]',tariffTitle);tariffType&&formData.append('tariff[type]',tariffType.toString());tariffStatus&&formData.append('tariff[status]',tariffStatus.toString());formData.append('pricing[connectionCost]',pricingConnectionCost?(pricingConnectionCost*100).toString():'0');formData.append('pricing[periodicalCost]',pricingPeriodicalCost?(pricingPeriodicalCost*100).toString():'0');formData.append('pricing[isPromotion]',isPromotion?'1':'0');formData.append('pricing[period][year]',pricingPeriodYear.toString());formData.append('pricing[period][month]',pricingPeriodMonth.toString());formData.append('pricing[period][day]',pricingPeriodDay.toString());locksSettingsType&&formData.append('locks_settings[type]',locksSettingsType.toString());formData.append('locks_settings[threshold]','0');locksSettingsNextTariff&&formData.append('locks_settings[nextTariff]',locksSettingsNextTariff.toString());dispatch(createTariff(formData));};useEffect(function(){dispatch(setTariffErrors({createTariffErrors:undefined}));},[dispatch]);var onBlurConnectionCost=function onBlurConnectionCost(e){var value=e.target.value;setConnectionCostInput(Number(value).toFixed(2));setPricingConnectionCost(e.target.value);};var onBlurPeriodicalCost=function onBlurPeriodicalCost(e){var value=e.target.value;setPeriodicalCostInput(Number(value).toFixed(2));setPricingPeriodicalCost(e.target.value);};var changeTariffTypeHandler=function changeTariffTypeHandler(_ref){var id=_ref.id;setTariffType(id);};var changeNextTariffHandler=function changeNextTariffHandler(id,title,type_title){setNextTariffTitle(title);setNextTariffType(type_title);setLocksSettingsNextTariff(id);};return/*#__PURE__*/React.createElement(Modal,{hide:function hide(){return _hide();},isVisible:isVisible},/*#__PURE__*/React.createElement(Modal.Header,{title:\"\\u041A\\u0430\\u0440\\u0442\\u043E\\u0447\\u043A\\u0430 \\u0442\\u0430\\u0440\\u0438\\u0444\\u0430\"}),/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{className:\"tariff-info-title\"},\"\\u0422\\u0430\\u0440\\u0438\\u0444\"),/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-title\"},\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Input,{value:tariffTitle,onChange:function onChange(e){return setTariffTitle(e.target.value);},width:330,errors:titleError,error:Boolean(titleError)}))),/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-title\"},\"\\u0422\\u0438\\u043F\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(TariffTypeSwitcher,{onChange:changeTariffTypeHandler,tariffTypeId:Number(tariffType)}))),/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-title\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-value\"},/*#__PURE__*/React.createElement(CheckBox,{label:'аĸционный тариф',checked:isPromotion,onChange:function onChange(){return setIsPromotion(!isPromotion);}}))),/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-title\"}),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(CheckBox,{label:'отображать в списке для подключения',checked:tariffStatus===2,onChange:onChangeIsHidenInList})))),/*#__PURE__*/React.createElement(\"p\",{className:\"tariff-info-title\"},\"\\u0426\\u0435\\u043D\\u043E\\u0432\\u0430\\u044F \\u043F\\u043E\\u043B\\u0438\\u0442\\u0438\\u043A\\u0430\"),/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-title\"},\"\\u0421\\u0442\\u043E\\u0438\\u043C\\u043E\\u0441\\u0442\\u044C \\u043F\\u0435\\u0440\\u0435\\u0445\\u043E\\u0434\\u0430\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Input,{value:connectionCostInput,onBlur:onBlurConnectionCost,onChange:function onChange(e){return setConnectionCostInput(e.target.value);},type:\"number\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-title\"},\"\\u0410\\u0431\\u043E\\u043D\\u0435\\u043D\\u0442\\u0441\\u043A\\u0430\\u044F \\u043F\\u043B\\u0430\\u0442\\u0430\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Input,{value:periodicalCostInput,onBlur:onBlurPeriodicalCost,onChange:function onChange(e){return setPeriodicalCostInput(e.target.value);},type:\"number\",error:Boolean(periodicalCostError),errors:periodicalCostError}))),/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-title\"},\"\\u041F\\u0435\\u0440\\u0438\\u043E\\u0434\\u0438\\u0447\\u043D\\u043E\\u0441\\u0442\\u044C\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-period\"},/*#__PURE__*/React.createElement(Input,{value:pricingPeriodYear.toString(),label:\"\\u041B\\u0435\\u0442\",width:80,name:\"year\",onChange:function onChange(e){return setPricingPeriodYear(Number(e.target.value));},type:\"number\"}),' ',/*#__PURE__*/React.createElement(Input,{value:pricingPeriodMonth.toString(),label:\"\\u041C\\u0435\\u0441\\u044F\\u0446\\u0435\\u0432\",width:80,name:\"month\",onChange:function onChange(e){return setPricingPeriodMonth(Number(e.target.value));},type:\"number\"}),' ',/*#__PURE__*/React.createElement(Input,{value:pricingPeriodDay.toString(),label:\"\\u0414\\u043D\\u0435\\u0439\",width:80,name:\"day\",onChange:function onChange(e){return setPricingPeriodDay(Number(e.target.value));},type:\"number\"})),/*#__PURE__*/React.createElement(Input,{hidden:true,errors:periodError,className:\"hidden-tariff-input\"})))),/*#__PURE__*/React.createElement(\"p\",{className:\"tariff-info-title\"},\"\\u041E\\u0433\\u0440\\u0430\\u043D\\u0438\\u0447\\u0435\\u043D\\u0438\\u044F\"),/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-title\"},\"\\u041F\\u043E\\u0440\\u043E\\u0433 \\u043E\\u0442\\u043A\\u043B\\u044E\\u0447\\u0435\\u043D\\u0438\\u044F\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Input,{placeholder:\"0.00\",disabled:true}))),/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-title\"},\"\\u041F\\u0440\\u0438 \\u0434\\u043E\\u0441\\u0442\\u0438\\u0436\\u0435\\u043D\\u0438\\u0438 \\u043F\\u043E\\u0440\\u043E\\u0433\\u0430 \\u043E\\u0442\\u043A\\u043B\\u044E\\u0447\\u0435\\u043D\\u0438\\u044F\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(LocksSettingsSwitcher,{tariffTypeId:locksSettingsType,onChange:setLocksSettingsType}))),locksSettingsType===2&&nextTariffTitle&&/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-title\"},\"\\u0422\\u0430\\u0440\\u0438\\u0444 \\u0434\\u043B\\u044F \\u043F\\u0435\\u0440\\u0435\\u0445\\u043E\\u0434\\u0430\"),/*#__PURE__*/React.createElement(\"div\",{className:\"tariff-info-table-value\"},\"\".concat(nextTariffTitle,\" (\").concat(nextTariffType,\")\")))),locksSettingsType===2&&/*#__PURE__*/React.createElement(TariffListTable,{onChange:changeNextTariffHandler,nextTariffId:locksSettingsNextTariff}),/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex',padding:'20px 0'}},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Button,{icon:/*#__PURE__*/React.createElement(Icons.IconCheck,{fill:\"currentColor\"}),kind:ButtonKinds.LightGreen,style:{marginRight:30},onClick:onSave},\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\")),/*#__PURE__*/React.createElement(\"p\",{style:{fontSize:12,color:'#626265'}},\"\\u0414\\u043B\\u044F \\u0440\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u044F \\u0432\\u0441\\u0435\\u0433\\u043E \\u0442\\u0430\\u0440\\u0438\\u0444\\u0430 \\u0443\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0435\\u0433\\u043E \\u0438\\u0437 \\u0441\\u043F\\u0438\\u0441\\u043A\\u0430 \\u043D\\u0430 \\u043F\\u043E\\u0434\\u043A\\u043B\\u044E\\u0447\\u0435\\u043D\\u0438\\u0435. \\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0442\\u0430\\u0440\\u0438\\u0444\\u0430 \\u0432\\u043E\\u0437\\u043C\\u043E\\u0436\\u043D\\u043E \\u0442\\u043E\\u043B\\u044C\\u043A\\u043E \\u043F\\u0440\\u0438 \\u043E\\u0442\\u0441\\u0443\\u0442\\u0441\\u0442\\u0432\\u0438\\u0438 \\u043F\\u043E\\u0434\\u043A\\u043B\\u044E\\u0447\\u0435\\u043D\\u043D\\u044B\\u0445 \\u043A\\u043E\\u043C\\u043F\\u0430\\u043D\\u0438\\u0439.\")))));};","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/tariff/components/tariff-card/TariffCreate.tsx"],"names":["React","useState","useEffect","useDispatch","useSelector","Icons","Button","ButtonKinds","Input","CheckBox","Modal","TariffTypeSwitcher","LocksSettingsSwitcher","TariffListTable","createTariff","setTariffErrors","titleErrorsSelector","periodicalCostErrorsSelector","periodErrorsSelector","TariffCreate","props","hide","isVisible","tariffTitle","setTariffTitle","tariffType","setTariffType","tariffStatus","setTariffStatus","pricingConnectionCost","setPricingConnectionCost","pricingPeriodicalCost","setPricingPeriodicalCost","pricingPeriodYear","setPricingPeriodYear","pricingPeriodMonth","setPricingPeriodMonth","pricingPeriodDay","setPricingPeriodDay","locksSettingsType","setLocksSettingsType","locksSettingsNextTariff","setLocksSettingsNextTariff","isPromotion","setIsPromotion","nextTariffTitle","setNextTariffTitle","nextTariffType","setNextTariffType","dispatch","connectionCostInput","setConnectionCostInput","periodicalCostInput","setPeriodicalCostInput","titleError","periodicalCostError","periodError","onChangeIsHidenInList","oldValue","onSave","formData","FormData","append","toString","createTariffErrors","undefined","onBlurConnectionCost","e","value","target","Number","toFixed","onBlurPeriodicalCost","changeTariffTypeHandler","id","changeNextTariffHandler","title","type_title","Boolean","display","padding","LightGreen","marginRight","fontSize","color"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Icons, Button, ButtonKinds, Input, CheckBox, Modal } from '@distate/components';\r\nimport './style.css';\r\nimport { TariffTypeSwitcher } from './TariffTypeSwitcher';\r\nimport { LocksSettingsSwitcher } from './LocksSettingsSwitcher';\r\nimport { TariffListTable } from './TariffListTable';\r\nimport { createTariff, setTariffErrors } from '../../store/actions';\r\nimport {\r\n  titleErrorsSelector,\r\n  periodicalCostErrorsSelector,\r\n  periodErrorsSelector\r\n} from '../../store/selects';\r\n\r\ntype Props = {\r\n  isVisible: boolean;\r\n  hide: () => void;\r\n};\r\n\r\n/** модалка создания тарифа */\r\nexport const TariffCreate = (props: Props) => {\r\n  const { hide, isVisible } = props;\r\n\r\n  const [tariffTitle, setTariffTitle] = useState<string>();\r\n  const [tariffType, setTariffType] = useState<number>(1);\r\n  const [tariffStatus, setTariffStatus] = useState<number>(1);\r\n  const [pricingConnectionCost, setPricingConnectionCost] = useState<number>(0);\r\n  const [pricingPeriodicalCost, setPricingPeriodicalCost] = useState<number>(0);\r\n  const [pricingPeriodYear, setPricingPeriodYear] = useState<number>(0);\r\n  const [pricingPeriodMonth, setPricingPeriodMonth] = useState<number>(1);\r\n  const [pricingPeriodDay, setPricingPeriodDay] = useState<number>(0);\r\n  const [locksSettingsType, setLocksSettingsType] = useState<number>(1);\r\n  const [locksSettingsNextTariff, setLocksSettingsNextTariff] = useState<number>();\r\n  const [isPromotion, setIsPromotion] = useState(false);\r\n\r\n  const [nextTariffTitle, setNextTariffTitle] = useState<string>();\r\n  const [nextTariffType, setNextTariffType] = useState<string>();\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  const [connectionCostInput, setConnectionCostInput] = useState('0.00');\r\n  const [periodicalCostInput, setPeriodicalCostInput] = useState('0.00');\r\n\r\n  const titleError = useSelector(titleErrorsSelector);\r\n  const periodicalCostError = useSelector(periodicalCostErrorsSelector);\r\n  const periodError = useSelector(periodErrorsSelector);\r\n\r\n  /** Чекбокс изменения видимости в списке */\r\n  const onChangeIsHidenInList = () => {\r\n    setTariffStatus((oldValue: number) => (oldValue === 2 ? 1 : 2));\r\n  };\r\n\r\n  /** Сохранить */\r\n  const onSave = () => {\r\n    const formData = new FormData();\r\n    tariffTitle && formData.append('tariff[title]', tariffTitle);\r\n    tariffType && formData.append('tariff[type]', tariffType.toString());\r\n    tariffStatus && formData.append('tariff[status]', tariffStatus.toString());\r\n    formData.append(\r\n      'pricing[connectionCost]',\r\n      pricingConnectionCost ? (pricingConnectionCost * 100).toString() : '0'\r\n    );\r\n    formData.append(\r\n      'pricing[periodicalCost]',\r\n      pricingPeriodicalCost ? (pricingPeriodicalCost * 100).toString() : '0'\r\n    );\r\n    formData.append('pricing[isPromotion]', isPromotion ? '1' : '0');\r\n    formData.append('pricing[period][year]', pricingPeriodYear.toString());\r\n    formData.append('pricing[period][month]', pricingPeriodMonth.toString());\r\n    formData.append('pricing[period][day]', pricingPeriodDay.toString());\r\n    locksSettingsType && formData.append('locks_settings[type]', locksSettingsType.toString());\r\n    formData.append('locks_settings[threshold]', '0');\r\n    locksSettingsNextTariff &&\r\n      formData.append('locks_settings[nextTariff]', locksSettingsNextTariff.toString());\r\n\r\n    dispatch(createTariff(formData));\r\n  };\r\n\r\n  useEffect(() => {\r\n    dispatch(setTariffErrors({ createTariffErrors: undefined }));\r\n  }, [dispatch]);\r\n\r\n  const onBlurConnectionCost = (e: any) => {\r\n    const value = e.target.value;\r\n    setConnectionCostInput(Number(value).toFixed(2));\r\n    setPricingConnectionCost(e.target.value);\r\n  };\r\n\r\n  const onBlurPeriodicalCost = (e: any) => {\r\n    const value = e.target.value;\r\n    setPeriodicalCostInput(Number(value).toFixed(2));\r\n    setPricingPeriodicalCost(e.target.value);\r\n  };\r\n\r\n  const changeTariffTypeHandler = ({ id }: { id: number }) => {\r\n    setTariffType(id);\r\n  };\r\n\r\n  const changeNextTariffHandler = (id: number, title: string, type_title: string) => {\r\n    setNextTariffTitle(title);\r\n    setNextTariffType(type_title);\r\n    setLocksSettingsNextTariff(id);\r\n  };\r\n\r\n  return (\r\n    <Modal hide={() => hide()} isVisible={isVisible}>\r\n      <Modal.Header title=\"Карточка тарифа\" />\r\n      <Modal.Body>\r\n        <div>\r\n          <span className=\"tariff-info-title\">Тариф</span>\r\n          <div className=\"tariff-info-table-wrapper\">\r\n            <div className=\"tariff-info-table-row\">\r\n              <div className=\"tariff-info-table-title\">Название</div>\r\n              <div>\r\n                <Input\r\n                  value={tariffTitle}\r\n                  onChange={e => setTariffTitle(e.target.value)}\r\n                  width={330}\r\n                  errors={titleError}\r\n                  error={Boolean(titleError)}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"tariff-info-table-row\">\r\n              <div className=\"tariff-info-table-title\">Тип</div>\r\n              <div>\r\n                <TariffTypeSwitcher\r\n                  onChange={changeTariffTypeHandler}\r\n                  tariffTypeId={Number(tariffType)}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"tariff-info-table-row\">\r\n              <div className=\"tariff-info-table-title\"></div>\r\n              <div className=\"tariff-info-table-value\">\r\n                <CheckBox\r\n                  label={'аĸционный тариф'}\r\n                  checked={isPromotion}\r\n                  onChange={() => setIsPromotion(!isPromotion)}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"tariff-info-table-row\">\r\n              <div className=\"tariff-info-table-title\"></div>\r\n              <div>\r\n                <CheckBox\r\n                  label={'отображать в списке для подключения'}\r\n                  checked={tariffStatus === 2}\r\n                  onChange={onChangeIsHidenInList}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <p className=\"tariff-info-title\">Ценовая политика</p>\r\n\r\n          <div className=\"tariff-info-table-wrapper\">\r\n            <div className=\"tariff-info-table-row\">\r\n              <div className=\"tariff-info-table-title\">Стоимость перехода</div>\r\n              <div>\r\n                <Input\r\n                  value={connectionCostInput}\r\n                  onBlur={onBlurConnectionCost}\r\n                  onChange={e => setConnectionCostInput(e.target.value)}\r\n                  type=\"number\"\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"tariff-info-table-row\">\r\n              <div className=\"tariff-info-table-title\">Абонентская плата</div>\r\n              <div>\r\n                <Input\r\n                  value={periodicalCostInput}\r\n                  onBlur={onBlurPeriodicalCost}\r\n                  onChange={e => setPeriodicalCostInput(e.target.value)}\r\n                  type=\"number\"\r\n                  error={Boolean(periodicalCostError)}\r\n                  errors={periodicalCostError}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"tariff-info-table-row\">\r\n              <div className=\"tariff-info-table-title\">Периодичность</div>\r\n              <div>\r\n                <div className=\"tariff-info-table-period\">\r\n                  <Input\r\n                    value={pricingPeriodYear.toString()}\r\n                    label=\"Лет\"\r\n                    width={80}\r\n                    name=\"year\"\r\n                    onChange={e => setPricingPeriodYear(Number(e.target.value))}\r\n                    type=\"number\"\r\n                  />{' '}\r\n                  <Input\r\n                    value={pricingPeriodMonth.toString()}\r\n                    label=\"Месяцев\"\r\n                    width={80}\r\n                    name=\"month\"\r\n                    onChange={e => setPricingPeriodMonth(Number(e.target.value))}\r\n                    type=\"number\"\r\n                  />{' '}\r\n                  <Input\r\n                    value={pricingPeriodDay.toString()}\r\n                    label=\"Дней\"\r\n                    width={80}\r\n                    name=\"day\"\r\n                    onChange={e => setPricingPeriodDay(Number(e.target.value))}\r\n                    type=\"number\"\r\n                  />\r\n                </div>\r\n                <Input hidden errors={periodError} className=\"hidden-tariff-input\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <p className=\"tariff-info-title\">Ограничения</p>\r\n\r\n          <div className=\"tariff-info-table-wrapper\">\r\n            <div className=\"tariff-info-table-row\">\r\n              <div className=\"tariff-info-table-title\">Порог отключения</div>\r\n              <div>\r\n                <Input placeholder=\"0.00\" disabled={true} />\r\n              </div>\r\n            </div>\r\n            <div className=\"tariff-info-table-row\">\r\n              <div className=\"tariff-info-table-title\">При достижении порога отключения</div>\r\n              <div>\r\n                <LocksSettingsSwitcher\r\n                  tariffTypeId={locksSettingsType}\r\n                  onChange={setLocksSettingsType}\r\n                />\r\n              </div>\r\n            </div>\r\n            {locksSettingsType === 2 && nextTariffTitle && (\r\n              <div className=\"tariff-info-table-row\">\r\n                <div className=\"tariff-info-table-title\">Тариф для перехода</div>\r\n                <div className=\"tariff-info-table-value\">{`${nextTariffTitle} (${nextTariffType})`}</div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {locksSettingsType === 2 && (\r\n            <TariffListTable\r\n              onChange={changeNextTariffHandler}\r\n              nextTariffId={locksSettingsNextTariff}\r\n            />\r\n          )}\r\n\r\n          <div style={{ display: 'flex', padding: '20px 0' }}>\r\n            <div>\r\n              <Button\r\n                icon={<Icons.IconCheck fill=\"currentColor\" />}\r\n                kind={ButtonKinds.LightGreen}\r\n                style={{ marginRight: 30 }}\r\n                onClick={onSave}\r\n              >\r\n                Сохранить\r\n              </Button>\r\n            </div>\r\n            <p style={{ fontSize: 12, color: '#626265' }}>\r\n              Для редактирования всего тарифа уберите его из списка на подключение. Редактирование\r\n              тарифа возможно только при отсутствии подключенных компаний.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </Modal.Body>\r\n    </Modal>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}