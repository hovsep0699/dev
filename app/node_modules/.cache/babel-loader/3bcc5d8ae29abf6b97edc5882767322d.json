{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{Button,ButtonKinds,Icons}from'@distate/components';import Core from'@distate/core/dist/application/Core';import{StaffTools}from'../StaffTools';import{Pagination,PaginationLimit}from'../../../../../common/pagination';import{joinNoEmptyValues}from'../../../../../helpers/heplers';import{selectStaffWaiting,selectStaffNumberWaiting}from'../../../store/selectors';import{getStaffWaiting,getEmployee,activeEmployee,rejectEmployee}from'../../../store/actions';import{EmployeeCard}from'../EmployeeCard';/** Заявки на активацию (Сотрудники) */export var Waiting=function Waiting(){var _useState=useState(10),_useState2=_slicedToArray(_useState,2),limit=_useState2[0],setLimit=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),offset=_useState4[0],setOffset=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),companyId=_useState6[0],setCompanyId=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),cardVisible=_useState8[0],setCardVisible=_useState8[1];var dispatch=useDispatch();var staff=useSelector(selectStaffWaiting);var staffNumber=useSelector(selectStaffNumberWaiting)||0;useEffect(function(){var _Core$company;var id=Core===null||Core===void 0?void 0:(_Core$company=Core.company)===null||_Core$company===void 0?void 0:_Core$company.localId;setCompanyId(id);dispatch(getStaffWaiting({id:id,params:{offset:offset,limit:limit,statusSystemName:'waiting_for_approval'}}));},[dispatch,limit,offset]);/** кнопка Карточка сотрудника */var onOpenCard=function onOpenCard(id){dispatch(getEmployee(id));setCardVisible(true);};/** кнопка Активировать */var onActivation=function onActivation(employeeId){var _Core$company2;dispatch(activeEmployee({employeeId:employeeId,companyId:Core===null||Core===void 0?void 0:(_Core$company2=Core.company)===null||_Core$company2===void 0?void 0:_Core$company2.localId,params:{offset:offset,limit:limit,statusSystemName:'waiting_for_approval'}}));onOpenCard(employeeId);};/** кнопка Отклонить */var onReject=function onReject(employeeId){var _Core$company3;dispatch(rejectEmployee({employeeId:employeeId,companyId:Core===null||Core===void 0?void 0:(_Core$company3=Core.company)===null||_Core$company3===void 0?void 0:_Core$company3.localId,params:{offset:offset,limit:limit,statusSystemName:'waiting_for_approval'}}));};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex',justifyContent:'space-between'}},/*#__PURE__*/React.createElement(StaffTools,{id:companyId,limit:limit,statusSystemName:\"waiting_for_approval\"}),/*#__PURE__*/React.createElement(PaginationLimit,{setLimit:setLimit,limit:limit})),/*#__PURE__*/React.createElement(\"table\",{className:\"table\"},/*#__PURE__*/React.createElement(\"thead\",{className:\"common-table-head\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:2},\"\\u0424\\u0418\\u041E \\u0441\\u043E\\u0442\\u0440\\u0443\\u0434\\u043D\\u0438\\u043A\\u0430\"),/*#__PURE__*/React.createElement(\"td\",null,\"\\u0434\\u043E\\u043B\\u0436\\u043D\\u043E\\u0441\\u0442\\u044C\"),/*#__PURE__*/React.createElement(\"td\",null,\"e-mail\"),/*#__PURE__*/React.createElement(\"td\",{colSpan:2}))),/*#__PURE__*/React.createElement(\"tbody\",null,staff===null||staff===void 0?void 0:staff.map(function(employee){var id=employee.id,surname=employee.surname,name=employee.name,patronymic=employee.patronymic,position=employee.position,email=employee.email;var fio=joinNoEmptyValues([surname,name,patronymic]);return/*#__PURE__*/React.createElement(\"tr\",{key:id},/*#__PURE__*/React.createElement(\"td\",{colSpan:2},fio),/*#__PURE__*/React.createElement(\"td\",null,position),/*#__PURE__*/React.createElement(\"td\",null,email),/*#__PURE__*/React.createElement(\"td\",{align:\"right\",colSpan:2},/*#__PURE__*/React.createElement(Button,{kind:ButtonKinds.LightGreen,onClick:function onClick(){return onActivation(id);},icon:/*#__PURE__*/React.createElement(Icons.IconCheck,{fill:\"currentColor\"})},\"\\u0410\\u043A\\u0442\\u0438\\u0432\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"),/*#__PURE__*/React.createElement(Button,{kind:ButtonKinds.Danger,onClick:function onClick(){return onReject(id);},icon:/*#__PURE__*/React.createElement(Icons.IconClose,{fill:\"currentColor\"})},\"\\u041E\\u0442\\u043A\\u043B\\u043E\\u043D\\u0438\\u0442\\u044C\"),/*#__PURE__*/React.createElement(Button,{kind:ButtonKinds.Secondary,onClick:function onClick(){return onOpenCard(id);},style:{marginLeft:10}},\"\\u041A\\u0430\\u0440\\u0442\\u043E\\u0447\\u043A\\u0430 \\u0441\\u043E\\u0442\\u0440\\u0443\\u0434\\u043D\\u0438\\u043A\\u0430\")));})),/*#__PURE__*/React.createElement(\"tfoot\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:3},\"\\u0412\\u0421\\u0415\\u0413\\u041E \\u0417\\u0410\\u041F\\u0418\\u0421\\u0415\\u0419: \",staffNumber),/*#__PURE__*/React.createElement(\"td\",{colSpan:3,align:\"right\"},/*#__PURE__*/React.createElement(\"div\",{className:\"pagination-right\"},/*#__PURE__*/React.createElement(Pagination,{listLength:staffNumber,setOffset:setOffset})))))),/*#__PURE__*/React.createElement(EmployeeCard,{hide:function hide(){return setCardVisible(false);},isVisible:cardVisible}));};","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/company/components/staff/waiting/Waiting.tsx"],"names":["React","useEffect","useState","useDispatch","useSelector","Button","ButtonKinds","Icons","Core","StaffTools","Pagination","PaginationLimit","joinNoEmptyValues","selectStaffWaiting","selectStaffNumberWaiting","getStaffWaiting","getEmployee","activeEmployee","rejectEmployee","EmployeeCard","Waiting","limit","setLimit","offset","setOffset","companyId","setCompanyId","cardVisible","setCardVisible","dispatch","staff","staffNumber","id","company","localId","params","statusSystemName","onOpenCard","onActivation","employeeId","onReject","display","justifyContent","map","employee","surname","name","patronymic","position","email","fio","LightGreen","Danger","Secondary","marginLeft"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport { Button, ButtonKinds, Icons } from '@distate/components';\r\nimport Core from '@distate/core/dist/application/Core';\r\n\r\nimport { StaffTools } from '../StaffTools';\r\nimport { Pagination, PaginationLimit } from '../../../../../common/pagination';\r\nimport { joinNoEmptyValues } from '../../../../../helpers/heplers';\r\nimport { selectStaffWaiting, selectStaffNumberWaiting } from '../../../store/selectors';\r\nimport {\r\n  getStaffWaiting,\r\n  getEmployee,\r\n  activeEmployee,\r\n  rejectEmployee\r\n} from '../../../store/actions';\r\nimport { EmployeeCard } from '../EmployeeCard';\r\n\r\n/** Заявки на активацию (Сотрудники) */\r\nexport const Waiting = () => {\r\n  const [limit, setLimit] = useState(10);\r\n  const [offset, setOffset] = useState(0);\r\n  const [companyId, setCompanyId] = useState();\r\n  const [cardVisible, setCardVisible] = useState(false);\r\n  const dispatch = useDispatch();\r\n\r\n  const staff = useSelector(selectStaffWaiting);\r\n  const staffNumber = useSelector(selectStaffNumberWaiting) || 0;\r\n\r\n  useEffect(() => {\r\n    const id = Core?.company?.localId;\r\n    setCompanyId(id);\r\n    dispatch(\r\n      getStaffWaiting({\r\n        id,\r\n        params: { offset, limit, statusSystemName: 'waiting_for_approval' }\r\n      })\r\n    );\r\n  }, [dispatch, limit, offset]);\r\n\r\n  /** кнопка Карточка сотрудника */\r\n  const onOpenCard = (id: number) => {\r\n    dispatch(getEmployee(id));\r\n    setCardVisible(true);\r\n  };\r\n\r\n  /** кнопка Активировать */\r\n  const onActivation = (employeeId: number) => {\r\n    dispatch(\r\n      activeEmployee({\r\n        employeeId,\r\n        companyId: Core?.company?.localId,\r\n        params: { offset, limit, statusSystemName: 'waiting_for_approval' }\r\n      })\r\n    );\r\n    onOpenCard(employeeId);\r\n  };\r\n\r\n  /** кнопка Отклонить */\r\n  const onReject = (employeeId: number) => {\r\n    dispatch(\r\n      rejectEmployee({\r\n        employeeId,\r\n        companyId: Core?.company?.localId,\r\n        params: { offset, limit, statusSystemName: 'waiting_for_approval' }\r\n      })\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n        <StaffTools id={companyId!} limit={limit} statusSystemName=\"waiting_for_approval\" />\r\n        <PaginationLimit setLimit={setLimit} limit={limit} />\r\n      </div>\r\n\r\n      <table className=\"table\">\r\n        <thead className=\"common-table-head\">\r\n          <tr>\r\n            <td colSpan={2}>ФИО сотрудника</td>\r\n            <td>должность</td>\r\n            <td>e-mail</td>\r\n            <td colSpan={2}></td>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {staff?.map(employee => {\r\n            const { id, surname, name, patronymic, position, email } = employee;\r\n            const fio = joinNoEmptyValues([surname, name, patronymic]);\r\n            return (\r\n              <tr key={id}>\r\n                <td colSpan={2}>{fio}</td>\r\n                <td>{position}</td>\r\n                <td>{email}</td>\r\n                <td align=\"right\" colSpan={2}>\r\n                  <Button\r\n                    kind={ButtonKinds.LightGreen}\r\n                    onClick={() => onActivation(id)}\r\n                    icon={<Icons.IconCheck fill=\"currentColor\" />}\r\n                  >\r\n                    Активировать\r\n                  </Button>\r\n                  <Button\r\n                    kind={ButtonKinds.Danger}\r\n                    onClick={() => onReject(id)}\r\n                    icon={<Icons.IconClose fill=\"currentColor\" />}\r\n                  >\r\n                    Отклонить\r\n                  </Button>\r\n                  <Button\r\n                    kind={ButtonKinds.Secondary}\r\n                    onClick={() => onOpenCard(id)}\r\n                    style={{ marginLeft: 10 }}\r\n                  >\r\n                    Карточка сотрудника\r\n                  </Button>\r\n                </td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n        <tfoot>\r\n          <tr>\r\n            <td colSpan={3}>ВСЕГО ЗАПИСЕЙ: {staffNumber}</td>\r\n            <td colSpan={3} align=\"right\">\r\n              <div className=\"pagination-right\">\r\n                <Pagination listLength={staffNumber} setOffset={setOffset} />\r\n              </div>\r\n            </td>\r\n          </tr>\r\n        </tfoot>\r\n      </table>\r\n      <EmployeeCard hide={() => setCardVisible(false)} isVisible={cardVisible} />\r\n    </>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}