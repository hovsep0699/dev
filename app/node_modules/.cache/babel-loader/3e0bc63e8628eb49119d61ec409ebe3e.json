{"ast":null,"code":"import moment from 'moment';\nexport default function CCertificate(rawCertificate, data) {\n  this.data = data;\n  this.rawCertificate = rawCertificate;\n  this.dnSubject = [];\n  this.dnIssuer = [];\n\n  this.isExtractedFromVerifiedSignature = function () {\n    return this.data.extractedFromVerifiedSignature;\n  };\n\n  this.getRaw = function () {\n    return this.rawCertificate;\n  };\n\n  this.getThumbprint = function () {\n    return this.data.thumbprint;\n  };\n\n  this.getSerialNumber = function () {\n    return this.data.serialNumber;\n  };\n\n  this.getData = function () {\n    return this.data.data;\n  };\n\n  this.getValidFromDate = function () {\n    return _parseDate(this.data.validFrom);\n  };\n\n  this.getValidToDate = function () {\n    return _parseDate(this.data.validTo);\n  };\n\n  this.isActual = function () {\n    return moment(this.getValidToDate(), 'DD.MM.YYYY H:m:s').unix() > moment().unix() && moment(this.getValidFromDate(), 'DD.MM.YYYY H:m:s').unix() < moment().unix();\n  };\n\n  this.dnSubject = _parseString(this.data.subjectName);\n  this.dnIssuer = _parseString(this.data.issuerName);\n\n  function _parseDate(date, bUTC) {\n    bUTC = bUTC == true;\n    var oDate = new Date(date);\n    var arDate = [bUTC ? oDate.getUTCDate() : oDate.getDate(), bUTC ? oDate.getUTCMonth() + 1 : oDate.getMonth() + 1, bUTC ? oDate.getUTCFullYear() : oDate.getFullYear(), bUTC ? oDate.getUTCHours() : oDate.getHours(), bUTC ? oDate.getUTCMinutes() : oDate.getMinutes(), bUTC ? oDate.getUTCSeconds() : oDate.getSeconds()];\n\n    for (var i = 0; i < arDate.length; i++) {\n      while (String(arDate[i]).length < 2) {\n        arDate[i] = \"0\".concat(arDate[i]);\n      }\n    }\n\n    return \"\".concat(arDate[0], \".\").concat(arDate[1], \".\").concat(arDate[2], \" \").concat(arDate[3], \":\").concat(arDate[4], \":\").concat(arDate[5]);\n  }\n\n  function _parseString(str) {\n    function trim(str) {\n      return str.replace(/^\\s+|\\s+$/g, '');\n    }\n\n    var res = [];\n    var DN = '';\n    var DNValue = '';\n    var bIn = false;\n    var bEqual = false;\n\n    for (var i = 0; i < str.length; i++) {\n      if (str[i] == '\"') {\n        bIn = !bIn;\n      } else if (str[i] == '=' && !bIn) {\n        bEqual = true;\n        DNValue = '';\n      } else if (str[i] == ',' && !bIn) {\n        bEqual = false;\n\n        if (DN != '' && DNValue != '') {\n          res[trim(DN)] = trim(DNValue);\n        }\n\n        DN = '';\n      } else if (!bEqual) {\n        DN += str[i];\n      } else {\n        DNValue += str[i];\n      }\n    }\n\n    if (DN != '' && DNValue != '') {\n      res[trim(DN)] = trim(DNValue);\n    }\n\n    var dnReplacements = {\n      ИНН: 'INN',\n      СНИЛС: 'SNILS',\n      ОГРН: 'OGRN',\n      ОГРНИП: 'OGRNIP'\n    };\n\n    for (var j in res) {\n      if (res.hasOwnProperty(j) && dnReplacements[j]) {\n        res[dnReplacements[j]] = res[j];\n        delete res[j];\n      }\n    }\n\n    return res;\n  }\n}","map":{"version":3,"sources":["../../../src/application/certificate/CCertificate.js"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import moment from 'moment';\r\nexport default function CCertificate(rawCertificate, data) {\r\n    this.data = data;\r\n    this.rawCertificate = rawCertificate;\r\n    this.dnSubject = [];\r\n    this.dnIssuer = [];\r\n    this.isExtractedFromVerifiedSignature = function () {\r\n        return this.data.extractedFromVerifiedSignature;\r\n    };\r\n    this.getRaw = function () {\r\n        return this.rawCertificate;\r\n    };\r\n    this.getThumbprint = function () {\r\n        return this.data.thumbprint;\r\n    };\r\n    this.getSerialNumber = function () {\r\n        return this.data.serialNumber;\r\n    };\r\n    this.getData = function () {\r\n        return this.data.data;\r\n    };\r\n    this.getValidFromDate = function () {\r\n        return _parseDate(this.data.validFrom);\r\n    };\r\n    this.getValidToDate = function () {\r\n        return _parseDate(this.data.validTo);\r\n    };\r\n    this.isActual = function () {\r\n        return moment(this.getValidToDate(), 'DD.MM.YYYY H:m:s').unix() > moment().unix() && moment(this.getValidFromDate(), 'DD.MM.YYYY H:m:s').unix() < moment().unix();\r\n    };\r\n    this.dnSubject = _parseString(this.data.subjectName);\r\n    this.dnIssuer = _parseString(this.data.issuerName);\r\n    function _parseDate(date, bUTC) {\r\n        bUTC = bUTC == true;\r\n        const oDate = new Date(date);\r\n        const arDate = [bUTC ? oDate.getUTCDate() : oDate.getDate(), bUTC ? oDate.getUTCMonth() + 1 : oDate.getMonth() + 1, bUTC ? oDate.getUTCFullYear() : oDate.getFullYear(), bUTC ? oDate.getUTCHours() : oDate.getHours(), bUTC ? oDate.getUTCMinutes() : oDate.getMinutes(), bUTC ? oDate.getUTCSeconds() : oDate.getSeconds()];\r\n        for (let i = 0; i < arDate.length; i++) {\r\n            while (String(arDate[i]).length < 2) {\r\n                arDate[i] = `0${arDate[i]}`;\r\n            }\r\n        }\r\n        return `${arDate[0]}.${arDate[1]}.${arDate[2]} ${arDate[3]}:${arDate[4]}:${arDate[5]}`;\r\n    }\r\n    function _parseString(str) {\r\n        function trim(str) {\r\n            return str.replace(/^\\s+|\\s+$/g, '');\r\n        }\r\n        const res = [];\r\n        let DN = '';\r\n        let DNValue = '';\r\n        let bIn = false;\r\n        let bEqual = false;\r\n        for (let i = 0; i < str.length; i++) {\r\n            if (str[i] == '\"') {\r\n                bIn = !bIn;\r\n            }\r\n            else if (str[i] == '=' && !bIn) {\r\n                bEqual = true;\r\n                DNValue = '';\r\n            }\r\n            else if (str[i] == ',' && !bIn) {\r\n                bEqual = false;\r\n                if (DN != '' && DNValue != '') {\r\n                    res[trim(DN)] = trim(DNValue);\r\n                }\r\n                DN = '';\r\n            }\r\n            else if (!bEqual) {\r\n                DN += str[i];\r\n            }\r\n            else {\r\n                DNValue += str[i];\r\n            }\r\n        }\r\n        if (DN != '' && DNValue != '') {\r\n            res[trim(DN)] = trim(DNValue);\r\n        }\r\n        const dnReplacements = {\r\n            ИНН: 'INN',\r\n            СНИЛС: 'SNILS',\r\n            ОГРН: 'OGRN',\r\n            ОГРНИП: 'OGRNIP'\r\n        };\r\n        for (const j in res) {\r\n            if (res.hasOwnProperty(j) && dnReplacements[j]) {\r\n                res[dnReplacements[j]] = res[j];\r\n                delete res[j];\r\n            }\r\n        }\r\n        return res;\r\n    }\r\n}\r\n//# sourceMappingURL=CCertificate.js.map"]},"metadata":{},"sourceType":"module"}