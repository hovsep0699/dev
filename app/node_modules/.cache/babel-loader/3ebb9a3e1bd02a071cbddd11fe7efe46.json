{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{Button,ButtonKinds,Icons,Input}from'@distate/components';import{Pagination,PaginationLimit}from'../../../../common/pagination';import{getCompanyDivisions}from'../../store/actions';import{selectDivisionsRows,selectDivisionsRecordsTotal}from'../../store/selectors';import{ModalDivisionCard}from'./modal-division-card';import{ModalCreateDivision}from'./modal-create-division';/** Подразделения */export var Divisions=function Divisions(){var _useState=useState(10),_useState2=_slicedToArray(_useState,2),limit=_useState2[0],setLimit=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),offset=_useState4[0],setOffset=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),searchTitle=_useState6[0],setSearchTitle=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isVisibleCard=_useState8[0],setIsVisibleCard=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isVisibleCreateDivision=_useState10[0],setIsVisibleCreateDivision=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),divisionProps=_useState12[0],setDivisionProps=_useState12[1];var dispatch=useDispatch();var divisions=useSelector(selectDivisionsRows);var recordsTotal=useSelector(selectDivisionsRecordsTotal);useEffect(function(){dispatch(getCompanyDivisions({props:{offset:offset,limit:limit}}));},[dispatch,limit,offset]);var onSearch=function onSearch(){dispatch(getCompanyDivisions({props:{offset:offset,limit:limit,title:searchTitle}}));};var onOpenModal=function onOpenModal(division){var _address$region,_address$region2;var id=division.id,address=division.address,classificationNumber=division.classificationNumber,kpp=division.kpp,title=division.title,visible=division.visible,contact=division.contact;setDivisionProps({id:id,title:title,kpp:kpp,classificationNumber:classificationNumber,visible:visible,region:address===null||address===void 0?void 0:(_address$region=address.region)===null||_address$region===void 0?void 0:_address$region.id,regionTitle:address===null||address===void 0?void 0:(_address$region2=address.region)===null||_address$region2===void 0?void 0:_address$region2.title,postalCode:address===null||address===void 0?void 0:address.postalCode,district:address===null||address===void 0?void 0:address.district,city:address===null||address===void 0?void 0:address.city,street:address===null||address===void 0?void 0:address.street,building:address===null||address===void 0?void 0:address.building,house:address===null||address===void 0?void 0:address.house,room:address===null||address===void 0?void 0:address.room,settlement:address===null||address===void 0?void 0:address.settlement,phone:contact===null||contact===void 0?void 0:contact.phone,email:contact===null||contact===void 0?void 0:contact.email});setIsVisibleCard(true);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex',justifyContent:'space-between',marginBottom:15}},/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex'}},/*#__PURE__*/React.createElement(Input,{width:400,onChange:function onChange(e){return setSearchTitle(e.target.value);},value:searchTitle}),/*#__PURE__*/React.createElement(Button,{onClick:onSearch,icon:/*#__PURE__*/React.createElement(Icons.IconSearch,{fill:\"currentColor\"})},\"\\u041F\\u043E\\u0438\\u0441\\u043A\")),/*#__PURE__*/React.createElement(PaginationLimit,{setLimit:setLimit,limit:limit})),/*#__PURE__*/React.createElement(\"table\",{className:\"table\"},/*#__PURE__*/React.createElement(\"thead\",{className:\"common-table-head\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,\"\\u041D\\u0430\\u0438\\u043C\\u0435\\u043D\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435\"),/*#__PURE__*/React.createElement(\"td\",{colSpan:2},\"\\u041A\\u041F\\u041F\"))),/*#__PURE__*/React.createElement(\"tbody\",null,divisions===null||divisions===void 0?void 0:divisions.map(function(division){var id=division.id,title=division.title,kpp=division.kpp;return/*#__PURE__*/React.createElement(\"tr\",{key:id},/*#__PURE__*/React.createElement(\"td\",null,title),/*#__PURE__*/React.createElement(\"td\",null,kpp),/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},/*#__PURE__*/React.createElement(Button,{kind:ButtonKinds.Secondary,onClick:function onClick(){return onOpenModal(division);}},\"\\u041A\\u0430\\u0440\\u0442\\u043E\\u0447\\u043A\\u0430 \\u043F\\u043E\\u0434\\u0440\\u0430\\u0437\\u0434\\u0435\\u043B\\u0435\\u043D\\u0438\\u044F\")));})),/*#__PURE__*/React.createElement(\"tfoot\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(Button,{icon:/*#__PURE__*/React.createElement(Icons.IconPlus,{fill:\"currentColor\"}),onClick:function onClick(){return setIsVisibleCreateDivision(true);}},\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043F\\u043E\\u0434\\u0440\\u0430\\u0437\\u0434\\u0435\\u043B\\u0435\\u043D\\u0438\\u0435\")),/*#__PURE__*/React.createElement(\"td\",{align:\"right\",colSpan:2},/*#__PURE__*/React.createElement(Pagination,{listLength:recordsTotal,setOffset:setOffset,limit:limit}))))),isVisibleCard&&/*#__PURE__*/React.createElement(ModalDivisionCard,{isVisible:isVisibleCard,hide:function hide(){return setIsVisibleCard(false);},divisionProps:divisionProps}),isVisibleCreateDivision&&/*#__PURE__*/React.createElement(ModalCreateDivision,{isVisible:isVisibleCreateDivision,hide:function hide(){return setIsVisibleCreateDivision(false);}}));};","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/company/components/divisions/Divisions.tsx"],"names":["React","useEffect","useState","useDispatch","useSelector","Button","ButtonKinds","Icons","Input","Pagination","PaginationLimit","getCompanyDivisions","selectDivisionsRows","selectDivisionsRecordsTotal","ModalDivisionCard","ModalCreateDivision","Divisions","limit","setLimit","offset","setOffset","searchTitle","setSearchTitle","isVisibleCard","setIsVisibleCard","isVisibleCreateDivision","setIsVisibleCreateDivision","divisionProps","setDivisionProps","dispatch","divisions","recordsTotal","props","onSearch","title","onOpenModal","division","id","address","classificationNumber","kpp","visible","contact","region","regionTitle","postalCode","district","city","street","building","house","room","settlement","phone","email","display","justifyContent","marginBottom","e","target","value","map","Secondary"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Button, ButtonKinds, Icons, Input } from '@distate/components';\r\n\r\nimport { Pagination, PaginationLimit } from '../../../../common/pagination';\r\nimport { getCompanyDivisions } from '../../store/actions';\r\nimport { selectDivisionsRows, selectDivisionsRecordsTotal } from '../../store/selectors';\r\nimport { ModalDivisionCard } from './modal-division-card';\r\nimport { ModalCreateDivision } from './modal-create-division';\r\nimport { CompanyDivision } from '../../helpers/company.typings';\r\n\r\n/** Подразделения */\r\nexport const Divisions = () => {\r\n  const [limit, setLimit] = useState(10);\r\n  const [offset, setOffset] = useState(0);\r\n  const [searchTitle, setSearchTitle] = useState<string>();\r\n  const [isVisibleCard, setIsVisibleCard] = useState(false);\r\n  const [isVisibleCreateDivision, setIsVisibleCreateDivision] = useState(false);\r\n  const [divisionProps, setDivisionProps] = useState<CompanyDivision & { id: number }>();\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  const divisions = useSelector(selectDivisionsRows);\r\n  const recordsTotal = useSelector(selectDivisionsRecordsTotal);\r\n\r\n  useEffect(() => {\r\n    dispatch(getCompanyDivisions({ props: { offset, limit } }));\r\n  }, [dispatch, limit, offset]);\r\n\r\n  const onSearch = () => {\r\n    dispatch(getCompanyDivisions({ props: { offset, limit, title: searchTitle } }));\r\n  };\r\n\r\n  const onOpenModal = (division: any) => {\r\n    const { id, address, classificationNumber, kpp, title, visible, contact } = division;\r\n    setDivisionProps({\r\n      id,\r\n      title,\r\n      kpp,\r\n      classificationNumber,\r\n      visible,\r\n      region: address?.region?.id,\r\n      regionTitle: address?.region?.title, \r\n      postalCode: address?.postalCode,\r\n      district: address?.district,\r\n      city: address?.city,\r\n      street: address?.street,\r\n      building: address?.building,\r\n      house: address?.house,\r\n      room: address?.room,\r\n      settlement: address?.settlement,\r\n      phone: contact?.phone,\r\n      email: contact?.email\r\n    });\r\n\r\n    setIsVisibleCard(true);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: 15 }}>\r\n        <div style={{ display: 'flex' }}>\r\n          <Input width={400} onChange={e => setSearchTitle(e.target.value)} value={searchTitle} />\r\n          <Button onClick={onSearch} icon={<Icons.IconSearch fill=\"currentColor\" />}>\r\n            Поиск\r\n          </Button>\r\n        </div>\r\n        <PaginationLimit setLimit={setLimit} limit={limit} />\r\n      </div>\r\n\r\n      <table className=\"table\">\r\n        <thead className=\"common-table-head\">\r\n          <tr>\r\n            <td>Наименование</td>\r\n            <td colSpan={2}>КПП</td>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {divisions?.map(division => {\r\n            const { id, title, kpp } = division;\r\n            return (\r\n              <tr key={id}>\r\n                <td>{title}</td>\r\n                <td>{kpp}</td>\r\n                <td align=\"right\">\r\n                  <Button kind={ButtonKinds.Secondary} onClick={() => onOpenModal(division)}>\r\n                    Карточка подразделения\r\n                  </Button>\r\n                </td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n        <tfoot>\r\n          <tr>\r\n            <td>\r\n              <Button\r\n                icon={<Icons.IconPlus fill=\"currentColor\" />}\r\n                onClick={() => setIsVisibleCreateDivision(true)}\r\n              >\r\n                Добавить подразделение\r\n              </Button>\r\n            </td>\r\n            <td align=\"right\" colSpan={2}>\r\n              <Pagination listLength={recordsTotal} setOffset={setOffset} limit={limit} />\r\n            </td>\r\n          </tr>\r\n        </tfoot>\r\n      </table>\r\n\r\n      {isVisibleCard && <ModalDivisionCard\r\n        isVisible={isVisibleCard}\r\n        hide={() => setIsVisibleCard(false)}\r\n        divisionProps={divisionProps!}\r\n      />}\r\n      {isVisibleCreateDivision && <ModalCreateDivision\r\n        isVisible={isVisibleCreateDivision}\r\n        hide={() => setIsVisibleCreateDivision(false)}\r\n      />}\r\n    </>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}