{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React from'react';import{useDispatch,useSelector}from'react-redux';import{Button,ButtonKinds}from'@distate/components';import{getNaturalEntityContractors,createPersonInvitation}from'../../store/actions';import{naturalEntity}from'../../store/selectors';import{RelationStatus,ContractorTypes,DestinationType}from'../../helpers/contractors.typings';import{blockingContractor}from'../../store/actions';import{Pagination}from'../../../../common/pagination';import{NaturalEntityCard}from'./NaturalEntityCard';export var NaturalEntityTable=function NaturalEntityTable(){var dispatch=useDispatch();var _useSelector=useSelector(naturalEntity),_useSelector$rows=_useSelector.rows,contractorList=_useSelector$rows===void 0?[]:_useSelector$rows,_useSelector$offset=_useSelector.offset,offsetSelector=_useSelector$offset===void 0?0:_useSelector$offset,recordsTotal=_useSelector.recordsTotal;var _React$useState=React.useState(offsetSelector),_React$useState2=_slicedToArray(_React$useState,2),offset=_React$useState2[0],setOffset=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),isOpenCard=_React$useState4[0],setIsOpenCard=_React$useState4[1];var _React$useState5=React.useState(),_React$useState6=_slicedToArray(_React$useState5,2),userId=_React$useState6[0],setUserId=_React$useState6[1];var _React$useState7=React.useState(),_React$useState8=_slicedToArray(_React$useState7,2),contractorId=_React$useState8[0],setContractorId=_React$useState8[1];React.useEffect(function(){dispatch(getNaturalEntityContractors({offset:offset}));},[dispatch,offset]);/** Блокировка контрагента */var onBlock=function onBlock(id){dispatch(blockingContractor({id:id,contractorType:ContractorTypes.natural_entity}));};/** Нажатие кнопки \"пригласить повторно\" */var onInvite=function onInvite(id){dispatch(createPersonInvitation({personID:id,type:DestinationType.Local}));};var openCard=function openCard(userId,contractorId){setUserId(userId);setContractorId(contractorId);setIsOpenCard(true);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"table\",{className:\"table\"},/*#__PURE__*/React.createElement(\"thead\",{className:\"common-table-head\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,\"\\u041A\\u043E\\u043D\\u0442\\u0440\\u0430\\u0433\\u0435\\u043D\\u0442\"),/*#__PURE__*/React.createElement(\"td\",null,\"\\u0421\\u041D\\u0418\\u041B\\u0421\"),/*#__PURE__*/React.createElement(\"td\",null,\"\\u0421\\u0442\\u0430\\u0442\\u0443\\u0441\"),/*#__PURE__*/React.createElement(\"td\",null))),/*#__PURE__*/React.createElement(\"tbody\",null,contractorList.map(function(item){var contractor;/** сборка ФИО */var patronymic=(item===null||item===void 0?void 0:item.patronymic)?\" \".concat(item.patronymic):'';contractor=item.surname+' '+item.name+patronymic;var isActive=item.status===RelationStatus.Active;var status=isActive?'Активен':'Заблокирован';return/*#__PURE__*/React.createElement(\"tr\",{key:item.id},/*#__PURE__*/React.createElement(\"td\",null,contractor),/*#__PURE__*/React.createElement(\"td\",null,item.socialNumber),/*#__PURE__*/React.createElement(\"td\",null,status),/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},isActive?/*#__PURE__*/React.createElement(Button,{kind:ButtonKinds.Danger,onClick:function onClick(){return onBlock(item.contractorId);},className:\"contractor-table-btn\"},\"\\u0417\\u0430\\u0431\\u043B\\u043E\\u043A\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"):/*#__PURE__*/React.createElement(Button,{kind:ButtonKinds.Secondary,onClick:function onClick(){return onInvite(item.id);},className:\"contractor-table-btn\"},\"\\u041F\\u0440\\u0438\\u0433\\u043B\\u0430\\u0441\\u0438\\u0442\\u044C \\u043F\\u043E\\u0432\\u0442\\u043E\\u0440\\u043D\\u043E\"),/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){return openCard(item.id,item.contractorId);},className:\"contractor-table-btn\"},\"\\u041A\\u0430\\u0440\\u0442\\u043E\\u0447\\u043A\\u0430 \\u043A\\u043E\\u043D\\u0442\\u0440\\u0430\\u0433\\u0435\\u043D\\u0442\\u0430\")));})),/*#__PURE__*/React.createElement(\"tfoot\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:4},/*#__PURE__*/React.createElement(\"div\",{className:\"pagination-right\"},/*#__PURE__*/React.createElement(Pagination,{listLength:recordsTotal,setOffset:setOffset})))))),/*#__PURE__*/React.createElement(NaturalEntityCard,{isVisible:isOpenCard,hide:function hide(){return setIsOpenCard(!isOpenCard);},userId:userId,contractorId:contractorId}));};","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/contractors/components/natural-entity/NaturalEntityTable.tsx"],"names":["React","useDispatch","useSelector","Button","ButtonKinds","getNaturalEntityContractors","createPersonInvitation","naturalEntity","RelationStatus","ContractorTypes","DestinationType","blockingContractor","Pagination","NaturalEntityCard","NaturalEntityTable","dispatch","rows","contractorList","offset","offsetSelector","recordsTotal","useState","setOffset","isOpenCard","setIsOpenCard","userId","setUserId","contractorId","setContractorId","useEffect","onBlock","id","contractorType","natural_entity","onInvite","personID","type","Local","openCard","map","item","contractor","patronymic","surname","name","isActive","status","Active","socialNumber","Danger","Secondary"],"mappings":"2KAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CAEA,OAASC,MAAT,CAAiBC,WAAjB,KAAoC,qBAApC,CAEA,OAASC,2BAAT,CAAsCC,sBAAtC,KAAoE,qBAApE,CACA,OAASC,aAAT,KAA8B,uBAA9B,CACA,OACEC,cADF,CAEEC,eAFF,CAGEC,eAHF,KAIO,mCAJP,CAKA,OAASC,kBAAT,KAAmC,qBAAnC,CACA,OAASC,UAAT,KAA2B,+BAA3B,CACA,OAASC,iBAAT,KAAkC,qBAAlC,CAEA,MAAO,IAAMC,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,EAAM,CACtC,GAAMC,CAAAA,QAAQ,CAAGd,WAAW,EAA5B,CADsC,iBAE0CC,WAAW,CACzFK,aADyF,CAFrD,gCAE9BS,IAF8B,CAExBC,cAFwB,4BAEP,EAFO,oDAEHC,MAFG,CAEKC,cAFL,8BAEsB,CAFtB,qBAEyBC,YAFzB,cAEyBA,YAFzB,qBAKVpB,KAAK,CAACqB,QAAN,CAAeF,cAAf,CALU,oDAK/BD,MAL+B,qBAKvBI,SALuB,0CAMFtB,KAAK,CAACqB,QAAN,CAAe,KAAf,CANE,qDAM/BE,UAN+B,qBAMnBC,aANmB,0CAOVxB,KAAK,CAACqB,QAAN,EAPU,qDAO/BI,MAP+B,qBAOvBC,SAPuB,0CAQE1B,KAAK,CAACqB,QAAN,EARF,qDAQ/BM,YAR+B,qBAQjBC,eARiB,qBAUtC5B,KAAK,CAAC6B,SAAN,CAAgB,UAAM,CACpBd,QAAQ,CAACV,2BAA2B,CAAC,CAAEa,MAAM,CAANA,MAAF,CAAD,CAA5B,CAAR,CACD,CAFD,CAEG,CAACH,QAAD,CAAWG,MAAX,CAFH,EAIA,6BACA,GAAMY,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,CAACC,EAAD,CAAgB,CAC9BhB,QAAQ,CAACJ,kBAAkB,CAAC,CAAEoB,EAAE,CAAFA,EAAF,CAAMC,cAAc,CAAEvB,eAAe,CAACwB,cAAtC,CAAD,CAAnB,CAAR,CACD,CAFD,CAIA,2CACA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACH,EAAD,CAAgB,CAC/BhB,QAAQ,CAACT,sBAAsB,CAAC,CAAE6B,QAAQ,CAAEJ,EAAZ,CAAgBK,IAAI,CAAE1B,eAAe,CAAC2B,KAAtC,CAAD,CAAvB,CAAR,CACD,CAFD,CAIA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACb,MAAD,CAAiBE,YAAjB,CAA0C,CACzDD,SAAS,CAACD,MAAD,CAAT,CACAG,eAAe,CAACD,YAAD,CAAf,CACAH,aAAa,CAAC,IAAD,CAAb,CACD,CAJD,CAMA,mBACE,qDACE,6BAAO,SAAS,CAAC,OAAjB,eACE,6BAAO,SAAS,CAAC,mBAAjB,eACE,2CACE,6FADF,cAEE,+DAFF,cAGE,qEAHF,cAIE,8BAJF,CADF,CADF,cASE,iCACGP,cAAc,CAACsB,GAAf,CAAmB,SAAAC,IAAI,CAAI,CAC1B,GAAIC,CAAAA,UAAJ,CACA,iBACA,GAAMC,CAAAA,UAAU,CAAG,CAAAF,IAAI,OAAJ,EAAAA,IAAI,SAAJ,QAAAA,IAAI,CAAEE,UAAN,aAAuBF,IAAI,CAACE,UAA5B,EAA2C,EAA9D,CACAD,UAAU,CAAGD,IAAI,CAACG,OAAL,CAAe,GAAf,CAAqBH,IAAI,CAACI,IAA1B,CAAiCF,UAA9C,CAEA,GAAMG,CAAAA,QAAQ,CAAGL,IAAI,CAACM,MAAL,GAAgBtC,cAAc,CAACuC,MAAhD,CACA,GAAMD,CAAAA,MAAM,CAAGD,QAAQ,CAAG,SAAH,CAAe,cAAtC,CAEA,mBACE,0BAAI,GAAG,CAAEL,IAAI,CAACT,EAAd,eACE,8BAAKU,UAAL,CADF,cAEE,8BAAKD,IAAI,CAACQ,YAAV,CAFF,cAGE,8BAAKF,MAAL,CAHF,cAIE,0BAAI,KAAK,CAAC,OAAV,EACGD,QAAQ,cACP,oBAAC,MAAD,EACE,IAAI,CAAEzC,WAAW,CAAC6C,MADpB,CAEE,OAAO,CAAE,yBAAMnB,CAAAA,OAAO,CAACU,IAAI,CAACb,YAAN,CAAb,EAFX,CAGE,SAAS,CAAC,sBAHZ,mFADO,cASP,oBAAC,MAAD,EACE,IAAI,CAAEvB,WAAW,CAAC8C,SADpB,CAEE,OAAO,CAAE,yBAAMhB,CAAAA,QAAQ,CAACM,IAAI,CAACT,EAAN,CAAd,EAFX,CAGE,SAAS,CAAC,sBAHZ,kHAVJ,cAkBE,oBAAC,MAAD,EACE,OAAO,CAAE,yBAAMO,CAAAA,QAAQ,CAACE,IAAI,CAACT,EAAN,CAAUS,IAAI,CAACb,YAAf,CAAd,EADX,CAEE,SAAS,CAAC,sBAFZ,wHAlBF,CAJF,CADF,CAgCD,CAzCA,CADH,CATF,cAqDE,8CACE,2CACE,0BAAI,OAAO,CAAE,CAAb,eACE,2BAAK,SAAS,CAAC,kBAAf,eACE,oBAAC,UAAD,EAAY,UAAU,CAAEP,YAAxB,CAAsC,SAAS,CAAEE,SAAjD,EADF,CADF,CADF,CADF,CArDF,CADF,cAgEE,oBAAC,iBAAD,EACE,SAAS,CAAEC,UADb,CAEE,IAAI,CAAE,sBAAMC,CAAAA,aAAa,CAAC,CAACD,UAAF,CAAnB,EAFR,CAGE,MAAM,CAAEE,MAHV,CAIE,YAAY,CAAEE,YAJhB,EAhEF,CADF,CAyED,CAvGM","sourcesContent":["import React from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport { Button, ButtonKinds } from '@distate/components';\r\n\r\nimport { getNaturalEntityContractors, createPersonInvitation } from '../../store/actions';\r\nimport { naturalEntity } from '../../store/selectors';\r\nimport {\r\n  RelationStatus,\r\n  ContractorTypes,\r\n  DestinationType\r\n} from '../../helpers/contractors.typings';\r\nimport { blockingContractor } from '../../store/actions';\r\nimport { Pagination } from '../../../../common/pagination';\r\nimport { NaturalEntityCard } from './NaturalEntityCard';\r\n\r\nexport const NaturalEntityTable = () => {\r\n  const dispatch = useDispatch();\r\n  const { rows: contractorList = [], offset: offsetSelector = 0, recordsTotal } = useSelector(\r\n    naturalEntity\r\n  );\r\n  const [offset, setOffset] = React.useState(offsetSelector);\r\n  const [isOpenCard, setIsOpenCard] = React.useState(false);\r\n  const [userId, setUserId] = React.useState<number>();\r\n  const [contractorId, setContractorId] = React.useState<number>();\r\n\r\n  React.useEffect(() => {\r\n    dispatch(getNaturalEntityContractors({ offset }));\r\n  }, [dispatch, offset]);\r\n\r\n  /** Блокировка контрагента */\r\n  const onBlock = (id: number) => {\r\n    dispatch(blockingContractor({ id, contractorType: ContractorTypes.natural_entity }));\r\n  };\r\n\r\n  /** Нажатие кнопки \"пригласить повторно\" */\r\n  const onInvite = (id: number) => {\r\n    dispatch(createPersonInvitation({ personID: id, type: DestinationType.Local }));\r\n  };\r\n\r\n  const openCard = (userId: number, contractorId: number) => {\r\n    setUserId(userId);\r\n    setContractorId(contractorId);\r\n    setIsOpenCard(true);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <table className=\"table\">\r\n        <thead className=\"common-table-head\">\r\n          <tr>\r\n            <td>Контрагент</td>\r\n            <td>СНИЛС</td>\r\n            <td>Статус</td>\r\n            <td></td>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {contractorList.map(item => {\r\n            let contractor: string;\r\n            /** сборка ФИО */\r\n            const patronymic = item?.patronymic ? ` ${item.patronymic}` : '';\r\n            contractor = item.surname + ' ' + item.name + patronymic;\r\n\r\n            const isActive = item.status === RelationStatus.Active;\r\n            const status = isActive ? 'Активен' : 'Заблокирован';\r\n\r\n            return (\r\n              <tr key={item.id}>\r\n                <td>{contractor}</td>\r\n                <td>{item.socialNumber}</td>\r\n                <td>{status}</td>\r\n                <td align=\"right\">\r\n                  {isActive ? (\r\n                    <Button\r\n                      kind={ButtonKinds.Danger}\r\n                      onClick={() => onBlock(item.contractorId)}\r\n                      className=\"contractor-table-btn\"\r\n                    >\r\n                      Заблокировать\r\n                    </Button>\r\n                  ) : (\r\n                    <Button\r\n                      kind={ButtonKinds.Secondary}\r\n                      onClick={() => onInvite(item.id)}\r\n                      className=\"contractor-table-btn\"\r\n                    >\r\n                      Пригласить повторно\r\n                    </Button>\r\n                  )}\r\n                  <Button\r\n                    onClick={() => openCard(item.id, item.contractorId)}\r\n                    className=\"contractor-table-btn\"\r\n                  >\r\n                    Карточка контрагента\r\n                  </Button>\r\n                </td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n        <tfoot>\r\n          <tr>\r\n            <td colSpan={4}>\r\n              <div className=\"pagination-right\">\r\n                <Pagination listLength={recordsTotal} setOffset={setOffset} />\r\n              </div>\r\n            </td>\r\n          </tr>\r\n        </tfoot>\r\n      </table>\r\n      <NaturalEntityCard\r\n        isVisible={isOpenCard}\r\n        hide={() => setIsOpenCard(!isOpenCard)}\r\n        userId={userId!}\r\n        contractorId={contractorId!}\r\n      />\r\n    </>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}