{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{Button,ButtonKinds}from'@distate/components';import{Pagination}from'../../../common/pagination';import{TariffCard}from'./tariff-card';import{Tools}from'./tools';import{getActiveTariffs,getArchivedTariffs,getTariffTypes,getTariffStatuses,setIsOpenTariffCreate,setIsOpenTariffCard,setViewTariffId}from'../store/actions';import{activeTariffRowsSelector,activeTariffRecordsTotalSelector,archivedTariffRowsSelector,archivedTariffRecordsTotalSelector,viewTariffIdSelector,isOpenTariffCreateSelector,isOpenTariffCardSelector}from'../store/selects';import{TariffCreate}from'./tariff-card/TariffCreate';export var TariffStatusType;/** Тарифы */(function(TariffStatusType){TariffStatusType[\"active\"]=\"active\";TariffStatusType[\"archived\"]=\"archived\";})(TariffStatusType||(TariffStatusType={}));export var Tariff=function Tariff(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),offset=_useState2[0],setOffset=_useState2[1];var _useState3=useState(TariffStatusType.active),_useState4=_slicedToArray(_useState3,2),tariffStatus=_useState4[0],setTariffStatus=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),currentTariff=_useState6[0],setCurrentTariff=_useState6[1];var dispatch=useDispatch();var activeTariffs=useSelector(activeTariffRowsSelector);var archivedTariffs=useSelector(archivedTariffRowsSelector);var activeTotal=useSelector(activeTariffRecordsTotalSelector);var archivedTotal=useSelector(archivedTariffRecordsTotalSelector);var viewTariffId=useSelector(viewTariffIdSelector);var isOpenTariffCreate=useSelector(isOpenTariffCreateSelector);var isOpenTariffCard=useSelector(isOpenTariffCardSelector);var rows=tariffStatus===TariffStatusType.active?activeTariffs:archivedTariffs;var recordsTotal=tariffStatus===TariffStatusType.active?activeTotal:archivedTotal;useEffect(function(){dispatch(getTariffTypes());dispatch(getTariffStatuses());},[dispatch]);useEffect(function(){var isActive=tariffStatus===TariffStatusType.active;var isArchived=tariffStatus===TariffStatusType.archived;isActive&&dispatch(getActiveTariffs({offset:offset,limit:10}));isArchived&&dispatch(getArchivedTariffs({offset:offset,limit:10}));},[tariffStatus,offset,dispatch]);var onOpenCard=function onOpenCard(item){dispatch(setIsOpenTariffCard({isOpenTariffCard:true}));setCurrentTariff(item);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Tools,{tariffStatus:tariffStatus,setTariffStatus:setTariffStatus}),/*#__PURE__*/React.createElement(\"div\",{style:{marginTop:15}},/*#__PURE__*/React.createElement(\"table\",{className:\"table\"},/*#__PURE__*/React.createElement(\"thead\",{className:\"common-table-head\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:2},\"\\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435\"),/*#__PURE__*/React.createElement(\"td\",null,\"\\u0442\\u0438\\u043F\"),/*#__PURE__*/React.createElement(\"td\",{align:\"center\"},\"\\u043A\\u043E\\u043C\\u043F\\u0430\\u043D\\u0438\\u0439\"),/*#__PURE__*/React.createElement(\"td\",null))),/*#__PURE__*/React.createElement(\"tbody\",null,!rows&&/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:5},\"\\u042D\\u0442\\u043E\\u0442 \\u0441\\u043F\\u0438\\u0441\\u043E\\u043A \\u0442\\u0430\\u0440\\u0438\\u0444\\u043E\\u0432 \\u043F\\u0443\\u0441\\u0442.\")),rows===null||rows===void 0?void 0:rows.map(function(item){var id=item.id,title=item.title,type_title=item.type_title,companies_counter=item.companies_counter;return/*#__PURE__*/React.createElement(\"tr\",{key:id},/*#__PURE__*/React.createElement(\"td\",{colSpan:2},title),/*#__PURE__*/React.createElement(\"td\",null,type_title),/*#__PURE__*/React.createElement(\"td\",{align:\"center\"},companies_counter),/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},/*#__PURE__*/React.createElement(Button,{kind:ButtonKinds.Secondary,onClick:function onClick(){return onOpenCard(item);}},\"\\u041A\\u0430\\u0440\\u0442\\u043E\\u0447\\u043A\\u0430 \\u0442\\u0430\\u0440\\u0438\\u0444\\u0430\")));})),/*#__PURE__*/React.createElement(\"tfoot\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:5},/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex',justifyContent:'space-between'}},/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex',alignItems:'center'}},\"\\u0412\\u0421\\u0415\\u0413\\u041E \\u0417\\u0410\\u041F\\u0418\\u0421\\u0415\\u0419: \",recordsTotal||0),/*#__PURE__*/React.createElement(Pagination,{listLength:recordsTotal,setOffset:setOffset}))))))),isOpenTariffCard&&/*#__PURE__*/React.createElement(TariffCard,{isVisible:isOpenTariffCard,hide:function hide(){dispatch(setIsOpenTariffCard({isOpenTariffCard:false}));dispatch(setViewTariffId({viewTariffId:undefined}));},tariffId:viewTariffId||currentTariff.id}),isOpenTariffCreate&&/*#__PURE__*/React.createElement(TariffCreate,{isVisible:isOpenTariffCreate,hide:function hide(){return dispatch(setIsOpenTariffCreate({isOpenTariffCreate:false}));}}));};","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/tariff/components/Tariff.tsx"],"names":["React","useEffect","useState","useDispatch","useSelector","Button","ButtonKinds","Pagination","TariffCard","Tools","getActiveTariffs","getArchivedTariffs","getTariffTypes","getTariffStatuses","setIsOpenTariffCreate","setIsOpenTariffCard","setViewTariffId","activeTariffRowsSelector","activeTariffRecordsTotalSelector","archivedTariffRowsSelector","archivedTariffRecordsTotalSelector","viewTariffIdSelector","isOpenTariffCreateSelector","isOpenTariffCardSelector","TariffCreate","TariffStatusType","Tariff","offset","setOffset","active","tariffStatus","setTariffStatus","currentTariff","setCurrentTariff","dispatch","activeTariffs","archivedTariffs","activeTotal","archivedTotal","viewTariffId","isOpenTariffCreate","isOpenTariffCard","rows","recordsTotal","isActive","isArchived","archived","limit","onOpenCard","item","marginTop","map","id","title","type_title","companies_counter","Secondary","display","justifyContent","alignItems","undefined"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Button, ButtonKinds } from '@distate/components';\r\nimport { Pagination } from '../../../common/pagination';\r\nimport { TariffCard } from './tariff-card';\r\nimport { Tools } from './tools';\r\nimport {\r\n  getActiveTariffs,\r\n  getArchivedTariffs,\r\n  getTariffTypes,\r\n  getTariffStatuses,\r\n  setIsOpenTariffCreate,\r\n  setIsOpenTariffCard,\r\n  setViewTariffId\r\n} from '../store/actions';\r\nimport {\r\n  activeTariffRowsSelector,\r\n  activeTariffRecordsTotalSelector,\r\n  archivedTariffRowsSelector,\r\n  archivedTariffRecordsTotalSelector,\r\n  viewTariffIdSelector,\r\n  isOpenTariffCreateSelector,\r\n  isOpenTariffCardSelector\r\n} from '../store/selects';\r\nimport { TariffCreate } from './tariff-card/TariffCreate';\r\n\r\nexport enum TariffStatusType {\r\n  active = 'active',\r\n  archived = 'archived'\r\n}\r\n\r\n/** Тарифы */\r\nexport const Tariff = () => {\r\n  const [offset, setOffset] = useState(0);\r\n  const [tariffStatus, setTariffStatus] = useState(TariffStatusType.active);\r\n  const [currentTariff, setCurrentTariff] = useState<any>();\r\n\r\n  const dispatch = useDispatch();\r\n  const activeTariffs = useSelector(activeTariffRowsSelector);\r\n  const archivedTariffs = useSelector(archivedTariffRowsSelector);\r\n  const activeTotal = useSelector(activeTariffRecordsTotalSelector);\r\n  const archivedTotal = useSelector(archivedTariffRecordsTotalSelector);\r\n  const viewTariffId = useSelector(viewTariffIdSelector);\r\n  const isOpenTariffCreate = useSelector(isOpenTariffCreateSelector);\r\n  const isOpenTariffCard = useSelector(isOpenTariffCardSelector);\r\n\r\n  const rows = tariffStatus === TariffStatusType.active ? activeTariffs : archivedTariffs;\r\n  const recordsTotal = tariffStatus === TariffStatusType.active ? activeTotal : archivedTotal;\r\n\r\n  useEffect(() => {\r\n    dispatch(getTariffTypes());\r\n    dispatch(getTariffStatuses());\r\n  }, [dispatch]);\r\n\r\n  useEffect(() => {\r\n    const isActive = tariffStatus === TariffStatusType.active;\r\n    const isArchived = tariffStatus === TariffStatusType.archived;\r\n\r\n    isActive && dispatch(getActiveTariffs({ offset, limit: 10 }));\r\n    isArchived && dispatch(getArchivedTariffs({ offset, limit: 10 }));\r\n  }, [tariffStatus, offset, dispatch]);\r\n\r\n  const onOpenCard = (item: {}) => {\r\n    dispatch(setIsOpenTariffCard({ isOpenTariffCard: true }));\r\n    setCurrentTariff(item);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Tools tariffStatus={tariffStatus} setTariffStatus={setTariffStatus} />\r\n      <div style={{ marginTop: 15 }}>\r\n        <table className=\"table\">\r\n          <thead className=\"common-table-head\">\r\n            <tr>\r\n              <td colSpan={2}>название</td>\r\n              <td>тип</td>\r\n              <td align=\"center\">компаний</td>\r\n              <td></td>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {!rows && (\r\n              <tr>\r\n                <td colSpan={5}>Этот список тарифов пуст.</td>\r\n              </tr>\r\n            )}\r\n            {rows?.map((item: any) => {\r\n              const { id, title, type_title, companies_counter } = item;\r\n              return (\r\n                <tr key={id}>\r\n                  <td colSpan={2}>{title}</td>\r\n                  <td>{type_title}</td>\r\n                  <td align=\"center\">{companies_counter}</td>\r\n                  <td align=\"right\">\r\n                    <Button kind={ButtonKinds.Secondary} onClick={() => onOpenCard(item)}>\r\n                      Карточка тарифа\r\n                    </Button>\r\n                  </td>\r\n                </tr>\r\n              );\r\n            })}\r\n          </tbody>\r\n          <tfoot>\r\n            <tr>\r\n              <td colSpan={5}>\r\n                <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n                  <div style={{ display: 'flex', alignItems: 'center' }}>\r\n                    ВСЕГО ЗАПИСЕЙ: {recordsTotal || 0}\r\n                  </div>\r\n                  <Pagination listLength={recordsTotal} setOffset={setOffset} />\r\n                </div>\r\n              </td>\r\n            </tr>\r\n          </tfoot>\r\n        </table>\r\n      </div>\r\n      {isOpenTariffCard && (\r\n        <TariffCard\r\n          isVisible={isOpenTariffCard}\r\n          hide={() => {\r\n            dispatch(setIsOpenTariffCard({ isOpenTariffCard: false }));\r\n            dispatch(setViewTariffId({ viewTariffId: undefined }));\r\n          }}\r\n          tariffId={viewTariffId || currentTariff.id}\r\n        />\r\n      )}\r\n\r\n      {isOpenTariffCreate && (\r\n        <TariffCreate\r\n          isVisible={isOpenTariffCreate}\r\n          hide={() => dispatch(setIsOpenTariffCreate({ isOpenTariffCreate: false }))}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}