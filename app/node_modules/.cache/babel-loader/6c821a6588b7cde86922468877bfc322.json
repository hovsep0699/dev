{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React from'react';import{useSelector,useDispatch}from'react-redux';import{Button,ButtonKinds}from'@distate/components';import{ContractorTypes,InvitationDecision,DestinationType,IncomeContractorStatus}from'../../helpers/contractors.typings';import{invitationDecision}from'../../store/actions';import{getInviteYouContractor}from'../../store/actions';import{inviteYou}from'../../store/selectors';import{Pagination}from'../../../../common/pagination';import{InviteYouTools}from'./InviteYouTools';import{InfoBadge}from'../../../../common/info-badge';import{TruncateText}from'../../../../common/truncate-text';import{arrToString}from'../../helpers/contractors.helpers';export var InviteYouContractor=function InviteYouContractor(){var dispatch=useDispatch();var _useSelector=useSelector(inviteYou),_useSelector$rows=_useSelector.rows,contractorList=_useSelector$rows===void 0?[]:_useSelector$rows,recordsTotal=_useSelector.recordsTotal,_useSelector$offset=_useSelector.offset,offsetSelector=_useSelector$offset===void 0?0:_useSelector$offset,_useSelector$searchPa=_useSelector.searchParams,searchParams=_useSelector$searchPa===void 0?{}:_useSelector$searchPa;var _React$useState=React.useState(offsetSelector),_React$useState2=_slicedToArray(_React$useState,2),offset=_React$useState2[0],setOffset=_React$useState2[1];React.useEffect(function(){dispatch(getInviteYouContractor(_objectSpread(_objectSpread({},searchParams),{},{offset:offset})));// eslint-disable-next-line react-hooks/exhaustive-deps\n},[dispatch,offset]);/** Принять приглашение */var onAccept=function onAccept(id){dispatch(invitationDecision({id:id,decision:InvitationDecision.accept,offset:offset,searchParams:searchParams}));};/** Отклонить приглашение */var onReject=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(id){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(invitationDecision({id:id,decision:InvitationDecision.reject,offset:offset,searchParams:searchParams}));case 1:case\"end\":return _context.stop();}}},_callee);}));return function onReject(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(InviteYouTools,null),/*#__PURE__*/React.createElement(\"table\",{className:\"table\"},/*#__PURE__*/React.createElement(\"thead\",{className:\"common-table-head\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,\"\\u041A\\u043E\\u043D\\u0442\\u0440\\u0430\\u0433\\u0435\\u043D\\u0442\"),/*#__PURE__*/React.createElement(\"td\",{align:\"center\"},\"\\u0422\\u0438\\u043F\"),/*#__PURE__*/React.createElement(\"td\",null,\"\\u0421\\u0442\\u0430\\u0442\\u0443\\u0441\"),/*#__PURE__*/React.createElement(\"td\",null,\"\\u0414\\u043E\\u043F\\u043E\\u043B\\u043D\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\"),/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},\"\\u0414\\u0430\\u0442\\u0430 \\u0441\\u043E\\u0437\\u0434\\u0430\\u043D\\u0438\\u044F\"),/*#__PURE__*/React.createElement(\"td\",null))),/*#__PURE__*/React.createElement(\"tbody\",null,contractorList.map(function(item){var id=item.id,fnsUid=item.fnsUid,network=item.network,surname=item.surname,name=item.name,patronymic=item.patronymic,contractorType=item.contractorType,inn=item.inn,title=item.title,errorMessage=item.errorMessage,itemStatus=item.status,createdAt=item.createdAt;/** для колонки Контрагент */var contractor;if(contractorType===ContractorTypes.natural_entity){contractor=arrToString([surname,name,patronymic]);}else{contractor=arrToString([title,inn]);}/** для колонки Дополтенельно */var additionally=arrToString([fnsUid,network]);var type;switch(item.type){case null:case DestinationType.Local:type='Локальный';break;case DestinationType.Roaming:type='Роуминг';break;case DestinationType.LoaclRoaming:type='Локальный Роуминг';break;case DestinationType.Connector:type='Коннектор';break;case DestinationType.Hub1c:type='1С-ЭДО';break;default:type='';}var status;switch(itemStatus){case IncomeContractorStatus.processed:status='Обработано';break;case IncomeContractorStatus.created:status='Ожидание';break;case IncomeContractorStatus.error:status='Ошибка';break;default:status='';}var isError=itemStatus===IncomeContractorStatus.error;return/*#__PURE__*/React.createElement(\"tr\",{key:id},/*#__PURE__*/React.createElement(\"td\",null,contractor&&/*#__PURE__*/React.createElement(TruncateText,{text:contractor})),/*#__PURE__*/React.createElement(\"td\",{align:\"center\"},type),/*#__PURE__*/React.createElement(\"td\",null,isError?/*#__PURE__*/React.createElement(InfoBadge,{str:status,title:errorMessage||status}):status),/*#__PURE__*/React.createElement(\"td\",null,(fnsUid||network)&&/*#__PURE__*/React.createElement(TruncateText,{text:additionally})),/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},createdAt),/*#__PURE__*/React.createElement(\"td\",null,itemStatus===IncomeContractorStatus.created&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Button,{kind:ButtonKinds.Secondary,onClick:function onClick(){return onAccept(id);}},\"\\u041F\\u0440\\u0438\\u043D\\u044F\\u0442\\u044C\"),' ',/*#__PURE__*/React.createElement(Button,{kind:ButtonKinds.Danger,onClick:function onClick(){return onReject(id);}},\"\\u041E\\u0442\\u043A\\u043B\\u043E\\u043D\\u0438\\u0442\\u044C\"))));})),/*#__PURE__*/React.createElement(\"tfoot\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:6},/*#__PURE__*/React.createElement(\"div\",{className:\"pagination-right\"},/*#__PURE__*/React.createElement(Pagination,{listLength:recordsTotal,setOffset:setOffset})))))));};","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/contractors/components/invite-you/InviteYouContractor.tsx"],"names":["React","useSelector","useDispatch","Button","ButtonKinds","ContractorTypes","InvitationDecision","DestinationType","IncomeContractorStatus","invitationDecision","getInviteYouContractor","inviteYou","Pagination","InviteYouTools","InfoBadge","TruncateText","arrToString","InviteYouContractor","dispatch","rows","contractorList","recordsTotal","offset","offsetSelector","searchParams","useState","setOffset","useEffect","onAccept","id","decision","accept","onReject","reject","map","item","fnsUid","network","surname","name","patronymic","contractorType","inn","title","errorMessage","itemStatus","status","createdAt","contractor","natural_entity","additionally","type","Local","Roaming","LoaclRoaming","Connector","Hub1c","processed","created","error","isError","Secondary","Danger"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\n\r\nimport { Button, ButtonKinds } from '@distate/components';\r\n\r\nimport {\r\n  ContractorTypes,\r\n  InvitationDecision,\r\n  DestinationType,\r\n  IncomeContractorStatus\r\n} from '../../helpers/contractors.typings';\r\nimport { invitationDecision } from '../../store/actions';\r\nimport { getInviteYouContractor } from '../../store/actions';\r\nimport { inviteYou } from '../../store/selectors';\r\nimport { Pagination } from '../../../../common/pagination';\r\nimport { InviteYouTools } from './InviteYouTools';\r\nimport { InfoBadge } from '../../../../common/info-badge';\r\nimport { TruncateText } from '../../../../common/truncate-text';\r\nimport { arrToString } from '../../helpers/contractors.helpers';\r\n\r\nexport const InviteYouContractor = () => {\r\n  const dispatch = useDispatch();\r\n  const {\r\n    rows: contractorList = [],\r\n    recordsTotal,\r\n    offset: offsetSelector = 0,\r\n    searchParams = {}\r\n  } = useSelector(inviteYou);\r\n  const [offset, setOffset] = React.useState(offsetSelector);\r\n\r\n  React.useEffect(() => {\r\n    dispatch(getInviteYouContractor({ ...searchParams, offset }));\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [dispatch, offset]);\r\n\r\n  /** Принять приглашение */\r\n  const onAccept = (id: number) => {\r\n    dispatch(invitationDecision({ id, decision: InvitationDecision.accept, offset, searchParams }));\r\n  };\r\n\r\n  /** Отклонить приглашение */\r\n  const onReject = async (id: number) => {\r\n    dispatch(invitationDecision({ id, decision: InvitationDecision.reject, offset, searchParams }));\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <InviteYouTools />\r\n      <table className=\"table\">\r\n        <thead className=\"common-table-head\">\r\n          <tr>\r\n            <td>Контрагент</td>\r\n            <td align=\"center\">Тип</td>\r\n            <td>Статус</td>\r\n            <td>Дополнительно</td>\r\n            <td align=\"right\">Дата создания</td>\r\n            <td></td>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {contractorList.map(item => {\r\n            const {\r\n              id,\r\n              fnsUid,\r\n              network,\r\n              surname,\r\n              name,\r\n              patronymic,\r\n              contractorType,\r\n              inn,\r\n              title,\r\n              errorMessage,\r\n              status: itemStatus,\r\n              createdAt\r\n            } = item;\r\n\r\n            /** для колонки Контрагент */\r\n            let contractor;\r\n            if (contractorType === ContractorTypes.natural_entity) {\r\n              contractor = arrToString([surname, name, patronymic]);\r\n            } else {\r\n              contractor = arrToString([title, inn]);\r\n            }\r\n\r\n            /** для колонки Дополтенельно */\r\n            const additionally = arrToString([fnsUid, network]);\r\n\r\n            let type;\r\n            switch (item.type) {\r\n              case null:\r\n              case DestinationType.Local:\r\n                type = 'Локальный';\r\n                break;\r\n              case DestinationType.Roaming:\r\n                type = 'Роуминг';\r\n                break;\r\n              case DestinationType.LoaclRoaming:\r\n                type = 'Локальный Роуминг';\r\n                break;\r\n              case DestinationType.Connector:\r\n                type = 'Коннектор';\r\n                break;\r\n              case DestinationType.Hub1c:\r\n                type = '1С-ЭДО';\r\n                break;\r\n              default:\r\n                type = '';\r\n            }\r\n\r\n            let status;\r\n            switch (itemStatus) {\r\n              case IncomeContractorStatus.processed:\r\n                status = 'Обработано';\r\n                break;\r\n              case IncomeContractorStatus.created:\r\n                status = 'Ожидание';\r\n                break;\r\n              case IncomeContractorStatus.error:\r\n                status = 'Ошибка';\r\n                break;\r\n              default:\r\n                status = '';\r\n            }\r\n\r\n            const isError = itemStatus === IncomeContractorStatus.error;\r\n\r\n            return (\r\n              <tr key={id}>\r\n                <td>{contractor && <TruncateText text={contractor} />}</td>\r\n                <td align=\"center\">{type}</td>\r\n                <td>\r\n                  {isError ? <InfoBadge str={status} title={errorMessage || status} /> : status}\r\n                </td>\r\n                <td>{(fnsUid || network) && <TruncateText text={additionally!} />}</td>\r\n                <td align=\"right\">{createdAt}</td>\r\n                <td>\r\n                  {itemStatus === IncomeContractorStatus.created && (\r\n                    <>\r\n                      <Button kind={ButtonKinds.Secondary} onClick={() => onAccept(id)}>\r\n                        Принять\r\n                      </Button>{' '}\r\n                      <Button kind={ButtonKinds.Danger} onClick={() => onReject(id)}>\r\n                        Отклонить\r\n                      </Button>\r\n                    </>\r\n                  )}\r\n                </td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n        <tfoot>\r\n          <tr>\r\n            <td colSpan={6}>\r\n              <div className=\"pagination-right\">\r\n                <Pagination listLength={recordsTotal} setOffset={setOffset} />\r\n              </div>\r\n            </td>\r\n          </tr>\r\n        </tfoot>\r\n      </table>\r\n    </>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}