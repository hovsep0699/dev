{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(formSubmitEffect),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(formRemoveEffect),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(sagaForm),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(sagaRemove);import{takeLatest,select,call,put}from'redux-saga/effects';import{Flash}from'../../../../common/flash/Flash';import{selectFormLoading}from'../selects';import{FolderApiServices}from'../../services/folder.api';import{actionRequest,actionFormSubmit,actionFormRequest,actionFormSuccess,actionFormFailure,actionRemove,actionRemoveSuccess,actionRemoveFailure}from'../actions';export function formSubmitEffect(){return _regeneratorRuntime.wrap(function formSubmitEffect$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return takeLatest(actionFormSubmit,sagaForm);case 2:case\"end\":return _context.stop();}}},_marked);}export function formRemoveEffect(){return _regeneratorRuntime.wrap(function formRemoveEffect$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return takeLatest(actionRemove,sagaRemove);case 2:case\"end\":return _context2.stop();}}},_marked2);}function sagaForm(_ref){var payload,loading,id,title;return _regeneratorRuntime.wrap(function sagaForm$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:payload=_ref.payload;_context3.next=3;return select(selectFormLoading);case 3:loading=_context3.sent;id=payload.id,title=payload.title;if(!loading){_context3.next=7;break;}return _context3.abrupt(\"return\");case 7:_context3.prev=7;_context3.next=10;return put(actionFormRequest());case 10:if(!id){_context3.next=15;break;}_context3.next=13;return call(FolderApiServices.update,{id:id,title:title});case 13:_context3.next=17;break;case 15:_context3.next=17;return call(FolderApiServices.create,{title:title});case 17:_context3.next=19;return put(actionFormSuccess());case 19:_context3.next=21;return put(actionRequest());case 21:_context3.next=28;break;case 23:_context3.prev=23;_context3.t0=_context3[\"catch\"](7);_context3.next=27;return put(actionFormFailure(_context3.t0));case 27:Flash.error('Возникла ошибка при добавлении');case 28:case\"end\":return _context3.stop();}}},_marked3,null,[[7,23]]);}function sagaRemove(_ref2){var id;return _regeneratorRuntime.wrap(function sagaRemove$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:id=_ref2.payload.id;_context4.prev=1;_context4.next=4;return call(FolderApiServices.remove,{id:id});case 4:_context4.next=6;return put(actionRequest());case 6:_context4.next=8;return put(actionRemoveSuccess());case 8:_context4.next=14;break;case 10:_context4.prev=10;_context4.t0=_context4[\"catch\"](1);_context4.next=14;return put(actionRemoveFailure());case 14:case\"end\":return _context4.stop();}}},_marked4,null,[[1,10]]);}","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/container/folder/store/sagas/form.effect.ts"],"names":["formSubmitEffect","formRemoveEffect","sagaForm","sagaRemove","takeLatest","select","call","put","Flash","selectFormLoading","FolderApiServices","actionRequest","actionFormSubmit","actionFormRequest","actionFormSuccess","actionFormFailure","actionRemove","actionRemoveSuccess","actionRemoveFailure","payload","loading","id","title","update","create","error","remove"],"mappings":"oNAiBiBA,gB,iDAIAC,gB,iDAIPC,Q,iDAwBAC,U,EAjDV,OAASC,UAAT,CAAqBC,MAArB,CAA6BC,IAA7B,CAAmCC,GAAnC,KAA8C,oBAA9C,CAEA,OAASC,KAAT,KAAsB,gCAAtB,CACA,OAASC,iBAAT,KAAkC,YAAlC,CACA,OAASC,iBAAT,KAAkC,2BAAlC,CAEA,OACEC,aADF,CAEEC,gBAFF,CAGEC,iBAHF,CAIEC,iBAJF,CAKEC,iBALF,CAMEC,YANF,CAOEC,mBAPF,CAQEC,mBARF,KASO,YATP,CAWA,MAAO,SAAUlB,CAAAA,gBAAV,4IACL,MAAMI,CAAAA,UAAU,CAACQ,gBAAD,CAAmBV,QAAnB,CAAhB,CADK,sDAIP,MAAO,SAAUD,CAAAA,gBAAV,gJACL,MAAMG,CAAAA,UAAU,CAACY,YAAD,CAAeb,UAAf,CAAhB,CADK,wDAIP,QAAUD,CAAAA,QAAV,wJAAqBiB,OAArB,MAAqBA,OAArB,kBACkB,MAAMd,CAAAA,MAAM,CAACI,iBAAD,CAAZ,CADlB,OACQW,OADR,gBAEUC,EAFV,CAEwBF,OAFxB,CAEUE,EAFV,CAEcC,KAFd,CAEwBH,OAFxB,CAEcG,KAFd,KAIMF,OAJN,sGAOI,MAAMb,CAAAA,GAAG,CAACM,iBAAiB,EAAlB,CAAT,CAPJ,YASQQ,EATR,6CAUM,MAAMf,CAAAA,IAAI,CAACI,iBAAiB,CAACa,MAAnB,CAA2B,CAAEF,EAAE,CAAFA,EAAF,CAAMC,KAAK,CAALA,KAAN,CAA3B,CAAV,CAVN,0DAYM,MAAMhB,CAAAA,IAAI,CAACI,iBAAiB,CAACc,MAAnB,CAA2B,CAAEF,KAAK,CAALA,KAAF,CAA3B,CAAV,CAZN,0BAeI,MAAMf,CAAAA,GAAG,CAACO,iBAAiB,EAAlB,CAAT,CAfJ,0BAgBI,MAAMP,CAAAA,GAAG,CAACI,aAAa,EAAd,CAAT,CAhBJ,+GAkBI,MAAMJ,CAAAA,GAAG,CAACQ,iBAAiB,cAAlB,CAAT,CAlBJ,QAoBIP,KAAK,CAACiB,KAAN,CAAY,gCAAZ,EApBJ,uEAwBA,QAAUtB,CAAAA,UAAV,qIAAkCkB,EAAlC,OAAuBF,OAAvB,CAAkCE,EAAlC,mCAEI,MAAMf,CAAAA,IAAI,CAACI,iBAAiB,CAACgB,MAAnB,CAA2B,CAAEL,EAAE,CAAFA,EAAF,CAA3B,CAAV,CAFJ,wBAGI,MAAMd,CAAAA,GAAG,CAACI,aAAa,EAAd,CAAT,CAHJ,wBAII,MAAMJ,CAAAA,GAAG,CAACU,mBAAmB,EAApB,CAAT,CAJJ,8GAMI,MAAMV,CAAAA,GAAG,CAACW,mBAAmB,EAApB,CAAT,CANJ","sourcesContent":["import { takeLatest, select, call, put } from 'redux-saga/effects';\r\n\r\nimport { Flash } from '../../../../common/flash/Flash';\r\nimport { selectFormLoading } from '../selects';\r\nimport { FolderApiServices } from '../../services/folder.api';\r\nimport { FormSubmitPayload, RemovePayload } from '../../helpers/folder.typings';\r\nimport {\r\n  actionRequest,\r\n  actionFormSubmit,\r\n  actionFormRequest,\r\n  actionFormSuccess,\r\n  actionFormFailure,\r\n  actionRemove,\r\n  actionRemoveSuccess,\r\n  actionRemoveFailure\r\n} from '../actions';\r\n\r\nexport function* formSubmitEffect() {\r\n  yield takeLatest(actionFormSubmit, sagaForm);\r\n}\r\n\r\nexport function* formRemoveEffect() {\r\n  yield takeLatest(actionRemove, sagaRemove);\r\n}\r\n\r\nfunction* sagaForm({ payload }: FormSubmitPayload) {\r\n  const loading = yield select(selectFormLoading);\r\n  const { id, title } = payload;\r\n\r\n  if (loading) return;\r\n\r\n  try {\r\n    yield put(actionFormRequest());\r\n\r\n    if (id) {\r\n      yield call(FolderApiServices.update, { id, title });\r\n    } else {\r\n      yield call(FolderApiServices.create, { title });\r\n    }\r\n\r\n    yield put(actionFormSuccess());\r\n    yield put(actionRequest());\r\n  } catch (err) {\r\n    yield put(actionFormFailure(err));\r\n\r\n    Flash.error('Возникла ошибка при добавлении');\r\n  }\r\n}\r\n\r\nfunction* sagaRemove({ payload: { id } }: RemovePayload) {\r\n  try {\r\n    yield call(FolderApiServices.remove, { id });\r\n    yield put(actionRequest());\r\n    yield put(actionRemoveSuccess());\r\n  } catch (err) {\r\n    yield put(actionRemoveFailure());\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}