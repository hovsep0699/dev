{"ast":null,"code":"import _defineProperty from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import _applyDecoratedDescriptor from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/applyDecoratedDescriptor\";var _class;import React,{Component}from'react';import autobind from'autobind-decorator';import Downshift from'downshift';import classNames from'classnames';import styles from'./Autocomplete.module.css';import ReactHtmlParser from'react-html-parser';import{Loading}from'@distate/components';var Autocomplete=(_class=/*#__PURE__*/function(_Component){_inherits(Autocomplete,_Component);var _super=_createSuper(Autocomplete);function Autocomplete(props){var _this;_classCallCheck(this,Autocomplete);_this=_super.call(this,props);_this.state={values:[],formattedValues:[],touched:false};return _this;}_createClass(Autocomplete,[{key:\"successAjaxHandler\",value:function successAjaxHandler(res,newInputValue){var _this2=this;var formattedValues=this.props.formatAjaxRes?this.props.formatAjaxRes(res):res;this.setState(function(){if(newInputValue===undefined){_this2.props.handleItemSelect()(newInputValue);}return{values:res,formattedValues:formattedValues,touched:true};});}},{key:\"failAjaxHandler\",value:function failAjaxHandler(err){this.setState({values:[],touched:true});}},{key:\"updateValues\",value:function updateValues(newInputValue){var _this3=this;this.props.doAjax(newInputValue?newInputValue.toLowerCase():newInputValue).then(function(res){return _this3.successAjaxHandler(res,newInputValue);}).catch(this.failAjaxHandler);}},{key:\"withProps\",value:function withProps(element,additionalProps){return React.cloneElement(element,additionalProps);}},{key:\"highlight\",value:function highlight(value,trim){return value.replace(// eslint-disable-next-line no-useless-escape\nnew RegExp(\"(?![^&;]+;)(?!<[^<>]*)(\".concat(trim.replace(/([\\^\\$\\(\\)\\[\\]\\{\\}\\*\\.\\+\\?\\|\\\\])/gi,'\\\\$1'),\")(?![^<>]*>)(?![^&;]+;)\"),'gi'),'<strong>$1</strong>');}},{key:\"renderListItems\",value:function renderListItems(acValues,inputValue,getItemProps,highlightedIndex){var _this4=this;return acValues.filter(function(item){return item!=='';}).map(function(acValue,acValueIndex){var acValueFormatted=_this4.highlight(acValue,inputValue);var acItemClasses=classNames({ac_over:highlightedIndex===acValueIndex});return/*#__PURE__*/React.createElement(\"li\",Object.assign({},getItemProps({key:acValue,index:acValueIndex,item:acValue}),{className:acItemClasses}),ReactHtmlParser(acValueFormatted));});}},{key:\"render\",value:function render(){var _this5=this;var _this$props=this.props,width=_this$props.width,handleAutocompleteValidate=_this$props.handleAutocompleteValidate,handleItemSelect=_this$props.handleItemSelect,children=_this$props.children,hasLoader=_this$props.hasLoader;var _this$state=this.state,touched=_this$state.touched,formattedValues=_this$state.formattedValues,values=_this$state.values;var acDropdownStyles={width:\"\".concat(width,\"px\")};var customInputProps={};var noFormattedValues=formattedValues.length===0;if(handleAutocompleteValidate){customInputProps.validate=handleAutocompleteValidate(touched?formattedValues:null);}return/*#__PURE__*/React.createElement(Downshift,{onSelect:handleItemSelect(values)},function(_ref){var getInputProps=_ref.getInputProps,getItemProps=_ref.getItemProps,getMenuProps=_ref.getMenuProps,isOpen=_ref.isOpen,inputValue=_ref.inputValue,highlightedIndex=_ref.highlightedIndex;return/*#__PURE__*/React.createElement(\"div\",{className:styles.acWrapper},_this5.withProps(children,_objectSpread({onValueChange:_this5.updateValues},getInputProps(customInputProps))),/*#__PURE__*/React.createElement(\"ul\",Object.assign({},getMenuProps(),{className:classNames('ac_results',styles.acDropdown,_defineProperty({},styles.hide,!hasLoader&&(!isOpen||noFormattedValues))),style:acDropdownStyles}),hasLoader&&isOpen&&noFormattedValues&&/*#__PURE__*/React.createElement(Loading,null),isOpen&&formattedValues.length>0&&_this5.renderListItems(formattedValues,inputValue,getItemProps,highlightedIndex)));});}}]);return Autocomplete;}(Component),(_applyDecoratedDescriptor(_class.prototype,\"successAjaxHandler\",[autobind],Object.getOwnPropertyDescriptor(_class.prototype,\"successAjaxHandler\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"failAjaxHandler\",[autobind],Object.getOwnPropertyDescriptor(_class.prototype,\"failAjaxHandler\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"updateValues\",[autobind],Object.getOwnPropertyDescriptor(_class.prototype,\"updateValues\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"withProps\",[autobind],Object.getOwnPropertyDescriptor(_class.prototype,\"withProps\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"highlight\",[autobind],Object.getOwnPropertyDescriptor(_class.prototype,\"highlight\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"renderListItems\",[autobind],Object.getOwnPropertyDescriptor(_class.prototype,\"renderListItems\"),_class.prototype)),_class);Autocomplete.defaultProps={hasLoader:false};export default Autocomplete;","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/common/autocomplete/Autocomplete.js"],"names":["React","Component","autobind","Downshift","classNames","styles","ReactHtmlParser","Loading","Autocomplete","props","state","values","formattedValues","touched","res","newInputValue","formatAjaxRes","setState","undefined","handleItemSelect","err","doAjax","toLowerCase","then","successAjaxHandler","catch","failAjaxHandler","element","additionalProps","cloneElement","value","trim","replace","RegExp","acValues","inputValue","getItemProps","highlightedIndex","filter","item","map","acValue","acValueIndex","acValueFormatted","highlight","acItemClasses","ac_over","key","index","width","handleAutocompleteValidate","children","hasLoader","acDropdownStyles","customInputProps","noFormattedValues","length","validate","getInputProps","getMenuProps","isOpen","acWrapper","withProps","onValueChange","updateValues","acDropdown","hide","renderListItems","defaultProps"],"mappings":"+rCAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CAEA,MAAOC,CAAAA,QAAP,KAAqB,oBAArB,CACA,MAAOC,CAAAA,SAAP,KAAsB,WAAtB,CACA,MAAOC,CAAAA,UAAP,KAAuB,YAAvB,CACA,MAAOC,CAAAA,MAAP,KAAmB,2BAAnB,CACA,MAAOC,CAAAA,eAAP,KAA4B,mBAA5B,CACA,OAASC,OAAT,KAAwB,qBAAxB,C,GAEMC,CAAAA,Y,oHACJ,sBAAYC,KAAZ,CAAmB,8CACjB,uBAAMA,KAAN,EACA,MAAKC,KAAL,CAAa,CACXC,MAAM,CAAE,EADG,CAEXC,eAAe,CAAE,EAFN,CAGXC,OAAO,CAAE,KAHE,CAAb,CAFiB,aAOlB,C,uFAEkBC,G,CAAKC,a,CAAe,iBACrC,GAAMH,CAAAA,eAAe,CAAG,KAAKH,KAAL,CAAWO,aAAX,CAA2B,KAAKP,KAAL,CAAWO,aAAX,CAAyBF,GAAzB,CAA3B,CAA2DA,GAAnF,CACA,KAAKG,QAAL,CAAc,UAAM,CAClB,GAAIF,aAAa,GAAKG,SAAtB,CAAiC,CAC/B,MAAI,CAACT,KAAL,CAAWU,gBAAX,GAA8BJ,aAA9B,EACD,CAED,MAAO,CAAEJ,MAAM,CAAEG,GAAV,CAAeF,eAAe,CAAfA,eAAf,CAAgCC,OAAO,CAAE,IAAzC,CAAP,CACD,CAND,EAOD,C,wDAEeO,G,CAAK,CACnB,KAAKH,QAAL,CAAc,CAAEN,MAAM,CAAE,EAAV,CAAcE,OAAO,CAAE,IAAvB,CAAd,EACD,C,kDAEYE,a,CAAe,iBAC1B,KAAKN,KAAL,CACGY,MADH,CACUN,aAAa,CAAGA,aAAa,CAACO,WAAd,EAAH,CAAiCP,aADxD,EAEGQ,IAFH,CAEQ,SAAAT,GAAG,QAAI,CAAA,MAAI,CAACU,kBAAL,CAAwBV,GAAxB,CAA6BC,aAA7B,CAAJ,EAFX,EAGGU,KAHH,CAGS,KAAKC,eAHd,EAID,C,4CAESC,O,CAASC,e,CAAiB,CAClC,MAAO5B,CAAAA,KAAK,CAAC6B,YAAN,CAAmBF,OAAnB,CAA4BC,eAA5B,CAAP,CACD,C,4CAESE,K,CAAOC,I,CAAM,CACrB,MAAOD,CAAAA,KAAK,CAACE,OAAN,CACL;AACA,GAAIC,CAAAA,MAAJ,kCAAqCF,IAAI,CAACC,OAAL,CAAa,oCAAb,CAAmD,MAAnD,CAArC,4BAAyH,IAAzH,CAFK,CAGL,qBAHK,CAAP,CAKD,C,wDAEeE,Q,CAAUC,U,CAAYC,Y,CAAcC,gB,CAAkB,iBACpE,MAAOH,CAAAA,QAAQ,CAACI,MAAT,CAAgB,SAAAC,IAAI,QAAIA,CAAAA,IAAI,GAAK,EAAb,EAApB,EAAqCC,GAArC,CAAyC,SAACC,OAAD,CAAUC,YAAV,CAA2B,CACzE,GAAMC,CAAAA,gBAAgB,CAAG,MAAI,CAACC,SAAL,CAAeH,OAAf,CAAwBN,UAAxB,CAAzB,CACA,GAAMU,CAAAA,aAAa,CAAGzC,UAAU,CAAC,CAC/B0C,OAAO,CAAET,gBAAgB,GAAKK,YADC,CAAD,CAAhC,CAGA,mBACE,0CACMN,YAAY,CAAC,CACfW,GAAG,CAAEN,OADU,CAEfO,KAAK,CAAEN,YAFQ,CAGfH,IAAI,CAAEE,OAHS,CAAD,CADlB,EAME,SAAS,CAAEI,aANb,GAQGvC,eAAe,CAACqC,gBAAD,CARlB,CADF,CAYD,CAjBM,CAAP,CAkBD,C,uCACQ,iCAC8E,KAAKlC,KADnF,CACCwC,KADD,aACCA,KADD,CACQC,0BADR,aACQA,0BADR,CACoC/B,gBADpC,aACoCA,gBADpC,CACsDgC,QADtD,aACsDA,QADtD,CACgEC,SADhE,aACgEA,SADhE,iBAEsC,KAAK1C,KAF3C,CAECG,OAFD,aAECA,OAFD,CAEUD,eAFV,aAEUA,eAFV,CAE2BD,MAF3B,aAE2BA,MAF3B,CAGP,GAAM0C,CAAAA,gBAAgB,CAAG,CACvBJ,KAAK,WAAKA,KAAL,MADkB,CAAzB,CAGA,GAAMK,CAAAA,gBAAgB,CAAG,EAAzB,CACA,GAAMC,CAAAA,iBAAiB,CAAG3C,eAAe,CAAC4C,MAAhB,GAA2B,CAArD,CAEA,GAAIN,0BAAJ,CAAgC,CAC9BI,gBAAgB,CAACG,QAAjB,CAA4BP,0BAA0B,CAACrC,OAAO,CAAGD,eAAH,CAAqB,IAA7B,CAAtD,CACD,CAED,mBACE,oBAAC,SAAD,EAAW,QAAQ,CAAEO,gBAAgB,CAACR,MAAD,CAArC,EACG,kBAAG+C,CAAAA,aAAH,MAAGA,aAAH,CAAkBtB,YAAlB,MAAkBA,YAAlB,CAAgCuB,YAAhC,MAAgCA,YAAhC,CAA8CC,MAA9C,MAA8CA,MAA9C,CAAsDzB,UAAtD,MAAsDA,UAAtD,CAAkEE,gBAAlE,MAAkEA,gBAAlE,oBACC,2BAAK,SAAS,CAAEhC,MAAM,CAACwD,SAAvB,EACG,MAAI,CAACC,SAAL,CAAeX,QAAf,gBACCY,aAAa,CAAE,MAAI,CAACC,YADrB,EAEIN,aAAa,CAACJ,gBAAD,CAFjB,EADH,cAME,0CACMK,YAAY,EADlB,EAEE,SAAS,CAAEvD,UAAU,CAAC,YAAD,CAAeC,MAAM,CAAC4D,UAAtB,oBAClB5D,MAAM,CAAC6D,IADW,CACJ,CAACd,SAAD,GAAe,CAACQ,MAAD,EAAWL,iBAA1B,CADI,EAFvB,CAKE,KAAK,CAAEF,gBALT,GAOGD,SAAS,EAAIQ,MAAb,EAAuBL,iBAAvB,eAA4C,oBAAC,OAAD,MAP/C,CAQGK,MAAM,EACLhD,eAAe,CAAC4C,MAAhB,CAAyB,CAD1B,EAEC,MAAI,CAACW,eAAL,CAAqBvD,eAArB,CAAsCuB,UAAtC,CAAkDC,YAAlD,CAAgEC,gBAAhE,CAVJ,CANF,CADD,EADH,CADF,CAyBD,C,0BAtGwBpC,S,oEASxBC,Q,yJAWAA,Q,mJAIAA,Q,6IAOAA,Q,0IAIAA,Q,gJAQAA,Q,iGAqEHM,YAAY,CAAC4D,YAAb,CAA4B,CAC1BhB,SAAS,CAAE,KADe,CAA5B,CAIA,cAAe5C,CAAAA,YAAf","sourcesContent":["import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport autobind from 'autobind-decorator';\r\nimport Downshift from 'downshift';\r\nimport classNames from 'classnames';\r\nimport styles from './Autocomplete.module.css';\r\nimport ReactHtmlParser from 'react-html-parser';\r\nimport { Loading } from '@distate/components';\r\n\r\nclass Autocomplete extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      values: [],\r\n      formattedValues: [],\r\n      touched: false\r\n    };\r\n  }\r\n  @autobind\r\n  successAjaxHandler(res, newInputValue) {\r\n    const formattedValues = this.props.formatAjaxRes ? this.props.formatAjaxRes(res) : res;\r\n    this.setState(() => {\r\n      if (newInputValue === undefined) {\r\n        this.props.handleItemSelect()(newInputValue);\r\n      }\r\n\r\n      return { values: res, formattedValues, touched: true };\r\n    });\r\n  }\r\n  @autobind\r\n  failAjaxHandler(err) {\r\n    this.setState({ values: [], touched: true });\r\n  }\r\n  @autobind\r\n  updateValues(newInputValue) {\r\n    this.props\r\n      .doAjax(newInputValue ? newInputValue.toLowerCase() : newInputValue)\r\n      .then(res => this.successAjaxHandler(res, newInputValue))\r\n      .catch(this.failAjaxHandler);\r\n  }\r\n  @autobind\r\n  withProps(element, additionalProps) {\r\n    return React.cloneElement(element, additionalProps);\r\n  }\r\n  @autobind\r\n  highlight(value, trim) {\r\n    return value.replace(\r\n      // eslint-disable-next-line no-useless-escape\r\n      new RegExp(`(?![^&;]+;)(?!<[^<>]*)(${trim.replace(/([\\^\\$\\(\\)\\[\\]\\{\\}\\*\\.\\+\\?\\|\\\\])/gi, '\\\\$1')})(?![^<>]*>)(?![^&;]+;)`,'gi'),\r\n      '<strong>$1</strong>'\r\n    );\r\n  }\r\n  @autobind\r\n  renderListItems(acValues, inputValue, getItemProps, highlightedIndex) {\r\n    return acValues.filter(item => item !== '').map((acValue, acValueIndex) => {\r\n      const acValueFormatted = this.highlight(acValue, inputValue);\r\n      const acItemClasses = classNames({\r\n        ac_over: highlightedIndex === acValueIndex\r\n      });\r\n      return (\r\n        <li\r\n          {...getItemProps({\r\n            key: acValue,\r\n            index: acValueIndex,\r\n            item: acValue\r\n          })}\r\n          className={acItemClasses}\r\n        >\r\n          {ReactHtmlParser(acValueFormatted)}\r\n        </li>\r\n      );\r\n    });\r\n  }\r\n  render() {\r\n    const { width, handleAutocompleteValidate, handleItemSelect, children, hasLoader } = this.props;\r\n    const { touched, formattedValues, values } = this.state;\r\n    const acDropdownStyles = {\r\n      width: `${width}px`\r\n    };\r\n    const customInputProps = {};\r\n    const noFormattedValues = formattedValues.length === 0;\r\n\r\n    if (handleAutocompleteValidate) {\r\n      customInputProps.validate = handleAutocompleteValidate(touched ? formattedValues : null);\r\n    }\r\n\r\n    return (\r\n      <Downshift onSelect={handleItemSelect(values)}>\r\n        {({ getInputProps, getItemProps, getMenuProps, isOpen, inputValue, highlightedIndex }) => (\r\n          <div className={styles.acWrapper}>\r\n            {this.withProps(children, {\r\n              onValueChange: this.updateValues,\r\n              ...getInputProps(customInputProps)\r\n            })}\r\n\r\n            <ul\r\n              {...getMenuProps()}\r\n              className={classNames('ac_results', styles.acDropdown, {\r\n                [styles.hide]: !hasLoader && (!isOpen || noFormattedValues)\r\n              })}\r\n              style={acDropdownStyles}\r\n            >\r\n              {hasLoader && isOpen && noFormattedValues && <Loading />}\r\n              {isOpen &&\r\n                formattedValues.length > 0 &&\r\n                this.renderListItems(formattedValues, inputValue, getItemProps, highlightedIndex)}\r\n            </ul>\r\n          </div>\r\n        )}\r\n      </Downshift>\r\n    );\r\n  }\r\n}\r\n\r\nAutocomplete.propTypes = {\r\n  handleItemSelect: PropTypes.func.isRequired,\r\n  doAjax: PropTypes.func.isRequired,\r\n  formatAjaxRes: PropTypes.func,\r\n  hasLoader: PropTypes.bool\r\n};\r\n\r\nAutocomplete.defaultProps = {\r\n  hasLoader: false\r\n};\r\n\r\nexport default Autocomplete;\r\n"]},"metadata":{},"sourceType":"module"}