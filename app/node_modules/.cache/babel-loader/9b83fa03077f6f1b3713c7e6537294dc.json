{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{transactionsRecordsTotalSelector,transactionRowsSelector}from'../../store/selectors';import{Pagination,PaginationLimit}from'../../../../common/pagination';import Core from'@distate/core/dist/application/Core';import{getTransactionsHistory}from'../../store/actions';import{TransactionsFilter}from'./tools/TransactionsFilter';export var TransactionsHistory=function TransactionsHistory(_ref){var match=_ref.match;var _useState=useState(10),_useState2=_slicedToArray(_useState,2),limit=_useState2[0],setLimit=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),offset=_useState4[0],setOffset=_useState4[1];var recordsTotal=useSelector(transactionsRecordsTotalSelector);var rows=useSelector(transactionRowsSelector);var dispatch=useDispatch();useEffect(function(){var _match$params;var companyId=match===null||match===void 0?void 0:(_match$params=match.params)===null||_match$params===void 0?void 0:_match$params.id;companyId&&dispatch(getTransactionsHistory({id:companyId,offset:offset,limit:limit}));},[dispatch,offset,limit,match]);/** ячейка колонки Сумма */var Amount=function Amount(amoutProps){var type_system_name=amoutProps.type_system_name,amount=amoutProps.amount;var isDeposit=type_system_name==='deposit';var summColor=isDeposit?'#44c533':'#c8221b';var fixedAmount=(amount/100).toFixed(2);var preparedAmount=isDeposit?\"+ \".concat(fixedAmount):\"- \".concat(fixedAmount);return/*#__PURE__*/React.createElement(\"span\",{style:{color:summColor}},preparedAmount);};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(TransactionsFilter,{id:Core.company.localId}),/*#__PURE__*/React.createElement(\"table\",{className:\"table\"},/*#__PURE__*/React.createElement(\"thead\",{className:\"common-table-head\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{width:80},\"\\u2116\"),/*#__PURE__*/React.createElement(\"td\",{width:150},\"\\u0421\\u0443\\u043C\\u043C\\u0430\"),/*#__PURE__*/React.createElement(\"td\",null,\"\\u041A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\"),/*#__PURE__*/React.createElement(\"td\",{width:150},\"\\u0414\\u0430\\u0442\\u0430\"))),/*#__PURE__*/React.createElement(\"tbody\",null,rows===null||rows===void 0?void 0:rows.map(function(item,index){var id=item.id,amount=item.amount,comment=item.comment,created_at=item.created_at,type_system_name=item.type_system_name;return/*#__PURE__*/React.createElement(\"tr\",{key:id,title:comment},/*#__PURE__*/React.createElement(\"td\",{width:80},index+1),/*#__PURE__*/React.createElement(\"td\",{width:150},/*#__PURE__*/React.createElement(Amount,{type_system_name:type_system_name,amount:amount})),/*#__PURE__*/React.createElement(\"td\",null,comment),/*#__PURE__*/React.createElement(\"td\",{width:150},created_at,\" \"));})),/*#__PURE__*/React.createElement(\"tfoot\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:2},/*#__PURE__*/React.createElement(PaginationLimit,{setLimit:setLimit,limit:limit})),/*#__PURE__*/React.createElement(\"td\",{colSpan:2,align:\"right\"},/*#__PURE__*/React.createElement(\"div\",{className:\"pagination-right\"},/*#__PURE__*/React.createElement(Pagination,{listLength:recordsTotal,setOffset:setOffset,limit:limit})))))));};","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/finance/components/transactions-history/TransactionsHistory.tsx"],"names":["React","useEffect","useState","useDispatch","useSelector","transactionsRecordsTotalSelector","transactionRowsSelector","Pagination","PaginationLimit","Core","getTransactionsHistory","TransactionsFilter","TransactionsHistory","match","limit","setLimit","offset","setOffset","recordsTotal","rows","dispatch","companyId","params","id","Amount","amoutProps","type_system_name","amount","isDeposit","summColor","fixedAmount","toFixed","preparedAmount","color","company","localId","map","item","index","comment","created_at"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { transactionsRecordsTotalSelector, transactionRowsSelector } from '../../store/selectors';\r\nimport { Pagination, PaginationLimit } from '../../../../common/pagination';\r\nimport Core from '@distate/core/dist/application/Core';\r\nimport { getTransactionsHistory } from '../../store/actions';\r\nimport { TransactionsFilter } from './tools/TransactionsFilter';\r\n\r\nexport const TransactionsHistory = ({ match }: any) => {\r\n  const [limit, setLimit] = useState(10);\r\n  const [offset, setOffset] = useState(0);\r\n\r\n  const recordsTotal = useSelector(transactionsRecordsTotalSelector);\r\n  const rows = useSelector(transactionRowsSelector);\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    const companyId = match?.params?.id;\r\n    companyId && dispatch(getTransactionsHistory({ id: companyId, offset, limit }));\r\n  }, [dispatch, offset, limit, match]);\r\n\r\n  type AmoutProps = {\r\n    type_system_name: string;\r\n    amount: number;\r\n  };\r\n  /** ячейка колонки Сумма */\r\n  const Amount = (amoutProps: AmoutProps) => {\r\n    const { type_system_name, amount } = amoutProps;\r\n    const isDeposit = type_system_name === 'deposit';\r\n    const summColor = isDeposit ? '#44c533' : '#c8221b';\r\n    const fixedAmount = (amount / 100).toFixed(2);\r\n    const preparedAmount = isDeposit ? `+ ${fixedAmount}` : `- ${fixedAmount}`;\r\n\r\n    return <span style={{ color: summColor }}>{preparedAmount}</span>;\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <TransactionsFilter id={Core.company.localId} />\r\n      <table className=\"table\">\r\n        <thead className=\"common-table-head\">\r\n          <tr>\r\n            <td width={80}>№</td>\r\n            <td width={150}>Сумма</td>\r\n            <td>Комментарий</td>\r\n            <td width={150}>Дата</td>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {rows?.map((item, index) => {\r\n            const { id, amount, comment, created_at, type_system_name } = item;\r\n            return (\r\n              <tr key={id} title={comment}>\r\n                <td width={80}>{index + 1}</td>\r\n                <td width={150}>\r\n                  <Amount type_system_name={type_system_name} amount={amount} />\r\n                </td>\r\n                <td>{comment}</td>\r\n                <td width={150}>{created_at} </td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n        <tfoot>\r\n          <tr>\r\n            <td colSpan={2}>\r\n              <PaginationLimit setLimit={setLimit} limit={limit} />\r\n            </td>\r\n            <td colSpan={2} align=\"right\">\r\n              <div className=\"pagination-right\">\r\n                <Pagination listLength={recordsTotal} setOffset={setOffset} limit={limit} />\r\n              </div>\r\n            </td>\r\n          </tr>\r\n        </tfoot>\r\n      </table>\r\n    </div>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}