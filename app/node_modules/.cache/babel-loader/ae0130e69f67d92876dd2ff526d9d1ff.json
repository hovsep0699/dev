{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport SignRequest from '../SignRequest';\nimport SignService from '../SignService';\nimport errorFactory from '../../error/ErrorFactory';\nimport DiError, { SIGN } from '../../error/Error';\n\nvar SignHandlerBase = /*#__PURE__*/function () {\n  function SignHandlerBase() {\n    _classCallCheck(this, SignHandlerBase);\n  }\n\n  _createClass(SignHandlerBase, [{\n    key: \"sign\",\n    value: function sign(request) {\n      SignHandlerBase.checkRequest(request);\n      Object.freeze(request);\n    }\n  }, {\n    key: \"canHandle\",\n    value: function canHandle(request) {\n      SignHandlerBase.checkRequest(request);\n    }\n  }, {\n    key: \"setNext\",\n    value: function setNext(handler) {\n      if (!(handler instanceof SignHandlerBase)) {\n        throw new Error('Параметр должен быть подклассом SignHandlerBase');\n      }\n\n      this.next = handler;\n      return this.next;\n    }\n  }, {\n    key: \"doNextHandler\",\n    value: function doNextHandler(request) {\n      if (request.error) {\n        if (!(request.error instanceof DiError)) {\n          throw new Error('Неверный тип ошибки. Создавайте ошибки через createSignError');\n        }\n\n        return Promise.reject(request.error);\n      }\n\n      if (SignService.isAborted) {\n        SignService.resetIsAbortedFlag();\n        return Promise.resolve({\n          success: true,\n          data: request,\n          isAborted: true\n        });\n      }\n\n      if (this.next) {\n        return this.next.sign(request);\n      }\n\n      return Promise.resolve({\n        success: true,\n        data: request\n      });\n    }\n  }, {\n    key: \"createSignError\",\n    value: function createSignError(msgForDeveloper, jsError, serverErrorResponse) {\n      return errorFactory(SIGN, msgForDeveloper, jsError, serverErrorResponse);\n    }\n  }], [{\n    key: \"checkRequest\",\n    value: function checkRequest(request) {\n      if (request === null || request === undefined) throw new Error('Следует передать запрос для подписи(SignRequest)');\n      if (!(request instanceof SignRequest)) throw new Error('Параметр должен быть подклассом SignRequest');\n    }\n  }]);\n\n  return SignHandlerBase;\n}();\n\nexport default SignHandlerBase;","map":{"version":3,"sources":["../../../../src/application/sign/handlers/SignHandlerBase.js"],"names":[],"mappings":";;AAAA,OAAO,WAAP,MAAwB,gBAAxB;AACA,OAAO,WAAP,MAAwB,gBAAxB;AACA,OAAO,YAAP,MAAyB,0BAAzB;AACA,OAAO,OAAP,IAAkB,IAAlB,QAA8B,mBAA9B;;IAEM,e;;;;;;;yBAQC,O,EAAO;AACV,MAAA,eAAe,CAAC,YAAhB,CAA6B,OAA7B;AACA,MAAA,MAAM,CAAC,MAAP,CAAc,OAAd;AACD;;;8BAES,O,EAAO;AACf,MAAA,eAAe,CAAC,YAAhB,CAA6B,OAA7B;AACD;;;4BAEO,O,EAAO;AACb,UAAI,EAAE,OAAO,YAAY,eAArB,CAAJ,EAA2C;AACzC,cAAM,IAAI,KAAJ,CAAU,iDAAV,CAAN;AACD;;AACD,WAAK,IAAL,GAAY,OAAZ;AACA,aAAO,KAAK,IAAZ;AACD;;;kCAEa,O,EAAO;AACnB,UAAI,OAAO,CAAC,KAAZ,EAAmB;AACjB,YAAI,EAAE,OAAO,CAAC,KAAR,YAAyB,OAA3B,CAAJ,EAAyC;AACvC,gBAAM,IAAI,KAAJ,CAAU,8DAAV,CAAN;AACD;;AACD,eAAO,OAAO,CAAC,MAAR,CAAe,OAAO,CAAC,KAAvB,CAAP;AACD;;AACD,UAAI,WAAW,CAAC,SAAhB,EAA2B;AACzB,QAAA,WAAW,CAAC,kBAAZ;AACA,eAAO,OAAO,CAAC,OAAR,CAAgB;AAAE,UAAA,OAAO,EAAE,IAAX;AAAiB,UAAA,IAAI,EAAE,OAAvB;AAAgC,UAAA,SAAS,EAAE;AAA3C,SAAhB,CAAP;AACD;;AACD,UAAI,KAAK,IAAT,EAAe;AACb,eAAO,KAAK,IAAL,CAAU,IAAV,CAAe,OAAf,CAAP;AACD;;AACD,aAAO,OAAO,CAAC,OAAR,CAAgB;AAAE,QAAA,OAAO,EAAE,IAAX;AAAiB,QAAA,IAAI,EAAE;AAAvB,OAAhB,CAAP;AACD;;;oCAEe,e,EAAiB,O,EAAS,mB,EAAmB;AAC3D,aAAO,YAAY,CAAC,IAAD,EAAO,eAAP,EAAwB,OAAxB,EAAiC,mBAAjC,CAAnB;AACD;;;iCA3CmB,O,EAAO;AACzB,UAAI,OAAO,KAAK,IAAZ,IAAoB,OAAO,KAAK,SAApC,EACE,MAAM,IAAI,KAAJ,CAAU,kDAAV,CAAN;AACF,UAAI,EAAE,OAAO,YAAY,WAArB,CAAJ,EACE,MAAM,IAAI,KAAJ,CAAU,6CAAV,CAAN;AACH;;;;;;AAyCH,eAAe,eAAf","sourceRoot":"","sourcesContent":["import SignRequest from '../SignRequest';\r\nimport SignService from '../SignService';\r\nimport errorFactory from '../../error/ErrorFactory';\r\nimport DiError, { SIGN } from '../../error/Error';\r\nclass SignHandlerBase {\r\n    static checkRequest(request) {\r\n        if (request === null || request === undefined)\r\n            throw new Error('Следует передать запрос для подписи(SignRequest)');\r\n        if (!(request instanceof SignRequest))\r\n            throw new Error('Параметр должен быть подклассом SignRequest');\r\n    }\r\n    sign(request) {\r\n        SignHandlerBase.checkRequest(request);\r\n        Object.freeze(request);\r\n    }\r\n    canHandle(request) {\r\n        SignHandlerBase.checkRequest(request);\r\n    }\r\n    setNext(handler) {\r\n        if (!(handler instanceof SignHandlerBase)) {\r\n            throw new Error('Параметр должен быть подклассом SignHandlerBase');\r\n        }\r\n        this.next = handler;\r\n        return this.next;\r\n    }\r\n    doNextHandler(request) {\r\n        if (request.error) {\r\n            if (!(request.error instanceof DiError)) {\r\n                throw new Error('Неверный тип ошибки. Создавайте ошибки через createSignError');\r\n            }\r\n            return Promise.reject(request.error);\r\n        }\r\n        if (SignService.isAborted) {\r\n            SignService.resetIsAbortedFlag();\r\n            return Promise.resolve({ success: true, data: request, isAborted: true });\r\n        }\r\n        if (this.next) {\r\n            return this.next.sign(request);\r\n        }\r\n        return Promise.resolve({ success: true, data: request });\r\n    }\r\n    createSignError(msgForDeveloper, jsError, serverErrorResponse) {\r\n        return errorFactory(SIGN, msgForDeveloper, jsError, serverErrorResponse);\r\n    }\r\n}\r\nexport default SignHandlerBase;\r\n//# sourceMappingURL=SignHandlerBase.js.map"]},"metadata":{},"sourceType":"module"}