{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React from'react';import{useDispatch,useSelector}from'react-redux';import{Modal,Button,Icons}from'@distate/components';import'./style.css';import{Pagination}from'../../../../common/pagination';import{getContractorGroups,deleteContractorGroup,getPersonInfo}from'../../store/actions';import{currentContractor as currentContractorSelector}from'../../store/selectors';import{SubModalGroups}from'./SubModalGroups';/** Карточка контрагента ФЛ */export var NaturalEntityCard=function NaturalEntityCard(props){var _currentContractor$gr,_currentContractor$gr2;var isVisible=props.isVisible,_hide=props.hide,userId=props.userId,contractorId=props.contractorId;var dispatch=useDispatch();var currentContractor=useSelector(currentContractorSelector);var rows=(currentContractor===null||currentContractor===void 0?void 0:(_currentContractor$gr=currentContractor.groups)===null||_currentContractor$gr===void 0?void 0:_currentContractor$gr.rows)||[];var _ref=currentContractor.person||{},_ref$name=_ref.name,name=_ref$name===void 0?'':_ref$name,_ref$surname=_ref.surname,surname=_ref$surname===void 0?'':_ref$surname,_ref$patronymic=_ref.patronymic,patronymic=_ref$patronymic===void 0?'':_ref$patronymic,_ref$socialNumber=_ref.socialNumber,socialNumber=_ref$socialNumber===void 0?'':_ref$socialNumber,_ref$email=_ref.email,email=_ref$email===void 0?'':_ref$email;var _React$useState=React.useState(),_React$useState2=_slicedToArray(_React$useState,2),offset=_React$useState2[0],setOffset=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),isOpenSubmodal=_React$useState4[0],setIsOpenSubmodal=_React$useState4[1];React.useEffect(function(){/** получение списка групп контрагента */contractorId&&dispatch(getContractorGroups({id:contractorId,offset:offset,limit:10}));/** получение информации о контрагенте */userId&&dispatch(getPersonInfo(userId));},[dispatch,userId,offset,contractorId]);var onDeleteGroup=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(groupId){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return dispatch(deleteContractorGroup({groupId:groupId,contractorId:contractorId}));case 2:_context.next=4;return dispatch(getContractorGroups({id:contractorId,offset:offset,limit:10}));case 4:case\"end\":return _context.stop();}}},_callee);}));return function onDeleteGroup(_x){return _ref2.apply(this,arguments);};}();var onAddGroup=function onAddGroup(){setIsOpenSubmodal(true);};/** обработчик закрытия модалки */var hideSubmodal=function hideSubmodal(){setIsOpenSubmodal(!isOpenSubmodal);dispatch(getContractorGroups({id:contractorId,offset:offset,limit:10}));};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Modal,{hide:function hide(){return _hide();},isVisible:isVisible},/*#__PURE__*/React.createElement(Modal.Header,{title:\"\".concat(name,\" \").concat(surname,\" \").concat(patronymic)}),/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(\"h3\",{className:\"header\"},\"\\u0418\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u044F \\u043E \\u0444\\u0438\\u0437\\u0438\\u0447\\u0435\\u0441\\u043A\\u043E\\u043C \\u043B\\u0438\\u0446\\u0435\"),/*#__PURE__*/React.createElement(\"table\",{className:\"natural-entity-card-table\"},/*#__PURE__*/React.createElement(\"tbody\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},\"\\u0424\\u0418\\u041E\"),/*#__PURE__*/React.createElement(\"td\",null,\"\".concat(name,\" \").concat(surname,\" \").concat(patronymic))),/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},\"\\u0421\\u041D\\u0418\\u041B\\u0421\"),/*#__PURE__*/React.createElement(\"td\",null,socialNumber)),/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},\"\\u042D\\u043B\\u0435\\u043A\\u0442\\u0440\\u043E\\u043D\\u043D\\u0430\\u044F \\u043F\\u043E\\u0447\\u0442\\u0430\"),/*#__PURE__*/React.createElement(\"td\",null,email)))),/*#__PURE__*/React.createElement(\"h3\",{className:\"header\"},\"\\u0413\\u0440\\u0443\\u043F\\u043F\\u044B \\u043A\\u043E\\u043D\\u0442\\u0440\\u0430\\u0433\\u0435\\u043D\\u0442\\u0430\"),/*#__PURE__*/React.createElement(\"table\",{className:\"table\"},/*#__PURE__*/React.createElement(\"thead\",{className:\"common-table-head\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435\"),/*#__PURE__*/React.createElement(\"td\",null))),/*#__PURE__*/React.createElement(\"tbody\",null,rows.map(function(item){return/*#__PURE__*/React.createElement(\"tr\",{key:item.id},/*#__PURE__*/React.createElement(\"td\",null,item.title),/*#__PURE__*/React.createElement(\"td\",{align:\"right\"},/*#__PURE__*/React.createElement(Button,{icon:/*#__PURE__*/React.createElement(Icons.IconTrash,{fill:\"currentColor\"}),onClick:function onClick(){return onDeleteGroup(item.id);}},\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\")));})),/*#__PURE__*/React.createElement(\"tfoot\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(Button,{icon:/*#__PURE__*/React.createElement(Icons.IconPlus,{fill:\"currentColor\"}),onClick:function onClick(){return onAddGroup();}},\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\")),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"pagination-right\"},/*#__PURE__*/React.createElement(Pagination,{listLength:currentContractor===null||currentContractor===void 0?void 0:(_currentContractor$gr2=currentContractor.groups)===null||_currentContractor$gr2===void 0?void 0:_currentContractor$gr2.recordsTotal,setOffset:setOffset})))))))),/*#__PURE__*/React.createElement(SubModalGroups,{contractorId:contractorId,isVisible:isOpenSubmodal,hide:hideSubmodal}));};","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/contractors/components/natural-entity/NaturalEntityCard.tsx"],"names":["React","useDispatch","useSelector","Modal","Button","Icons","Pagination","getContractorGroups","deleteContractorGroup","getPersonInfo","currentContractor","currentContractorSelector","SubModalGroups","NaturalEntityCard","props","isVisible","hide","userId","contractorId","dispatch","rows","groups","person","name","surname","patronymic","socialNumber","email","useState","offset","setOffset","isOpenSubmodal","setIsOpenSubmodal","useEffect","id","limit","onDeleteGroup","groupId","onAddGroup","hideSubmodal","map","item","title","recordsTotal"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Modal, Button, Icons } from '@distate/components';\r\n\r\nimport './style.css';\r\nimport { Pagination } from '../../../../common/pagination';\r\nimport { getContractorGroups, deleteContractorGroup, getPersonInfo } from '../../store/actions';\r\nimport { currentContractor as currentContractorSelector } from '../../store/selectors';\r\nimport { SubModalGroups } from './SubModalGroups';\r\n\r\ntype Props = {\r\n  isVisible: boolean;\r\n  hide: () => void;\r\n  userId: number;\r\n  contractorId: number;\r\n};\r\n\r\n/** Карточка контрагента ФЛ */\r\nexport const NaturalEntityCard = (props: Props) => {\r\n  const { isVisible, hide, userId, contractorId } = props;\r\n  const dispatch = useDispatch();\r\n\r\n  const currentContractor = useSelector(currentContractorSelector);\r\n  const rows = currentContractor?.groups?.rows || [];\r\n\r\n  const { name = '', surname = '', patronymic = '', socialNumber = '', email = '' } =\r\n    currentContractor.person || {};\r\n\r\n  const [offset, setOffset] = React.useState();\r\n  const [isOpenSubmodal, setIsOpenSubmodal] = React.useState(false);\r\n\r\n  React.useEffect(() => {\r\n    /** получение списка групп контрагента */\r\n    contractorId && dispatch(getContractorGroups({ id: contractorId, offset, limit: 10 }));\r\n    /** получение информации о контрагенте */\r\n    userId && dispatch(getPersonInfo(userId));\r\n  }, [dispatch, userId, offset, contractorId]);\r\n\r\n  const onDeleteGroup = async (groupId: number) => {\r\n    await dispatch(deleteContractorGroup({ groupId, contractorId }));\r\n    await dispatch(getContractorGroups({ id: contractorId, offset, limit: 10 }));\r\n  };\r\n\r\n  const onAddGroup = () => {\r\n    setIsOpenSubmodal(true);\r\n  };\r\n\r\n  /** обработчик закрытия модалки */\r\n  const hideSubmodal = () => {\r\n    setIsOpenSubmodal(!isOpenSubmodal);\r\n    dispatch(getContractorGroups({ id: contractorId, offset, limit: 10 }));\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Modal hide={() => hide()} isVisible={isVisible}>\r\n        <Modal.Header title={`${name} ${surname} ${patronymic}`} />\r\n        <Modal.Body>\r\n          <h3 className=\"header\">Информация о физическом лице</h3>\r\n\r\n          <table className=\"natural-entity-card-table\">\r\n            <tbody>\r\n              <tr>\r\n                <td align=\"right\">ФИО</td>\r\n                <td>{`${name} ${surname} ${patronymic}`}</td>\r\n              </tr>\r\n              <tr>\r\n                <td align=\"right\">СНИЛС</td>\r\n                <td>{socialNumber}</td>\r\n              </tr>\r\n              <tr>\r\n                <td align=\"right\">Электронная почта</td>\r\n                <td>{email}</td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n\r\n          <h3 className=\"header\">Группы контрагента</h3>\r\n\r\n          <table className=\"table\">\r\n            <thead className=\"common-table-head\">\r\n              <tr>\r\n                <td>Название</td>\r\n                <td></td>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {rows.map(item => (\r\n                <tr key={item.id}>\r\n                  <td>{item.title}</td>\r\n                  <td align=\"right\">\r\n                    <Button\r\n                      icon={<Icons.IconTrash fill=\"currentColor\" />}\r\n                      onClick={() => onDeleteGroup(item.id)}\r\n                    >\r\n                      Удалить\r\n                    </Button>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n            <tfoot>\r\n              <tr>\r\n                <td>\r\n                  <Button\r\n                    icon={<Icons.IconPlus fill=\"currentColor\" />}\r\n                    onClick={() => onAddGroup()}\r\n                  >\r\n                    Добавить\r\n                  </Button>\r\n                </td>\r\n                <td>\r\n                  <div className=\"pagination-right\">\r\n                    <Pagination\r\n                      listLength={currentContractor?.groups?.recordsTotal}\r\n                      setOffset={setOffset}\r\n                    />\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            </tfoot>\r\n          </table>\r\n        </Modal.Body>\r\n      </Modal>\r\n\r\n      <SubModalGroups contractorId={contractorId} isVisible={isOpenSubmodal} hide={hideSubmodal} />\r\n    </>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}