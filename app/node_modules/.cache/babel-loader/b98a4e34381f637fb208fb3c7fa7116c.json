{"ast":null,"code":"import _toConsumableArray from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import React from'react';import{useDialog}from\"../../dashboard/modals/useDialog\";import GlobalVariadicForm from\"../../../components/forms/GlobalVariadicForm\";import{representativeOptions}from\"../../../constants/options/options\";import{RepresentativetypeOptions}from\"../../../constants/initialValues/RepresentativeFormInitialValues\";import ModlFormFooter from\"../../../widgets/ModlFormFooter\";import ObservableComponent from\"../../../observableComponent/observableComponent\";import GeneralSectionOptions from\"../../Sections/page/GeneralSectionOptions\";import{serviceLocator}from\"../../../../di/app_component\";import{SectionPresenter}from\"../../Sections/presenter/SectionPresenter\";var RepresentativeSection=function RepresentativeSection(_ref){var representatives=_ref.representatives,representativeManager=_ref.representativeManager,presenter=_ref.presenter,baseWidth=_ref.baseWidth;var _useDialog=useDialog(),hideDialog=_useDialog.hideDialog,openDialog=_useDialog.openDialog;var _handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(formData,index,isEditMode){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(isEditMode){representativeManager.editRepresentative(index,formData);}else representativeManager.addRepresentative(formData);presenter.update();console.log(\"representatives-----------------\");console.log(representativeManager.getRepresentatives());// setTestPrincipal(manager.getPrincipals());\nconsole.log(representativeManager.getRepresentatives());hideDialog();case 6:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x,_x2,_x3){return _ref2.apply(this,arguments);};}();var showForm=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e,index,isEditMode){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:// const selelctedRepresentative = await representativeManager.getRepresentatives()[index];\n// console.log(\";;;;;;;;;;;;;;;;;;;;;;;;;;;\",selelctedPrincipal.getFields() ?? '');\nopenDialog({alignment:\"center\",content:/*#__PURE__*/React.createElement(ObservableComponent,{builder:function builder(state){var _representatives$inde;return/*#__PURE__*/React.createElement(GlobalVariadicForm,{isSubmitting:state.isSubmitting,onStateChange:function onStateChange(status,isSubmitting,handleSubmit){return presenter.onFormStateChange(status,isSubmitting,handleSubmit);},defaultValues:representatives?(_representatives$inde=representatives[index])!==null&&_representatives$inde!==void 0?_representatives$inde:'':'',initialFields:representativeOptions,formTypes:RepresentativetypeOptions,handleSubmit:function handleSubmit(e){return _handleSubmit(e,index,isEditMode);},close:hideDialog});},create:function create(){return presenter;}}),position:\"fixed\",maxHeight:\"90%\",width:\"704px\",// maxWidth: \"500px\",\nfooter:/*#__PURE__*/React.createElement(ModlFormFooter,{state:presenter.getState()}),title:'Поиск по МЧД'},e);case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function showForm(_x4,_x5,_x6){return _ref3.apply(this,arguments);};}();var handleRemoveRepresentative=function handleRemoveRepresentative(index){var updatedPrincipals=_toConsumableArray(presenter.getState().representatives);updatedPrincipals.splice(index,1);representativeManager.removeRepresentative(index);presenter.update();console.log(\"principals-----------------\");console.log(representativeManager.getRepresentatives());console.log(\"removed\");};return/*#__PURE__*/React.createElement(ObservableComponent,{builder:function builder(state){return/*#__PURE__*/React.createElement(GeneralSectionOptions,{presenter:serviceLocator.get(SectionPresenter),sectionData:state.representatives,onShowForm:function onShowForm(e,index){return showForm(e,index,false);},onRemove:handleRemoveRepresentative,onEdit:function onEdit(e,index){return showForm(e,index,true);},baseWidth:baseWidth,isRequired:true,sectionTitle:\"Представитель\",getInn:function getInn(section){var fields=section.getFields();if(fields!=null&&fields.hasOwnProperty(\"inn\")&&fields.hasOwnProperty(\"inn\")){var _section$getFields$in;return(_section$getFields$in=section===null||section===void 0?void 0:section.getFields()[\"inn\"])!==null&&_section$getFields$in!==void 0?_section$getFields$in:\"\";}return\"\";}});},create:function create(){return presenter;},buildWhen:function buildWhen(oldState,newState){return oldState.representatives!==newState.representatives;}});};export default RepresentativeSection;","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/POA/MCHD_ROOT/presentation/pages/SubTrust/sections/RepresentativeSection.tsx"],"names":["React","useDialog","GlobalVariadicForm","representativeOptions","RepresentativetypeOptions","ModlFormFooter","ObservableComponent","GeneralSectionOptions","serviceLocator","SectionPresenter","RepresentativeSection","representatives","representativeManager","presenter","baseWidth","hideDialog","openDialog","handleSubmit","formData","index","isEditMode","editRepresentative","addRepresentative","update","console","log","getRepresentatives","showForm","e","alignment","content","state","isSubmitting","status","onFormStateChange","position","maxHeight","width","footer","getState","title","handleRemoveRepresentative","updatedPrincipals","splice","removeRepresentative","get","section","fields","getFields","hasOwnProperty","oldState","newState"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport {useDialog} from \"../../dashboard/modals/useDialog\";\r\nimport {SubTrustPresenter} from \"../presenter/SubTrustPresenter\";\r\nimport {Representative} from \"../../../../domain/model/Representative\";\r\nimport {RepresentativeManager} from \"../../../../core/RepresentativeManager\";\r\nimport GlobalVariadicForm from \"../../../components/forms/GlobalVariadicForm\";\r\nimport {representativeOptions} from \"../../../constants/options/options\";\r\nimport {RepresentativetypeOptions} from \"../../../constants/initialValues/RepresentativeFormInitialValues\";\r\nimport ModlFormFooter from \"../../../widgets/ModlFormFooter\";\r\nimport ObservableComponent from \"../../../observableComponent/observableComponent\";\r\nimport {SubTrustPresenterState} from \"../presenter/SubTrustPresenterState\";\r\nimport GeneralSectionOptions from \"../../Sections/page/GeneralSectionOptions\";\r\nimport {serviceLocator} from \"../../../../di/app_component\";\r\nimport {SectionPresenter} from \"../../Sections/presenter/SectionPresenter\";\r\nimport {SubTrustPresenterViewModel} from \"../presenter/SubTrustPresenterViewModel\";\r\n\r\ninterface RepresentativeSectionProps {\r\n    representatives: Representative[];\r\n    representativeManager: RepresentativeManager;\r\n    presenter: SubTrustPresenter;\r\n    baseWidth?: string;\r\n\r\n}\r\n\r\nconst RepresentativeSection: React.FC<RepresentativeSectionProps> = ({ representatives, representativeManager, presenter, baseWidth }: RepresentativeSectionProps) => {\r\n\r\n\r\n    const { hideDialog, openDialog } = useDialog();\r\n\r\n    const handleSubmit =async ( formData: any, index: number, isEditMode: boolean) => {\r\n        if(isEditMode){\r\n            representativeManager.editRepresentative(index, formData);\r\n        }\r\n        else\r\n            representativeManager.addRepresentative(formData);\r\n\r\n        presenter.update();\r\n        console.log(\"representatives-----------------\");\r\n        console.log(representativeManager.getRepresentatives());\r\n\r\n        // setTestPrincipal(manager.getPrincipals());\r\n        console.log(representativeManager.getRepresentatives());\r\n        hideDialog();\r\n\r\n    };\r\n\r\n    const showForm = async  (e: any, index: number, isEditMode: boolean) => {\r\n        // const selelctedRepresentative = await representativeManager.getRepresentatives()[index];\r\n        // console.log(\";;;;;;;;;;;;;;;;;;;;;;;;;;;\",selelctedPrincipal.getFields() ?? '');\r\n\r\n        openDialog({\r\n            alignment: \"center\",\r\n            content:\r\n                <ObservableComponent<SubTrustPresenterViewModel, SubTrustPresenterState, SubTrustPresenter>\r\n                    builder={(state)=> (\r\n                        <GlobalVariadicForm\r\n                            isSubmitting={state.isSubmitting}\r\n                            onStateChange={(status, isSubmitting, handleSubmit)=>presenter.onFormStateChange(status, isSubmitting, handleSubmit)}\r\n                            defaultValues={representatives ? representatives[index] ?? '' : ''}\r\n                            initialFields={representativeOptions}\r\n                            formTypes={RepresentativetypeOptions}\r\n                            handleSubmit={(e: any)=>handleSubmit(e, index, isEditMode)}\r\n                            close={hideDialog}\r\n                        />\r\n                    )}\r\n                    create={()=> presenter}\r\n                />,\r\n            position: \"fixed\",\r\n            maxHeight: \"90%\",\r\n            width: \"704px\",\r\n            // maxWidth: \"500px\",\r\n            footer: <ModlFormFooter state={presenter.getState()} />,\r\n            title: 'Поиск по МЧД',\r\n        }, e)\r\n    }\r\n\r\n    const handleRemoveRepresentative = (index: number) => {\r\n        const updatedPrincipals = [...presenter.getState().representatives];\r\n        updatedPrincipals.splice(index, 1);\r\n        representativeManager.removeRepresentative(index);\r\n        presenter.update();\r\n        console.log(\"principals-----------------\");\r\n        console.log(representativeManager.getRepresentatives());\r\n        console.log(\"removed\");\r\n\r\n    };\r\n\r\n  return (\r\n      <ObservableComponent<SubTrustPresenterViewModel, SubTrustPresenterState, SubTrustPresenter>\r\n          builder={(state: SubTrustPresenterState)=>(\r\n              <GeneralSectionOptions\r\n                  presenter={serviceLocator.get(SectionPresenter)}\r\n                  sectionData={state.representatives}\r\n                  onShowForm={(e: any, index: number)=>showForm(e, index, false)}\r\n                  onRemove={handleRemoveRepresentative}\r\n                  onEdit={(e: any, index: number)=>showForm(e, index, true)}\r\n                  baseWidth={baseWidth}\r\n                  isRequired={true}\r\n                  sectionTitle={\"Представитель\"}\r\n                  getInn={(section)=> {\r\n                      const fields: any = section.getFields();\r\n                      if (fields != null && fields.hasOwnProperty(\"inn\") && fields.hasOwnProperty(\"inn\")) {\r\n                          return  section?.getFields()[\"inn\"] ?? \"\"\r\n                      }\r\n                      return \"\";\r\n                  }}\r\n              />\r\n          )}\r\n          create={()=>presenter}\r\n          buildWhen={(oldState, newState)=>{\r\n              return oldState.representatives !== newState.representatives\r\n          }}\r\n      />\r\n  );\r\n}\r\n\r\nexport default RepresentativeSection;\r\n"]},"metadata":{},"sourceType":"module"}