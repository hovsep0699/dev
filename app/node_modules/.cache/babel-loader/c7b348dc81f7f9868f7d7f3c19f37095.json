{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{Icons,CheckBox}from'@distate/components';import{getEmployeeCertificate,changeCertificateActivation}from'../../store/actions';import{selectEmployeeCertificateRows,selectEmployeeCertificateTotal}from'../../store/selectors';import{Pagination,PaginationLimit}from'../../../../common/pagination';import fileDownload from'js-file-download';/** Сертификаты сотрудника */export var EmployeeCertificate=function EmployeeCertificate(props){var id=props.id;var dispatch=useDispatch();var certificates=useSelector(selectEmployeeCertificateRows);var recordsTotal=useSelector(selectEmployeeCertificateTotal);var _useState=useState(0),_useState2=_slicedToArray(_useState,2),offset=_useState2[0],setOffset=_useState2[1];var _useState3=useState(10),_useState4=_slicedToArray(_useState3,2),limit=_useState4[0],setLimit=_useState4[1];useEffect(function(){id&&dispatch(getEmployeeCertificate({id:id,props:{offset:offset,limit:limit}}));},[dispatch,id,offset,limit]);/** обработка нажатия - скачать сертификат */var onDownloadCertificate=function onDownloadCertificate(data){fileDownload(new Blob([data]),'certificate.cer');};/** обработчик изменения активности сертификата */var onChangeCertificateActivation=function onChangeCertificateActivation(certificateId,active){dispatch(changeCertificateActivation({id:certificateId,isActive:active,employeeId:id,props:{offset:offset,limit:limit}}));};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"h3\",{className:\"header\"},\"\\u0421\\u0435\\u0440\\u0442\\u0438\\u0444\\u0438\\u043A\\u0430\\u0442\\u044B\"),/*#__PURE__*/React.createElement(\"table\",{className:\"table\"},/*#__PURE__*/React.createElement(\"thead\",{className:\"common-table-head\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,\"\\u0414\\u043E\\u043B\\u0436\\u043D\\u043E\\u0441\\u0442\\u044C\"),/*#__PURE__*/React.createElement(\"td\",{colSpan:2},\"\\u0414\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u0442\\u0435\\u043B\\u0435\\u043D \\u0434\\u043E\"),/*#__PURE__*/React.createElement(\"td\",{align:\"center\"},\"\\u0410\\u043A\\u0442\\u0438\\u0432\\u0435\\u043D\"),/*#__PURE__*/React.createElement(\"td\",{align:\"center\"},\"\\u0421\\u043A\\u0430\\u0447\\u0430\\u0442\\u044C\"))),/*#__PURE__*/React.createElement(\"tbody\",null,certificates===null||certificates===void 0?void 0:certificates.map(function(row){var id=row.id,active=row.active,valid_until=row.valid_until,data=row.data,position=row.position;return/*#__PURE__*/React.createElement(\"tr\",{key:id},/*#__PURE__*/React.createElement(\"td\",null,position),/*#__PURE__*/React.createElement(\"td\",{colSpan:2},valid_until),/*#__PURE__*/React.createElement(\"td\",{align:\"center\"},/*#__PURE__*/React.createElement(CheckBox,{checked:active,onChange:function onChange(e){return onChangeCertificateActivation(id,active);}})),/*#__PURE__*/React.createElement(\"td\",{align:\"center\"},/*#__PURE__*/React.createElement(Icons.IconDownload,{onClick:function onClick(){return onDownloadCertificate(data);},style:{cursor:'pointer'}})));})),/*#__PURE__*/React.createElement(\"tfoot\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:3},/*#__PURE__*/React.createElement(PaginationLimit,{setLimit:setLimit,limit:limit})),/*#__PURE__*/React.createElement(\"td\",{colSpan:2},/*#__PURE__*/React.createElement(\"div\",{className:\"pagination-right\"},/*#__PURE__*/React.createElement(Pagination,{setOffset:setOffset,listLength:recordsTotal})))))));};","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/company/components/staff/EmployeeCertificate.tsx"],"names":["React","useEffect","useState","useDispatch","useSelector","Icons","CheckBox","getEmployeeCertificate","changeCertificateActivation","selectEmployeeCertificateRows","selectEmployeeCertificateTotal","Pagination","PaginationLimit","fileDownload","EmployeeCertificate","props","id","dispatch","certificates","recordsTotal","offset","setOffset","limit","setLimit","onDownloadCertificate","data","Blob","onChangeCertificateActivation","certificateId","active","isActive","employeeId","map","row","valid_until","position","e","cursor"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Icons, CheckBox } from '@distate/components';\r\nimport { getEmployeeCertificate, changeCertificateActivation } from '../../store/actions';\r\nimport {\r\n  selectEmployeeCertificateRows,\r\n  selectEmployeeCertificateTotal\r\n} from '../../store/selectors';\r\nimport { Pagination, PaginationLimit } from '../../../../common/pagination';\r\nimport fileDownload from 'js-file-download';\r\n\r\ntype Props = {\r\n  id: number;\r\n};\r\n\r\n/** Сертификаты сотрудника */\r\nexport const EmployeeCertificate = (props: Props) => {\r\n  const { id } = props;\r\n  const dispatch = useDispatch();\r\n  const certificates = useSelector(selectEmployeeCertificateRows);\r\n  const recordsTotal = useSelector(selectEmployeeCertificateTotal);\r\n\r\n  const [offset, setOffset] = useState(0);\r\n  const [limit, setLimit] = useState(10);\r\n\r\n  useEffect(() => {\r\n    id && dispatch(getEmployeeCertificate({ id, props: { offset, limit } }));\r\n  }, [dispatch, id, offset, limit]);\r\n\r\n  /** обработка нажатия - скачать сертификат */\r\n  const onDownloadCertificate = (data: any) => {\r\n    fileDownload(new Blob([data]), 'certificate.cer');\r\n  };\r\n\r\n  /** обработчик изменения активности сертификата */\r\n  const onChangeCertificateActivation = (certificateId: number, active: boolean) => {\r\n    dispatch(\r\n      changeCertificateActivation({\r\n        id: certificateId,\r\n        isActive: active,\r\n        employeeId: id,\r\n        props: { offset, limit }\r\n      })\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <h3 className=\"header\">Сертификаты</h3>\r\n\r\n      <table className=\"table\">\r\n        <thead className=\"common-table-head\">\r\n          <tr>\r\n            <td>Должность</td>\r\n            <td colSpan={2}>Действителен до</td>\r\n            <td align=\"center\">Активен</td>\r\n            <td align=\"center\">Скачать</td>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {certificates?.map(row => {\r\n            const { id, active, valid_until, data, position } = row;\r\n            return (\r\n              <tr key={id}>\r\n                <td>{position}</td>\r\n                <td colSpan={2}>{valid_until}</td>\r\n                <td align=\"center\">\r\n                  <CheckBox\r\n                    checked={active}\r\n                    onChange={e => onChangeCertificateActivation(id, active)}\r\n                  />\r\n                </td>\r\n                <td align=\"center\">\r\n                  <Icons.IconDownload\r\n                    onClick={() => onDownloadCertificate(data)}\r\n                    style={{ cursor: 'pointer' }}\r\n                  />\r\n                </td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n        <tfoot>\r\n          <tr>\r\n            <td colSpan={3}>\r\n              <PaginationLimit setLimit={setLimit} limit={limit} />\r\n            </td>\r\n            <td colSpan={2}>\r\n              <div className=\"pagination-right\">\r\n                <Pagination setOffset={setOffset} listLength={recordsTotal} />\r\n              </div>\r\n            </td>\r\n          </tr>\r\n        </tfoot>\r\n      </table>\r\n    </>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}