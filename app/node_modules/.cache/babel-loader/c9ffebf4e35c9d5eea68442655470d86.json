{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{Button,ButtonKinds,Icons,Dropdown,Input,Select,Group,DatePicker}from'@distate/components';import{useDispatch}from'react-redux';import{dateFormat}from'@distate/components/dist/FormSchema';import{getTransactionsHistory}from'../../../store/actions';import{Textarea}from'../../../../../common/textarea/Textarea';import{stringToPrice,priceToNumber}from'../../../../../utils/price';/** фильтр истории транзакций */export var TransactionsFilter=function TransactionsFilter(props){var id=props.id;var _useState=useState(),_useState2=_slicedToArray(_useState,2),summFrom=_useState2[0],setSummFrom=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),summTo=_useState4[0],setSummTo=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),createTo=_useState6[0],setCreateTo=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),createFrom=_useState8[0],setCreateFrom=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),comment=_useState10[0],setComment=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),transactionType=_useState12[0],setTransactionType=_useState12[1];/** опции для селекта Типов транзакций */var statusOptions=[{label:'Любой',value:undefined},{label:'Списание',value:'withdrawal'},{label:'Пополнение',value:'deposit'}];var dispatch=useDispatch();/** очистка формы */var onClearForm=function onClearForm(){setTransactionType(undefined);setSummFrom(undefined);setSummTo(undefined);setCreateFrom(undefined);setCreateTo(undefined);setComment('');};/** обработка нажания на кнопку Фильтровать */var onFilter=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var filterParams;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:filterParams={id:id,type:transactionType===null||transactionType===void 0?void 0:transactionType.value,'amount[from]':summFrom&&priceToNumber(summFrom)*100,'amount[to]':summTo&&priceToNumber(summTo)*100,'createdAt[from]':createFrom&&dateFormat(createFrom,'yyyy-MM-dd'),'createdAt[to]':createTo&&dateFormat(createTo,'yyyy-MM-dd')};if(comment){filterParams.comment=comment;}dispatch(getTransactionsHistory(filterParams));case 3:case\"end\":return _context.stop();}}},_callee);}));return function onFilter(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{className:\"dropdown-menu group\",style:{marginBottom:15}},/*#__PURE__*/React.createElement(Dropdown,{width:\"300px\",widthRestrict:true,trigger:/*#__PURE__*/React.createElement(Button,{icon:/*#__PURE__*/React.createElement(Icons.IconSearch,{fill:\"currentColor\"})},\"\\u0424\\u0438\\u043B\\u044C\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F\")},/*#__PURE__*/React.createElement(\"div\",{className:\"document-dropdown-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"dropdown-header\"},/*#__PURE__*/React.createElement(\"span\",null,\"\\u0424\\u0438\\u043B\\u044C\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F \\u0441\\u043F\\u0438\\u0441\\u043A\\u0430 \\u0442\\u0440\\u0430\\u043D\\u0437\\u0430\\u043A\\u0446\\u0438\\u0439\")),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Select,{value:transactionType,label:\"\\u0422\\u0438\\u043F \\u0442\\u0440\\u0430\\u043D\\u0437\\u0430\\u043A\\u0446\\u0438\\u0438\",name:\"status\",options:statusOptions,onChange:function onChange(e){return setTransactionType(e);},placeholder:\"\"}),/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex',justifyContent:'space-between'}},/*#__PURE__*/React.createElement(Input,{label:\"\\u0421\\u0443\\u043C\\u043C\\u0430 \\u043E\\u0442\",name:\"summFrom\",onChange:function onChange(e){return setSummFrom(e.target.value.replace(/[a-zа-яё]/gi,''));},value:summFrom||'0.00',onBlur:function onBlur(e){return setSummFrom(stringToPrice(e.target.value));},width:134}),/*#__PURE__*/React.createElement(Input,{label:\"\\u0434\\u043E\",name:\"summTo\",onChange:function onChange(e){return setSummTo(e.target.value.replace(/[a-zа-яё]/gi,''));},value:summTo||'0.00',onBlur:function onBlur(e){return setSummTo(stringToPrice(e.target.value));},width:134})),/*#__PURE__*/React.createElement(Group,null,/*#__PURE__*/React.createElement(DatePicker,{selectsStart:true,name:\"from\",label:\"\\u0414\\u0430\\u0442\\u0430 \\u0441\",value:createFrom,startDate:createFrom,endDate:createTo,placeholderText:\"\\u0424\\u043E\\u0440\\u043C\\u0430\\u0442: \\u0414\\u0414.\\u041C\\u041C.\\u0413\\u0413\\u0413\\u0413\",onChange:function onChange(e){return setCreateFrom(e);}}),/*#__PURE__*/React.createElement(DatePicker,{selectsEnd:true,name:\"to\",label:\"\\u043F\\u043E\",value:createTo,startDate:createFrom,endDate:createTo,minDate:createFrom,placeholderText:\"\\u0424\\u043E\\u0440\\u043C\\u0430\\u0442: \\u0414\\u0414.\\u041C\\u041C.\\u0413\\u0413\\u0413\\u0413\",onChange:function onChange(e){return setCreateTo(e);}})),/*#__PURE__*/React.createElement(Textarea,{onChange:function onChange(e){return setComment(e.target.value);},label:\"\\u041A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\",value:comment})),/*#__PURE__*/React.createElement(\"div\",{className:\"document-dropdown-buttons\"},/*#__PURE__*/React.createElement(Button,{icon:/*#__PURE__*/React.createElement(Icons.IconClose,{fill:\"currentColor\"}),fullWidth:true,onClick:onClearForm,style:{marginBottom:5}},\"\\u041E\\u0447\\u0438\\u0441\\u0442\\u0438\\u0442\\u044C\"),/*#__PURE__*/React.createElement(Button,{icon:/*#__PURE__*/React.createElement(Icons.IconSearch,{fill:\"currentColor\"}),kind:ButtonKinds.Secondary,fullWidth:true,onClick:onFilter},\"\\u0424\\u0438\\u043B\\u044C\\u0442\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\")))));};","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/finance/components/transactions-history/tools/TransactionsFilter.tsx"],"names":["React","useState","Button","ButtonKinds","Icons","Dropdown","Input","Select","Group","DatePicker","useDispatch","dateFormat","getTransactionsHistory","Textarea","stringToPrice","priceToNumber","TransactionsFilter","props","id","summFrom","setSummFrom","summTo","setSummTo","createTo","setCreateTo","createFrom","setCreateFrom","comment","setComment","transactionType","setTransactionType","statusOptions","label","value","undefined","dispatch","onClearForm","onFilter","filterParams","type","marginBottom","e","display","justifyContent","target","replace","Secondary"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport {\r\n  Button,\r\n  ButtonKinds,\r\n  Icons,\r\n  Dropdown,\r\n  Input,\r\n  Select,\r\n  Group,\r\n  DatePicker\r\n} from '@distate/components';\r\nimport { useDispatch } from 'react-redux';\r\nimport { dateFormat } from '@distate/components/dist/FormSchema';\r\nimport { getTransactionsHistory } from '../../../store/actions';\r\nimport { Textarea } from '../../../../../common/textarea/Textarea';\r\nimport { stringToPrice, priceToNumber } from '../../../../../utils/price';\r\n\r\ntype Props = {\r\n  id: number;\r\n};\r\n\r\n/** фильтр истории транзакций */\r\nexport const TransactionsFilter = (props: Props) => {\r\n  const { id } = props;\r\n\r\n  const [summFrom, setSummFrom] = useState<string>();\r\n  const [summTo, setSummTo] = useState<string>();\r\n  const [createTo, setCreateTo] = useState<any>();\r\n  const [createFrom, setCreateFrom] = useState<any>();\r\n  const [comment, setComment] = useState('');\r\n  const [transactionType, setTransactionType] = useState<HTMLSelectElement>();\r\n\r\n  /** опции для селекта Типов транзакций */\r\n  const statusOptions = [\r\n    { label: 'Любой', value: undefined },\r\n    { label: 'Списание', value: 'withdrawal' },\r\n    { label: 'Пополнение', value: 'deposit' }\r\n  ];\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  /** очистка формы */\r\n  const onClearForm = () => {\r\n    setTransactionType(undefined);\r\n    setSummFrom(undefined);\r\n    setSummTo(undefined);\r\n    setCreateFrom(undefined);\r\n    setCreateTo(undefined);\r\n    setComment('');\r\n  };\r\n\r\n  /** обработка нажания на кнопку Фильтровать */\r\n  const onFilter = async () => {\r\n    const filterParams: any = {\r\n      id,\r\n      type: transactionType?.value,\r\n      'amount[from]': summFrom && priceToNumber(summFrom) * 100,\r\n      'amount[to]': summTo && priceToNumber(summTo) * 100,\r\n      'createdAt[from]': createFrom && dateFormat(createFrom, 'yyyy-MM-dd'),\r\n      'createdAt[to]': createTo && dateFormat(createTo, 'yyyy-MM-dd')\r\n    };\r\n    if (comment) {\r\n      filterParams.comment = comment;\r\n    }\r\n    dispatch(getTransactionsHistory(filterParams));\r\n  };\r\n\r\n  return (\r\n    <div className=\"dropdown-menu group\" style={{ marginBottom: 15 }}>\r\n      <Dropdown\r\n        width=\"300px\"\r\n        widthRestrict\r\n        trigger={<Button icon={<Icons.IconSearch fill=\"currentColor\" />}>Фильтрация</Button>}\r\n      >\r\n        <div className=\"document-dropdown-wrapper\">\r\n          <div className=\"dropdown-header\">\r\n            <span>Фильтрация списка транзакций</span>\r\n          </div>\r\n          <div>\r\n            <Select\r\n              value={transactionType}\r\n              label=\"Тип транзакции\"\r\n              name=\"status\"\r\n              options={statusOptions}\r\n              onChange={(e: HTMLSelectElement) => setTransactionType(e)}\r\n              placeholder=\"\"\r\n            />\r\n            <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n              <Input\r\n                label=\"Сумма от\"\r\n                name=\"summFrom\"\r\n                onChange={e => setSummFrom(e.target.value.replace(/[a-zа-яё]/gi, ''))}\r\n                value={summFrom || '0.00'}\r\n                onBlur={e => setSummFrom(stringToPrice(e.target.value))}\r\n                width={134}\r\n              />\r\n              <Input\r\n                label=\"до\"\r\n                name=\"summTo\"\r\n                onChange={e => setSummTo(e.target.value.replace(/[a-zа-яё]/gi, ''))}\r\n                value={summTo || '0.00'}\r\n                onBlur={e => setSummTo(stringToPrice(e.target.value))}\r\n                width={134}\r\n              />\r\n            </div>\r\n            <Group>\r\n              <DatePicker\r\n                selectsStart\r\n                name=\"from\"\r\n                label=\"Дата с\"\r\n                value={createFrom}\r\n                startDate={createFrom}\r\n                endDate={createTo}\r\n                placeholderText=\"Формат: ДД.ММ.ГГГГ\"\r\n                onChange={e => setCreateFrom(e)}\r\n              />\r\n              <DatePicker\r\n                selectsEnd\r\n                name=\"to\"\r\n                label=\"по\"\r\n                value={createTo}\r\n                startDate={createFrom}\r\n                endDate={createTo}\r\n                minDate={createFrom}\r\n                placeholderText=\"Формат: ДД.ММ.ГГГГ\"\r\n                onChange={e => setCreateTo(e)}\r\n              />\r\n            </Group>\r\n            <Textarea\r\n              onChange={(e: any) => setComment(e.target.value)}\r\n              label=\"Комментарий\"\r\n              value={comment}\r\n            />\r\n          </div>\r\n          <div className=\"document-dropdown-buttons\">\r\n            <Button\r\n              icon={<Icons.IconClose fill=\"currentColor\" />}\r\n              fullWidth\r\n              onClick={onClearForm}\r\n              style={{ marginBottom: 5 }}\r\n            >\r\n              Очистить\r\n            </Button>\r\n            <Button\r\n              icon={<Icons.IconSearch fill=\"currentColor\" />}\r\n              kind={ButtonKinds.Secondary}\r\n              fullWidth\r\n              onClick={onFilter}\r\n            >\r\n              Фильтровать\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </Dropdown>\r\n    </div>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}