{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import React,{useContext}from'react';import set from'lodash.set';import get from'lodash.get';import{HTMLBody}from'./styles/body';import{BodyRow}from'./body.row';import{TableContext}from'./context';import{getAutoGoods,getAutoTotal}from'./utils';export var TableBody=function TableBody(){var _useContext=useContext(TableContext),values=_useContext.values,errors=_useContext.errors,setValues=_useContext.setValues,defaultValue=_useContext.defaultValue,authCalculated=_useContext.authCalculated;var onChange=function onChange(index,name,value){var good=values.goods[index];set(good,name,value);if(authCalculated&&(name==='taxRate.before'||name==='taxRate.after')){var goods=getAutoGoods(values.goods);var total=getAutoTotal(goods,_objectSpread({},defaultValue));setValues(_objectSpread({goods:goods},total));}else{setValues(_objectSpread({},values));}};var onBlur=function onBlur(){if(authCalculated){var goods=getAutoGoods(values.goods);var total=getAutoTotal(goods,_objectSpread({},defaultValue));setValues(_objectSpread({goods:goods},total));}};var onRemove=function onRemove(index){var valGoods=values.goods;if(!valGoods[index]){throw new Error(\"\\u0417\\u043D\\u0430\\u0447\\u0435\\u043D\\u0438\\u0435 \\u0441 \\u0438\\u043D\\u0434\\u0435\\u043A\\u0441\\u043E\\u043C \".concat(index,\" \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E.\"));}delete valGoods[index];var goods=getAutoGoods(values.goods);var total=getAutoTotal(goods,_objectSpread({},defaultValue));setValues(_objectSpread({goods:goods},total));};var renderRow=function renderRow(){var renders=[];values&&values.goods&&values.goods.forEach(function(good,i){var error=get(errors,['table','goods',i]);renders.push(/*#__PURE__*/React.createElement(BodyRow,{key:i,index:i,data:good,error:error,onBlur:onBlur,onChange:onChange,onRemove:onRemove}));});return renders;};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(HTMLBody,null,renderRow()));};","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/common/TableUniversalCorrection/body.tsx"],"names":["React","useContext","set","get","HTMLBody","BodyRow","TableContext","getAutoGoods","getAutoTotal","TableBody","values","errors","setValues","defaultValue","authCalculated","onChange","index","name","value","good","goods","total","onBlur","onRemove","valGoods","Error","renderRow","renders","forEach","i","error","push"],"mappings":"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","sourcesContent":["import React, { useContext } from 'react';\r\nimport set from 'lodash.set';\r\nimport get from 'lodash.get';\r\n\r\nimport { HTMLBody } from './styles/body';\r\nimport { BodyRow } from './body.row';\r\nimport { TableContext } from './context';\r\nimport { getAutoGoods, getAutoTotal } from './utils';\r\n\r\nexport const TableBody = () => {\r\n  const { values, errors, setValues, defaultValue, authCalculated } = useContext<any>(TableContext);\r\n\r\n  const onChange = (index: number, name: string, value: unknown) => {\r\n    const good = values.goods[index];\r\n    set(good, name, value);\r\n\r\n    if (authCalculated && (name === 'taxRate.before' || name === 'taxRate.after')) {\r\n      const goods = getAutoGoods(values.goods);\r\n      const total = getAutoTotal(goods, { ...defaultValue });\r\n      setValues({ goods, ...total });\r\n    } else {\r\n      setValues({ ...values });\r\n    }\r\n  };\r\n\r\n  const onBlur = () => {\r\n    if (authCalculated) {\r\n      const goods = getAutoGoods(values.goods);\r\n      const total = getAutoTotal(goods, { ...defaultValue });\r\n      setValues({ goods, ...total });\r\n    }\r\n  };\r\n\r\n  const onRemove = (index: number) => {\r\n    const valGoods = values.goods;\r\n    if (!valGoods[index]) {\r\n      throw new Error(`Значение с индексом ${index} не найдено.`);\r\n    }\r\n\r\n    delete valGoods[index];\r\n\r\n    const goods = getAutoGoods(values.goods);\r\n    const total = getAutoTotal(goods, { ...defaultValue });\r\n    setValues({ goods, ...total });\r\n  };\r\n\r\n  const renderRow = () => {\r\n    const renders: React.ReactNode[] = [];\r\n    values &&\r\n      values.goods &&\r\n      values.goods.forEach((good: any, i: number) => {\r\n        const error = get(errors, ['table', 'goods', i]);\r\n\r\n        renders.push(\r\n          <BodyRow\r\n            key={i}\r\n            index={i}\r\n            data={good}\r\n            error={error}\r\n            onBlur={onBlur}\r\n            onChange={onChange}\r\n            onRemove={onRemove}\r\n          />\r\n        );\r\n      });\r\n    return renders;\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <HTMLBody>{renderRow()}</HTMLBody>\r\n    </>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}