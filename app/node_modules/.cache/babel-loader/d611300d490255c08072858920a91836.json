{"ast":null,"code":"import _createClass from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _applyDecoratedDescriptor from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/applyDecoratedDescriptor\";import _classCallCheck from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";var _class,_temp;import React,{useEffect}from'react';import dialogManager from\"../pages/dashboard/modals/DialogManager\";import{Presenter}from\"../presenter/presenter\";import ObservableComponent from\"../observableComponent/observableComponent\";import autobind from\"autobind-decorator\";import{compareArraysBase}from\"../../utils/json_hepler\";var DialogViewModel=function DialogViewModel(){_classCallCheck(this,DialogViewModel);this.dialogs=void 0;};var DialogState=(_class=(_temp=/*#__PURE__*/function(){function DialogState(dialogs){_classCallCheck(this,DialogState);this.dialogs=void 0;this.dialogs=dialogs!==null&&dialogs!==void 0?dialogs:[];}_createClass(DialogState,[{key:\"initial\",value:function initial(){return new DialogState([]);}},{key:\"copyWith\",value:function copyWith(_ref){var dialogs=_ref.dialogs;return new DialogState(dialogs!==null&&dialogs!==void 0?dialogs:this.dialogs);}},{key:\"compare\",value:function compare(other){return compareArraysBase(this.dialogs,other.dialogs);}}]);return DialogState;}(),_temp),(_applyDecoratedDescriptor(_class.prototype,\"initial\",[autobind],Object.getOwnPropertyDescriptor(_class.prototype,\"initial\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"copyWith\",[autobind],Object.getOwnPropertyDescriptor(_class.prototype,\"copyWith\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"compare\",[autobind],Object.getOwnPropertyDescriptor(_class.prototype,\"compare\"),_class.prototype)),_class);export var DialogProvider=function DialogProvider(_ref2){var children=_ref2.children;var presenter=new Presenter(new DialogState(dialogManager.getDialogsModel()));// const [dialogs, setDialogs] = useState<ReactNode[]>(dialogManager.getDialogs());\n//\nuseEffect(function(){var updateDialog=function updateDialog(newDialog){var oldState=presenter.getState();presenter.setState(oldState.copyWith({dialogs:dialogManager.getDialogsModel()}));// presenter.setState(presenter.getState().copyWith(dialogs: dialogManager.getDialogsModel());\n// setDialogs(dialogManager.getDialogs());\n};dialogManager.subscribe(updateDialog);return function(){dialogManager.unsubscribe(updateDialog);};},[]);return/*#__PURE__*/React.createElement(ObservableComponent,{builder:function builder(state){return/*#__PURE__*/React.createElement(React.Fragment,null,children,state.dialogs.map(function(dialog){return dialog.dialog;}));},create:function create(){return presenter;},buildWhen:function buildWhen(oldState,newState){return oldState!==newState;}});};","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/POA/MCHD_ROOT/presentation/provider/DialogProvider.tsx"],"names":["React","useEffect","dialogManager","Presenter","ObservableComponent","autobind","compareArraysBase","DialogViewModel","dialogs","DialogState","other","DialogProvider","children","presenter","getDialogsModel","updateDialog","newDialog","oldState","getState","setState","copyWith","subscribe","unsubscribe","state","map","dialog","newState"],"mappings":"siBAAA,MAAOA,CAAAA,KAAP,EAA0BC,SAA1B,KAA0C,OAA1C,CACA,MAAOC,CAAAA,aAAP,KAA0B,yCAA1B,CACA,OAAQC,SAAR,KAAwB,wBAAxB,CACA,MAAOC,CAAAA,mBAAP,KAAgC,4CAAhC,CAEA,MAAOC,CAAAA,QAAP,KAAqB,oBAArB,CACA,OAAQC,iBAAR,KAAgC,yBAAhC,C,GAOMC,CAAAA,e,uEACFC,O,aAGEC,CAAAA,W,wCAGF,qBAAYD,OAAZ,CAA2C,wCAF3CA,OAE2C,QACvC,KAAKA,OAAL,CAAeA,OAAf,SAAeA,OAAf,UAAeA,OAAf,CAA0B,EAA1B,CACH,C,iEAE6B,CAC1B,MAAO,IAAIC,CAAAA,WAAJ,CACH,EADG,CAAP,CAGH,C,+CAEwD,IAAxCD,CAAAA,OAAwC,MAAxCA,OAAwC,CACrD,MAAO,IAAIC,CAAAA,WAAJ,CAAgBD,OAAhB,SAAgBA,OAAhB,UAAgBA,OAAhB,CAA2B,KAAKA,OAAhC,CAAP,CACH,C,wCAEcE,K,CAA6B,CACxC,MAAOJ,CAAAA,iBAAiB,CAAa,KAAKE,OAAlB,CAA2BE,KAAK,CAACF,OAAjC,CAAxB,CACH,C,yFAbAH,Q,uIAMAA,Q,uIAIAA,Q,yFAML,MAAO,IAAMM,CAAAA,cAA6C,CAAG,QAAhDA,CAAAA,cAAgD,OAAgB,IAAdC,CAAAA,QAAc,OAAdA,QAAc,CACzE,GAAMC,CAAAA,SAAkD,CAAG,GAAIV,CAAAA,SAAJ,CAA4C,GAAIM,CAAAA,WAAJ,CAAgBP,aAAa,CAACY,eAAd,EAAhB,CAA5C,CAA3D,CACA;AACA;AACAb,SAAS,CAAC,UAAM,CACZ,GAAMc,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,SAAD,CAAiC,CAClD,GAAMC,CAAAA,QAAQ,CAAGJ,SAAS,CAACK,QAAV,EAAjB,CACAL,SAAS,CAACM,QAAV,CAAmBF,QAAQ,CAACG,QAAT,CAAkB,CAACZ,OAAO,CAAEN,aAAa,CAACY,eAAd,EAAV,CAAlB,CAAnB,EACA;AACA;AACH,CALD,CAOAZ,aAAa,CAACmB,SAAd,CAAwBN,YAAxB,EAEA,MAAO,WAAM,CACTb,aAAa,CAACoB,WAAd,CAA0BP,YAA1B,EACH,CAFD,CAGH,CAbQ,CAaN,EAbM,CAAT,CAeA,mBACI,oBAAC,mBAAD,EACI,OAAO,CAAE,iBAACQ,KAAD,qBACL,wCACKX,QADL,CAEKW,KAAK,CAACf,OAAN,CAAcgB,GAAd,CAAkB,SAACC,MAAD,QAAwBA,CAAAA,MAAM,CAACA,MAA/B,EAAlB,CAFL,CADK,EADb,CAQI,MAAM,CAAE,wBAAMZ,CAAAA,SAAN,EARZ,CASI,SAAS,CAAE,mBAACI,QAAD,CAAWS,QAAX,CAAsB,CAC7B,MAAOT,CAAAA,QAAQ,GAAKS,QAApB,CACH,CAXL,EADJ,CAiBH,CApCM","sourcesContent":["import React, {ReactNode, useEffect} from 'react';\r\nimport dialogManager from \"../pages/dashboard/modals/DialogManager\";\r\nimport {Presenter} from \"../presenter/presenter\";\r\nimport ObservableComponent from \"../observableComponent/observableComponent\";\r\nimport {state} from \"../presenter/BasicState\";\r\nimport autobind from \"autobind-decorator\";\r\nimport {compareArraysBase} from \"../../utils/json_hepler\";\r\nimport {BaseDialog} from \"../../domain/model/dialog\";\r\n\r\ninterface DialogProviderProps {\r\n    children: ReactNode;\r\n}\r\n\r\nclass DialogViewModel {\r\n    dialogs?: BaseDialog[] | null;\r\n}\r\n\r\nclass DialogState implements state<DialogState, DialogViewModel> {\r\n    dialogs: BaseDialog[];\r\n\r\n    constructor(dialogs?: BaseDialog[] | null) {\r\n        this.dialogs = dialogs ?? [];\r\n    }\r\n    @autobind\r\n    public initial(): DialogState {\r\n        return new DialogState(\r\n            []\r\n        )\r\n    }\r\n    @autobind\r\n    public copyWith({dialogs}: DialogViewModel): DialogState {\r\n        return new DialogState(dialogs ?? this.dialogs);\r\n    }\r\n    @autobind\r\n    public compare(other: DialogState): boolean {\r\n        return compareArraysBase<BaseDialog>(this.dialogs, other.dialogs);\r\n    }\r\n}\r\n\r\nexport const DialogProvider: React.FC<DialogProviderProps> = ({children}) => {\r\n    const presenter: Presenter<DialogViewModel, DialogState> = new Presenter<DialogViewModel, DialogState>(new DialogState(dialogManager.getDialogsModel()));\r\n    // const [dialogs, setDialogs] = useState<ReactNode[]>(dialogManager.getDialogs());\r\n    //\r\n    useEffect(() => {\r\n        const updateDialog = (newDialog: ReactNode | null) => {\r\n            const oldState = presenter.getState();\r\n            presenter.setState(oldState.copyWith({dialogs: dialogManager.getDialogsModel()}));\r\n            // presenter.setState(presenter.getState().copyWith(dialogs: dialogManager.getDialogsModel());\r\n            // setDialogs(dialogManager.getDialogs());\r\n        };\r\n\r\n        dialogManager.subscribe(updateDialog);\r\n\r\n        return () => {\r\n            dialogManager.unsubscribe(updateDialog);\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <ObservableComponent<DialogViewModel, DialogState, Presenter<DialogViewModel, DialogState>>\r\n            builder={(state: DialogState) => (\r\n                <>\r\n                    {children}\r\n                    {state.dialogs.map((dialog: BaseDialog) => dialog.dialog)}\r\n                </>\r\n\r\n            )}\r\n            create={() => presenter}\r\n            buildWhen={(oldState, newState)=>{\r\n                return oldState !== newState;\r\n            }}\r\n        >\r\n\r\n        </ObservableComponent>\r\n    );\r\n};"]},"metadata":{},"sourceType":"module"}