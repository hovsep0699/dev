{"ast":null,"code":"import _toConsumableArray from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import React from'react';import{useDialog}from\"../../../pages/dashboard/modals/useDialog\";import GlobalVariadicForm from\"../GlobalVariadicForm\";import{representativeOptions}from\"../../../constants/options/options\";import{RepresentativetypeOptions}from\"../../../constants/initialValues/RepresentativeFormInitialValues\";import ObservableComponent from\"../../../observableComponent/observableComponent\";import ModalFormFooter from\"../../../widgets/ModlFormFooter\";import GeneralSectionOptions from\"../../../pages/Sections/page/GeneralSectionOptions\";import{serviceLocator}from\"../../../../di/app_component\";var RepresentativeSection=function RepresentativeSection(_ref){var representatives=_ref.representatives,representativeManager=_ref.representativeManager,presenter=_ref.presenter,baseWidth=_ref.baseWidth;var _useDialog=useDialog(),hideDialog=_useDialog.hideDialog,openDialog=_useDialog.openDialog;var _handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(formData,index,isEditMode){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(isEditMode){representativeManager.editRepresentative(index,formData);}else representativeManager.addRepresentative(formData);presenter.update();console.log(\"representatives-----------------\");console.log(representativeManager.getRepresentatives());// setTestPrincipal(manager.getPrincipals());\nconsole.log(representativeManager.getRepresentatives());hideDialog();case 6:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x,_x2,_x3){return _ref2.apply(this,arguments);};}();var showForm=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e,index,isSubmitting,isEditMode){var _selelctedRepresentat;var selelctedRepresentative;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return representativeManager.getRepresentatives()[index];case 2:selelctedRepresentative=_context2.sent;// console.log(\";;;;;;;;;;;;;;;;;;;;;;;;;;;\",selelctedPrincipal.getFields() ?? '');\nopenDialog({alignment:\"center\",content:/*#__PURE__*/React.createElement(GlobalVariadicForm,{isSubmitting:isSubmitting,onStateChange:presenter.onFormStateChange,defaultValues:(_selelctedRepresentat=selelctedRepresentative===null||selelctedRepresentative===void 0?void 0:selelctedRepresentative.getFields())!==null&&_selelctedRepresentat!==void 0?_selelctedRepresentat:'',initialFields:representativeOptions,formTypes:RepresentativetypeOptions,handleSubmit:function handleSubmit(e){return _handleSubmit(e,index,isEditMode);},close:hideDialog}),position:\"fixed\",maxHeight:\"90%\",width:\"704px\",// maxWidth: \"500px\",\nfooter:/*#__PURE__*/React.createElement(ObservableComponent,{builder:function builder(state){return/*#__PURE__*/React.createElement(ModalFormFooter,{state:state,onSave:function onSave(){return presenter.onFormStateChange(null,false,null);}});},create:function create(){return presenter;},buildWhen:function buildWhen(oldState,newState){return oldState.status!==newState.status||oldState.isSubmitting!==newState.isSubmitting||oldState.handleSubmit!==newState.handleSubmit;}}),title:'Поиск по МЧД'},e);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function showForm(_x4,_x5,_x6,_x7){return _ref3.apply(this,arguments);};}();var handleRemoveRepresentative=function handleRemoveRepresentative(index){var updatedPrincipals=_toConsumableArray(presenter.getState().representatives);updatedPrincipals.splice(index,1);representativeManager.removeRepresentative(index);presenter.update();console.log(\"principals-----------------\");console.log(representativeManager.getRepresentatives());console.log(\"removed\");};return/*#__PURE__*/React.createElement(ObservableComponent,{builder:function builder(state){return/*#__PURE__*/React.createElement(GeneralSectionOptions,{presenter:serviceLocator.get(\"SectionPresenter\"),sectionData:state.representatives,onShowForm:function onShowForm(e,index){return showForm(e,index,state.isSubmitting,false);},onRemove:handleRemoveRepresentative,onEdit:function onEdit(e,index){return showForm(e,index,state.isSubmitting,true);},baseWidth:baseWidth,isRequired:true,sectionTitle:\"Представитель\",getInn:function getInn(section){var fields=section.getFields();if(fields!=null&&fields.hasOwnProperty(\"inn\")&&fields.hasOwnProperty(\"inn\")){var _section$getFields$in;return(_section$getFields$in=section===null||section===void 0?void 0:section.getFields()[\"inn\"])!==null&&_section$getFields$in!==void 0?_section$getFields$in:\"\";}return\"\";}});},create:function create(){return presenter;},buildWhen:function buildWhen(oldState,newState){return!oldState.compare(newState);}});};export default RepresentativeSection;","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/POA/MCHD_ROOT/presentation/components/forms/sections/RepresevtativeSection.tsx"],"names":["React","useDialog","GlobalVariadicForm","representativeOptions","RepresentativetypeOptions","ObservableComponent","ModalFormFooter","GeneralSectionOptions","serviceLocator","RepresentativeSection","representatives","representativeManager","presenter","baseWidth","hideDialog","openDialog","handleSubmit","formData","index","isEditMode","editRepresentative","addRepresentative","update","console","log","getRepresentatives","showForm","e","isSubmitting","selelctedRepresentative","alignment","content","onFormStateChange","getFields","position","maxHeight","width","footer","state","oldState","newState","status","title","handleRemoveRepresentative","updatedPrincipals","getState","splice","removeRepresentative","get","section","fields","hasOwnProperty","compare"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport {Representative} from \"../../../../domain/model/Representative\";\r\nimport {RepresentativeManager} from \"../../../../core/RepresentativeManager\";\r\nimport {CreatePresenter} from \"../../../pages/CreatePoa/presenter/createPresenter\";\r\nimport {useDialog} from \"../../../pages/dashboard/modals/useDialog\";\r\nimport GlobalVariadicForm from \"../GlobalVariadicForm\";\r\nimport {representativeOptions} from \"../../../constants/options/options\";\r\nimport {RepresentativetypeOptions} from \"../../../constants/initialValues/RepresentativeFormInitialValues\";\r\nimport ObservableComponent from \"../../../observableComponent/observableComponent\";\r\nimport {CreatePresenterState} from \"../../../pages/CreatePoa/presenter/createPresenterState\";\r\nimport ModalFormFooter from \"../../../widgets/ModlFormFooter\";\r\nimport GeneralSectionOptions from \"../../../pages/Sections/page/GeneralSectionOptions\";\r\nimport {serviceLocator} from \"../../../../di/app_component\";\r\nimport {SectionPresenter} from \"../../../pages/Sections/presenter/SectionPresenter\";\r\nimport {CreatePresenterViewModel} from \"../../../pages/CreatePoa/presenter/createPresenterViewModel\";\r\n\r\ninterface RepresentativeSectionProps {\r\n    representatives?: Representative[];\r\n    representativeManager: RepresentativeManager;\r\n    presenter: CreatePresenter;\r\n    baseWidth?: string;\r\n}\r\n\r\nconst RepresentativeSection: React.FC<RepresentativeSectionProps> = ({\r\n                                                                         representatives,\r\n                                                                         representativeManager,\r\n                                                                         presenter,\r\n                                                                         baseWidth\r\n                                                                     }: RepresentativeSectionProps) => {\r\n\r\n\r\n    const {hideDialog, openDialog} = useDialog();\r\n\r\n    const handleSubmit = async (formData: any, index: number, isEditMode: boolean) => {\r\n        if (isEditMode) {\r\n            representativeManager.editRepresentative(index, formData);\r\n        } else\r\n            representativeManager.addRepresentative(formData);\r\n\r\n        presenter.update();\r\n        console.log(\"representatives-----------------\");\r\n        console.log(representativeManager.getRepresentatives());\r\n\r\n        // setTestPrincipal(manager.getPrincipals());\r\n        console.log(representativeManager.getRepresentatives());\r\n        hideDialog();\r\n\r\n    };\r\n\r\n    const showForm = async (e: any, index: number, isSubmitting: boolean, isEditMode: boolean) => {\r\n        const selelctedRepresentative = await representativeManager.getRepresentatives()[index];\r\n        // console.log(\";;;;;;;;;;;;;;;;;;;;;;;;;;;\",selelctedPrincipal.getFields() ?? '');\r\n\r\n        openDialog({\r\n            alignment: \"center\",\r\n            content:\r\n                <GlobalVariadicForm\r\n                    isSubmitting={isSubmitting}\r\n                    onStateChange={presenter.onFormStateChange}\r\n                    defaultValues={selelctedRepresentative?.getFields() ?? ''}\r\n                    initialFields={representativeOptions}\r\n                    formTypes={RepresentativetypeOptions}\r\n                    handleSubmit={(e: any) => handleSubmit(e, index, isEditMode)}\r\n                    close={hideDialog}\r\n                />,\r\n            position: \"fixed\",\r\n            maxHeight: \"90%\",\r\n            width: \"704px\",\r\n            // maxWidth: \"500px\",\r\n            footer: <ObservableComponent<CreatePresenterViewModel, CreatePresenterState, CreatePresenter> builder={(state) => (\r\n                <ModalFormFooter state={state} onSave={() => presenter.onFormStateChange(null, false, null)}/>\r\n            )} create={() => presenter} buildWhen={(oldState, newState) => {\r\n                return oldState.status !== newState.status || oldState.isSubmitting !== newState.isSubmitting || oldState.handleSubmit !== newState.handleSubmit;\r\n            }}/>,\r\n            title: 'Поиск по МЧД',\r\n        }, e)\r\n    }\r\n\r\n    const handleRemoveRepresentative = (index: number) => {\r\n        const updatedPrincipals = [...presenter.getState().representatives];\r\n        updatedPrincipals.splice(index, 1);\r\n        representativeManager.removeRepresentative(index);\r\n        presenter.update();\r\n        console.log(\"principals-----------------\");\r\n        console.log(representativeManager.getRepresentatives());\r\n        console.log(\"removed\");\r\n\r\n    };\r\n\r\n    return (\r\n        <ObservableComponent<CreatePresenterViewModel, CreatePresenterState, CreatePresenter>\r\n            builder={(state: CreatePresenterState) => (\r\n                <GeneralSectionOptions\r\n                    presenter={serviceLocator.get<SectionPresenter>(\"SectionPresenter\")}\r\n                    sectionData={state.representatives}\r\n                    onShowForm={(e: any, index: number) => showForm(e, index, state.isSubmitting,false)}\r\n                    onRemove={handleRemoveRepresentative}\r\n                    onEdit={(e: any, index: number) => showForm(e, index, state.isSubmitting, true)}\r\n                    baseWidth={baseWidth}\r\n                    isRequired={true}\r\n\r\n                    sectionTitle={\"Представитель\"}\r\n                    getInn={(section) => {\r\n                        const fields: any = section.getFields();\r\n                        if (fields != null && fields.hasOwnProperty(\"inn\") && fields.hasOwnProperty(\"inn\")) {\r\n                            return section?.getFields()[\"inn\"] ?? \"\"\r\n                        }\r\n                        return \"\";\r\n                    }}\r\n                />\r\n            )}\r\n            create={() => presenter}\r\n            buildWhen={(oldState, newState) => {\r\n                return !oldState.compare(newState)\r\n            }}\r\n        />\r\n    );\r\n}\r\n\r\nexport default RepresentativeSection;\r\n"]},"metadata":{},"sourceType":"module"}