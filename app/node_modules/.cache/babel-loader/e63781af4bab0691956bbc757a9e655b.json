{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _get from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/get\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nimport HasAuthHandlerBase from '../HasAuthHandlerBase';\nimport AuthRequest from '../../AuthRequest';\nimport Environment from '../../../Environment';\n\nvar AjaxGetCompanyInfoHandler = /*#__PURE__*/function (_HasAuthHandlerBase) {\n  _inherits(AjaxGetCompanyInfoHandler, _HasAuthHandlerBase);\n\n  var _super = _createSuper(AjaxGetCompanyInfoHandler);\n\n  function AjaxGetCompanyInfoHandler() {\n    _classCallCheck(this, AjaxGetCompanyInfoHandler);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(AjaxGetCompanyInfoHandler, [{\n    key: \"hasAuth\",\n    value: function hasAuth(request) {\n      var _this = this;\n\n      if (this.canHandle(request)) {\n        var url = '/front/company/current';\n\n        var successHandler = function successHandler(res) {\n          var userReadyRequest = AuthRequest.clone(request);\n          userReadyRequest.rawCompany = res;\n          return _this.doNextHandler(userReadyRequest);\n        };\n\n        var failHandler = function failHandler(error) {\n          var errorRequest = new AuthRequest();\n          errorRequest.error = _get(_getPrototypeOf(AjaxGetCompanyInfoHandler.prototype), \"createAuthError\", _this).call(_this, \"\\u0417\\u0430\\u043F\\u0440\\u043E\\u0441 \".concat(url), error);\n          return _this.doNextHandler(errorRequest);\n        };\n\n        return Environment.getAuthGateway().currentCompany().then(successHandler).catch(failHandler);\n      }\n\n      return this.doNextHandler(request);\n    }\n  }, {\n    key: \"canHandle\",\n    value: function canHandle(request) {\n      _get(_getPrototypeOf(AjaxGetCompanyInfoHandler.prototype), \"canHandle\", this).call(this, request);\n\n      var user = request.rawUser;\n      var isCompany = user && user.company;\n      if (!isCompany) return false;\n\n      if (request.isAuthed === false || !user) {\n        return false;\n      }\n\n      return true;\n    }\n  }]);\n\n  return AjaxGetCompanyInfoHandler;\n}(HasAuthHandlerBase);\n\nexport default AjaxGetCompanyInfoHandler;","map":{"version":3,"sources":["../../../../../src/application/auth/handlers/hasAuth/AjaxGetCompanyInfoHandler.js"],"names":[],"mappings":";;;;;;AAAA,OAAO,kBAAP,MAA+B,uBAA/B;AACA,OAAO,WAAP,MAAwB,mBAAxB;AACA,OAAO,WAAP,MAAwB,sBAAxB;;IAEM,yB;;;;;;;;;;;;;4BACI,O,EAAO;AAAA;;AACb,UAAI,KAAK,SAAL,CAAe,OAAf,CAAJ,EAA6B;AAC3B,YAAM,GAAG,GAAG,wBAAZ;;AACA,YAAM,cAAc,GAAG,SAAjB,cAAiB,CAAA,GAAG,EAAG;AAC3B,cAAM,gBAAgB,GAAG,WAAW,CAAC,KAAZ,CAAkB,OAAlB,CAAzB;AACA,UAAA,gBAAgB,CAAC,UAAjB,GAA8B,GAA9B;AACA,iBAAO,KAAI,CAAC,aAAL,CAAmB,gBAAnB,CAAP;AACD,SAJD;;AAMA,YAAM,WAAW,GAAG,SAAd,WAAc,CAAA,KAAK,EAAG;AAC1B,cAAM,YAAY,GAAG,IAAI,WAAJ,EAArB;AACA,UAAA,YAAY,CAAC,KAAb,mJAAqD,GAArD,GAA4D,KAA5D;AACA,iBAAO,KAAI,CAAC,aAAL,CAAmB,YAAnB,CAAP;AACD,SAJD;;AAMA,eAAO,WAAW,CAAC,cAAZ,GACJ,cADI,GAEJ,IAFI,CAEC,cAFD,EAGJ,KAHI,CAGE,WAHF,CAAP;AAID;;AACD,aAAO,KAAK,aAAL,CAAmB,OAAnB,CAAP;AACD;;;8BAES,O,EAAO;AACf,+FAAgB,OAAhB;;AACA,UAAM,IAAI,GAAG,OAAO,CAAC,OAArB;AACA,UAAM,SAAS,GAAG,IAAI,IAAI,IAAI,CAAC,OAA/B;AACA,UAAI,CAAC,SAAL,EAAgB,OAAO,KAAP;;AAEhB,UAAI,OAAO,CAAC,QAAR,KAAqB,KAArB,IAA8B,CAAC,IAAnC,EAAyC;AACvC,eAAO,KAAP;AACD;;AACD,aAAO,IAAP;AACD;;;;EAlCqC,kB;;AAqCxC,eAAe,yBAAf","sourceRoot":"","sourcesContent":["import HasAuthHandlerBase from '../HasAuthHandlerBase';\r\nimport AuthRequest from '../../AuthRequest';\r\nimport Environment from '../../../Environment';\r\nclass AjaxGetCompanyInfoHandler extends HasAuthHandlerBase {\r\n    hasAuth(request) {\r\n        if (this.canHandle(request)) {\r\n            const url = '/front/company/current';\r\n            const successHandler = res => {\r\n                const userReadyRequest = AuthRequest.clone(request);\r\n                userReadyRequest.rawCompany = res;\r\n                return this.doNextHandler(userReadyRequest);\r\n            };\r\n            const failHandler = error => {\r\n                const errorRequest = new AuthRequest();\r\n                errorRequest.error = super.createAuthError(`Запрос ${url}`, error);\r\n                return this.doNextHandler(errorRequest);\r\n            };\r\n            return Environment.getAuthGateway()\r\n                .currentCompany()\r\n                .then(successHandler)\r\n                .catch(failHandler);\r\n        }\r\n        return this.doNextHandler(request);\r\n    }\r\n    canHandle(request) {\r\n        super.canHandle(request);\r\n        const user = request.rawUser;\r\n        const isCompany = user && user.company;\r\n        if (!isCompany)\r\n            return false;\r\n        if (request.isAuthed === false || !user) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n}\r\nexport default AjaxGetCompanyInfoHandler;\r\n//# sourceMappingURL=AjaxGetCompanyInfoHandler.js.map"]},"metadata":{},"sourceType":"module"}