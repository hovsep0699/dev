{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _get from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/get\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nimport SignHandlerBase from '../SignHandlerBase';\nimport SignRequest from '../../SignRequest';\nimport Environment from '../../../Environment';\n\nvar ReceiptsHandler = /*#__PURE__*/function (_SignHandlerBase) {\n  _inherits(ReceiptsHandler, _SignHandlerBase);\n\n  var _super = _createSuper(ReceiptsHandler);\n\n  function ReceiptsHandler() {\n    _classCallCheck(this, ReceiptsHandler);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(ReceiptsHandler, [{\n    key: \"sign\",\n    value: function sign(request) {\n      var _this = this;\n\n      _get(_getPrototypeOf(ReceiptsHandler.prototype), \"sign\", this).call(this, request);\n\n      if (this.canHandle(request)) {\n        var url = '/front/document/for_signing';\n\n        var successHandler = function successHandler(response) {\n          var grantedRequest = SignRequest.clone(request);\n          grantedRequest.documents = response.documents;\n          return _this.doNextHandler(grantedRequest);\n        };\n\n        var failHandler = function failHandler(error) {\n          var errorRequest = SignRequest.clone(request);\n          errorRequest.error = _get(_getPrototypeOf(ReceiptsHandler.prototype), \"createSignError\", _this).call(_this, \"\\u0417\\u0430\\u043F\\u0440\\u043E\\u0441 \".concat(url), error);\n          return _this.doNextHandler(errorRequest);\n        };\n\n        return Environment.getSignGateway().getReceiptsForSigning().then(successHandler).catch(failHandler);\n      }\n\n      return this.doNextHandler(request);\n    }\n  }, {\n    key: \"canHandle\",\n    value: function canHandle(request) {\n      _get(_getPrototypeOf(ReceiptsHandler.prototype), \"canHandle\", this).call(this, request);\n\n      return !!request.certificate && request.isGrantedToSign && request.isAutoMode;\n    }\n  }]);\n\n  return ReceiptsHandler;\n}(SignHandlerBase);\n\nexport default ReceiptsHandler;","map":{"version":3,"sources":["../../../../../src/application/sign/handlers/sign/ReceiptsHandler.js"],"names":[],"mappings":";;;;;;AAAA,OAAO,eAAP,MAA4B,oBAA5B;AACA,OAAO,WAAP,MAAwB,mBAAxB;AACA,OAAO,WAAP,MAAwB,sBAAxB;;IAEM,e;;;;;;;;;;;;;yBACC,O,EAAO;AAAA;;AACV,gFAAW,OAAX;;AACA,UAAI,KAAK,SAAL,CAAe,OAAf,CAAJ,EAA6B;AAC3B,YAAM,GAAG,GAAG,6BAAZ;;AACA,YAAM,cAAc,GAAG,SAAjB,cAAiB,CAAA,QAAQ,EAAG;AAChC,cAAM,cAAc,GAAG,WAAW,CAAC,KAAZ,CAAkB,OAAlB,CAAvB;AACA,UAAA,cAAc,CAAC,SAAf,GAA2B,QAAQ,CAAC,SAApC;AACA,iBAAO,KAAI,CAAC,aAAL,CAAmB,cAAnB,CAAP;AACD,SAJD;;AAMA,YAAM,WAAW,GAAG,SAAd,WAAc,CAAA,KAAK,EAAG;AAC1B,cAAM,YAAY,GAAG,WAAW,CAAC,KAAZ,CAAkB,OAAlB,CAArB;AACA,UAAA,YAAY,CAAC,KAAb,yIAAqD,GAArD,GAA4D,KAA5D;AACA,iBAAO,KAAI,CAAC,aAAL,CAAmB,YAAnB,CAAP;AACD,SAJD;;AAMA,eAAO,WAAW,CAAC,cAAZ,GACJ,qBADI,GAEJ,IAFI,CAEC,cAFD,EAGJ,KAHI,CAGE,WAHF,CAAP;AAID;;AACD,aAAO,KAAK,aAAL,CAAmB,OAAnB,CAAP;AACD;;;8BAES,O,EAAO;AACf,qFAAgB,OAAhB;;AACA,aAAO,CAAC,CAAC,OAAO,CAAC,WAAV,IAAyB,OAAO,CAAC,eAAjC,IAAoD,OAAO,CAAC,UAAnE;AACD;;;;EA5B2B,e;;AA+B9B,eAAe,eAAf","sourceRoot":"","sourcesContent":["import SignHandlerBase from '../SignHandlerBase';\r\nimport SignRequest from '../../SignRequest';\r\nimport Environment from '../../../Environment';\r\nclass ReceiptsHandler extends SignHandlerBase {\r\n    sign(request) {\r\n        super.sign(request);\r\n        if (this.canHandle(request)) {\r\n            const url = '/front/document/for_signing';\r\n            const successHandler = response => {\r\n                const grantedRequest = SignRequest.clone(request);\r\n                grantedRequest.documents = response.documents;\r\n                return this.doNextHandler(grantedRequest);\r\n            };\r\n            const failHandler = error => {\r\n                const errorRequest = SignRequest.clone(request);\r\n                errorRequest.error = super.createSignError(`Запрос ${url}`, error);\r\n                return this.doNextHandler(errorRequest);\r\n            };\r\n            return Environment.getSignGateway()\r\n                .getReceiptsForSigning()\r\n                .then(successHandler)\r\n                .catch(failHandler);\r\n        }\r\n        return this.doNextHandler(request);\r\n    }\r\n    canHandle(request) {\r\n        super.canHandle(request);\r\n        return !!request.certificate && request.isGrantedToSign && request.isAutoMode;\r\n    }\r\n}\r\nexport default ReceiptsHandler;\r\n//# sourceMappingURL=ReceiptsHandler.js.map"]},"metadata":{},"sourceType":"module"}