{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(invitationEffect),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(createPersonInvitationWatcher),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(createLocalCompanyInvitationWatcher),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(createRoamingCompanyInvitationWatcher),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(createLocalRoamingCompanyInvitationWatcher),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(createHub1cCompanyInvitationWatcher),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(invitationDecisionWatcher);import{takeLatest,call,put}from'redux-saga/effects';import{createPersonInvitation,createLocalCompanyInvitation,createRoamingCompanyInvitation,createLocalRoamingCompanyInvitation,createHub1cCompanyInvitation,setFoundErrors,invitationDecision,getInviteYouContractor}from'../actions';import{Flash}from'../../../../common/flash/Flash';import{ContractorApiServices}from'../../services/contractors.api';import{history}from'../../../../App';import{CONTRACTOR_WAITING_ANSWER}from'../../../../common/Url';export function invitationEffect(){return _regeneratorRuntime.wrap(function invitationEffect$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return takeLatest(createPersonInvitation,createPersonInvitationWatcher);case 2:_context.next=4;return takeLatest(createLocalCompanyInvitation,createLocalCompanyInvitationWatcher);case 4:_context.next=6;return takeLatest(createRoamingCompanyInvitation,createRoamingCompanyInvitationWatcher);case 6:_context.next=8;return takeLatest(createLocalRoamingCompanyInvitation,createLocalRoamingCompanyInvitationWatcher);case 8:_context.next=10;return takeLatest(createHub1cCompanyInvitation,createHub1cCompanyInvitationWatcher);case 10:_context.next=12;return takeLatest(invitationDecision,invitationDecisionWatcher);case 12:case\"end\":return _context.stop();}}},_marked);}/** Приглашение ФЛ */function createPersonInvitationWatcher(_ref){var payload,_response$data,_response$data2,type,personID,response;return _regeneratorRuntime.wrap(function createPersonInvitationWatcher$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:payload=_ref.payload;_context2.prev=1;type=payload.type,personID=payload.personID;_context2.next=5;return call(ContractorApiServices.createLocalInvitationPerson,{type:type,personID:personID});case 5:response=_context2.sent;_context2.next=8;return(response===null||response===void 0?void 0:(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.id)&&history.push(CONTRACTOR_WAITING_ANSWER);case 8:_context2.next=10;return(response===null||response===void 0?void 0:(_response$data2=response.data)===null||_response$data2===void 0?void 0:_response$data2.id)&&Flash.success('Приглашение отправлено');case 10:_context2.next=20;break;case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](1);if(!(_context2.t0.response.status===500)){_context2.next=17;break;}_context2.next=17;return Flash.error('Возникла ошибка');case 17:if(!(_context2.t0.response.status===400)){_context2.next=20;break;}_context2.next=20;return put(setFoundErrors(_context2.t0.response.data));case 20:case\"end\":return _context2.stop();}}},_marked2,null,[[1,12]]);}/** Приглашение Локального ЮЛ */function createLocalCompanyInvitationWatcher(_ref2){var payload,_response$data3,_response$data4,type,companyID,response;return _regeneratorRuntime.wrap(function createLocalCompanyInvitationWatcher$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:payload=_ref2.payload;_context3.prev=1;type=payload.type,companyID=payload.companyID;_context3.next=5;return call(ContractorApiServices.createLocalInvitationCompany,{type:type,companyID:companyID});case 5:response=_context3.sent;_context3.next=8;return(response===null||response===void 0?void 0:(_response$data3=response.data)===null||_response$data3===void 0?void 0:_response$data3.id)&&history.push(CONTRACTOR_WAITING_ANSWER);case 8:_context3.next=10;return(response===null||response===void 0?void 0:(_response$data4=response.data)===null||_response$data4===void 0?void 0:_response$data4.id)&&Flash.success('Приглашение отправлено');case 10:_context3.next=20;break;case 12:_context3.prev=12;_context3.t0=_context3[\"catch\"](1);if(!(_context3.t0.response.status===500)){_context3.next=17;break;}_context3.next=17;return Flash.error('Возникла ошибка');case 17:if(!(_context3.t0.response.status===400)){_context3.next=20;break;}_context3.next=20;return put(setFoundErrors(_context3.t0.response.data));case 20:case\"end\":return _context3.stop();}}},_marked3,null,[[1,12]]);}/** Приглашение ЮЛ в Роуминге */function createRoamingCompanyInvitationWatcher(_ref3){var payload,_response$data5,_response$data6,type,fnsUid,inn,response;return _regeneratorRuntime.wrap(function createRoamingCompanyInvitationWatcher$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:payload=_ref3.payload;_context4.prev=1;type=payload.type,fnsUid=payload.fnsUid,inn=payload.inn;_context4.next=5;return call(ContractorApiServices.createRoamingInvitationCompany,{type:type,fnsUid:fnsUid,inn:inn});case 5:response=_context4.sent;_context4.next=8;return(response===null||response===void 0?void 0:(_response$data5=response.data)===null||_response$data5===void 0?void 0:_response$data5.id)&&history.push(CONTRACTOR_WAITING_ANSWER);case 8:_context4.next=10;return(response===null||response===void 0?void 0:(_response$data6=response.data)===null||_response$data6===void 0?void 0:_response$data6.id)&&Flash.success('Приглашение отправлено');case 10:_context4.next=20;break;case 12:_context4.prev=12;_context4.t0=_context4[\"catch\"](1);if(!(_context4.t0.response.status===500)){_context4.next=17;break;}_context4.next=17;return Flash.error('Возникла ошибка');case 17:if(!(_context4.t0.response.status===400)){_context4.next=20;break;}_context4.next=20;return put(setFoundErrors(_context4.t0.response.data));case 20:case\"end\":return _context4.stop();}}},_marked4,null,[[1,12]]);}/** Приглашение ЮЛ в Локальном Роуминге */function createLocalRoamingCompanyInvitationWatcher(_ref4){var payload,_response$data7,_response$data8,type,fnsUid,networkId,response;return _regeneratorRuntime.wrap(function createLocalRoamingCompanyInvitationWatcher$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:payload=_ref4.payload;_context5.prev=1;type=payload.type,fnsUid=payload.fnsUid,networkId=payload.networkId;_context5.next=5;return call(ContractorApiServices.createLocalRoamingInvitationCompany,{type:type,fnsUid:fnsUid,networkId:networkId});case 5:response=_context5.sent;_context5.next=8;return(response===null||response===void 0?void 0:(_response$data7=response.data)===null||_response$data7===void 0?void 0:_response$data7.id)&&history.push(CONTRACTOR_WAITING_ANSWER);case 8:_context5.next=10;return(response===null||response===void 0?void 0:(_response$data8=response.data)===null||_response$data8===void 0?void 0:_response$data8.id)&&Flash.success('Приглашение отправлено');case 10:_context5.next=20;break;case 12:_context5.prev=12;_context5.t0=_context5[\"catch\"](1);if(!(_context5.t0.response.status===500)){_context5.next=17;break;}_context5.next=17;return Flash.error('Возникла ошибка');case 17:if(!(_context5.t0.response.status===400)){_context5.next=20;break;}_context5.next=20;return put(setFoundErrors(_context5.t0.response.data));case 20:case\"end\":return _context5.stop();}}},_marked5,null,[[1,12]]);}/** Приглашение ЮЛ в 1С-ЭДО */function createHub1cCompanyInvitationWatcher(_ref5){var payload,_response$data9,_response$data10,type,fnsUid,inn,response;return _regeneratorRuntime.wrap(function createHub1cCompanyInvitationWatcher$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:payload=_ref5.payload;_context6.prev=1;type=payload.type,fnsUid=payload.fnsUid,inn=payload.inn;_context6.next=5;return call(ContractorApiServices.createTaxcomInvitationCompany,{type:type,fnsUid:fnsUid,inn:inn});case 5:response=_context6.sent;_context6.next=8;return(response===null||response===void 0?void 0:(_response$data9=response.data)===null||_response$data9===void 0?void 0:_response$data9.id)&&history.push(CONTRACTOR_WAITING_ANSWER);case 8:_context6.next=10;return(response===null||response===void 0?void 0:(_response$data10=response.data)===null||_response$data10===void 0?void 0:_response$data10.id)&&Flash.success('Приглашение отправлено');case 10:_context6.next=20;break;case 12:_context6.prev=12;_context6.t0=_context6[\"catch\"](1);if(!(_context6.t0.response.status===500)){_context6.next=17;break;}_context6.next=17;return Flash.error('Возникла ошибка');case 17:if(!(_context6.t0.response.status===400)){_context6.next=20;break;}_context6.next=20;return put(setFoundErrors(_context6.t0.response.data));case 20:case\"end\":return _context6.stop();}}},_marked6,null,[[1,12]]);}/** Принятие решения (принять приглашение или отклонить) */function invitationDecisionWatcher(_ref6){var payload,id,decision,offset,searchParams;return _regeneratorRuntime.wrap(function invitationDecisionWatcher$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:payload=_ref6.payload;_context7.prev=1;id=payload.id,decision=payload.decision,offset=payload.offset,searchParams=payload.searchParams;/** отправка решения */_context7.next=5;return ContractorApiServices.invitationDecision(id,decision);case 5:_context7.next=7;return put(getInviteYouContractor(_objectSpread(_objectSpread({},searchParams),{},{offset:offset})));case 7:_context7.next=17;break;case 9:_context7.prev=9;_context7.t0=_context7[\"catch\"](1);if(!(_context7.t0.response.status===500)){_context7.next=14;break;}_context7.next=14;return Flash.error('Возникла ошибка');case 14:if(!(_context7.t0.response.status===400)){_context7.next=17;break;}_context7.next=17;return put(setFoundErrors(_context7.t0.response.data));case 17:case\"end\":return _context7.stop();}}},_marked7,null,[[1,9]]);}","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/contractors/store/sagas/invitation.effect.ts"],"names":["invitationEffect","createPersonInvitationWatcher","createLocalCompanyInvitationWatcher","createRoamingCompanyInvitationWatcher","createLocalRoamingCompanyInvitationWatcher","createHub1cCompanyInvitationWatcher","invitationDecisionWatcher","takeLatest","call","put","createPersonInvitation","createLocalCompanyInvitation","createRoamingCompanyInvitation","createLocalRoamingCompanyInvitation","createHub1cCompanyInvitation","setFoundErrors","invitationDecision","getInviteYouContractor","Flash","ContractorApiServices","history","CONTRACTOR_WAITING_ANSWER","payload","type","personID","createLocalInvitationPerson","response","data","id","push","success","status","error","companyID","createLocalInvitationCompany","fnsUid","inn","createRoamingInvitationCompany","networkId","createLocalRoamingInvitationCompany","createTaxcomInvitationCompany","decision","offset","searchParams"],"mappings":"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","sourcesContent":["import { takeLatest, call, put } from 'redux-saga/effects';\r\n\r\nimport {\r\n  createPersonInvitation,\r\n  createLocalCompanyInvitation,\r\n  createRoamingCompanyInvitation,\r\n  createLocalRoamingCompanyInvitation,\r\n  createHub1cCompanyInvitation,\r\n  setFoundErrors,\r\n  invitationDecision,\r\n  getInviteYouContractor\r\n} from '../actions';\r\nimport { Flash } from '../../../../common/flash/Flash';\r\nimport { ContractorApiServices } from '../../services/contractors.api';\r\nimport { DestinationType, InvitationDecision } from '../../helpers/contractors.typings';\r\nimport { history } from '../../../../App';\r\nimport { CONTRACTOR_WAITING_ANSWER } from '../../../../common/Url';\r\n\r\nexport function* invitationEffect() {\r\n  yield takeLatest(createPersonInvitation, createPersonInvitationWatcher);\r\n  yield takeLatest(createLocalCompanyInvitation, createLocalCompanyInvitationWatcher);\r\n  yield takeLatest(createRoamingCompanyInvitation, createRoamingCompanyInvitationWatcher);\r\n  yield takeLatest(createLocalRoamingCompanyInvitation, createLocalRoamingCompanyInvitationWatcher);\r\n  yield takeLatest(createHub1cCompanyInvitation, createHub1cCompanyInvitationWatcher);\r\n  yield takeLatest(invitationDecision, invitationDecisionWatcher);\r\n}\r\n\r\ntype PersonPayload = {\r\n  type: DestinationType;\r\n  personID: number;\r\n};\r\n\r\n/** Приглашение ФЛ */\r\nfunction* createPersonInvitationWatcher({ payload }: { payload: PersonPayload }) {\r\n  try {\r\n    const { type, personID } = payload;\r\n    const response = yield call(ContractorApiServices.createLocalInvitationPerson, {\r\n      type,\r\n      personID\r\n    });\r\n    yield response?.data?.id && history.push(CONTRACTOR_WAITING_ANSWER);\r\n    yield response?.data?.id && Flash.success('Приглашение отправлено');\r\n  } catch (error) {\r\n    if (error.response.status === 500) {\r\n      yield Flash.error('Возникла ошибка');\r\n    }\r\n\r\n    if (error.response.status === 400) {\r\n      yield put(setFoundErrors(error.response.data));\r\n    }\r\n  }\r\n}\r\n\r\ntype LocalCompanyPayload = {\r\n  type: DestinationType;\r\n  companyID: number;\r\n};\r\n/** Приглашение Локального ЮЛ */\r\nfunction* createLocalCompanyInvitationWatcher({ payload }: { payload: LocalCompanyPayload }) {\r\n  try {\r\n    const { type, companyID } = payload;\r\n\r\n    const response = yield call(ContractorApiServices.createLocalInvitationCompany, {\r\n      type,\r\n      companyID\r\n    });\r\n    yield response?.data?.id && history.push(CONTRACTOR_WAITING_ANSWER);\r\n    yield response?.data?.id && Flash.success('Приглашение отправлено');\r\n  } catch (error) {\r\n    if (error.response.status === 500) {\r\n      yield Flash.error('Возникла ошибка');\r\n    }\r\n\r\n    if (error.response.status === 400) {\r\n      yield put(setFoundErrors(error.response.data));\r\n    }\r\n  }\r\n}\r\n\r\ntype RoamingCompanyPayload = {\r\n  type: DestinationType;\r\n  fnsUid: string;\r\n  inn: string;\r\n};\r\n/** Приглашение ЮЛ в Роуминге */\r\nfunction* createRoamingCompanyInvitationWatcher({ payload }: { payload: RoamingCompanyPayload }) {\r\n  try {\r\n    const { type, fnsUid, inn } = payload;\r\n\r\n    const response = yield call(ContractorApiServices.createRoamingInvitationCompany, {\r\n      type,\r\n      fnsUid,\r\n      inn\r\n    });\r\n    yield response?.data?.id && history.push(CONTRACTOR_WAITING_ANSWER);\r\n    yield response?.data?.id && Flash.success('Приглашение отправлено');\r\n  } catch (error) {\r\n    if (error.response.status === 500) {\r\n      yield Flash.error('Возникла ошибка');\r\n    }\r\n\r\n    if (error.response.status === 400) {\r\n      yield put(setFoundErrors(error.response.data));\r\n    }\r\n  }\r\n}\r\n\r\ntype LocalRoamingCompanyPayload = {\r\n  type: DestinationType;\r\n  fnsUid: string;\r\n  networkId: string;\r\n};\r\n/** Приглашение ЮЛ в Локальном Роуминге */\r\nfunction* createLocalRoamingCompanyInvitationWatcher({\r\n  payload\r\n}: {\r\n  payload: LocalRoamingCompanyPayload;\r\n}) {\r\n  try {\r\n    const { type, fnsUid, networkId } = payload;\r\n\r\n    const response = yield call(ContractorApiServices.createLocalRoamingInvitationCompany, {\r\n      type,\r\n      fnsUid,\r\n      networkId\r\n    });\r\n    yield response?.data?.id && history.push(CONTRACTOR_WAITING_ANSWER);\r\n    yield response?.data?.id && Flash.success('Приглашение отправлено');\r\n  } catch (error) {\r\n    if (error.response.status === 500) {\r\n      yield Flash.error('Возникла ошибка');\r\n    }\r\n\r\n    if (error.response.status === 400) {\r\n      yield put(setFoundErrors(error.response.data));\r\n    }\r\n  }\r\n}\r\n\r\ntype Hub1cCompanyPayload = {\r\n  type: DestinationType;\r\n  fnsUid: string;\r\n  inn: string;\r\n};\r\n/** Приглашение ЮЛ в 1С-ЭДО */\r\nfunction* createHub1cCompanyInvitationWatcher({ payload }: { payload: Hub1cCompanyPayload }) {\r\n  try {\r\n    const { type, fnsUid, inn } = payload;\r\n\r\n    const response = yield call(ContractorApiServices.createTaxcomInvitationCompany, {\r\n      type,\r\n      fnsUid,\r\n      inn\r\n    });\r\n    yield response?.data?.id && history.push(CONTRACTOR_WAITING_ANSWER);\r\n    yield response?.data?.id && Flash.success('Приглашение отправлено');\r\n  } catch (error) {\r\n    if (error.response.status === 500) {\r\n      yield Flash.error('Возникла ошибка');\r\n    }\r\n\r\n    if (error.response.status === 400) {\r\n      yield put(setFoundErrors(error.response.data));\r\n    }\r\n  }\r\n}\r\n\r\ntype DecisionPayload = {\r\n  id: number;\r\n  decision: InvitationDecision;\r\n  offset: number;\r\n  searchParams: {};\r\n};\r\n/** Принятие решения (принять приглашение или отклонить) */\r\nfunction* invitationDecisionWatcher({ payload }: { payload: DecisionPayload }) {\r\n  try {\r\n    const { id, decision, offset, searchParams } = payload;\r\n    /** отправка решения */\r\n    yield ContractorApiServices.invitationDecision(id, decision);\r\n    /** обновление списка */\r\n    yield put(getInviteYouContractor({ ...searchParams, offset }));\r\n  } catch (error) {\r\n    if (error.response.status === 500) {\r\n      yield Flash.error('Возникла ошибка');\r\n    }\r\n\r\n    if (error.response.status === 400) {\r\n      yield put(setFoundErrors(error.response.data));\r\n    }\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}