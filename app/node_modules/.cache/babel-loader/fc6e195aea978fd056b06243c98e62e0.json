{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\Hovsep\\\\Desktop\\\\local\\\\diflow_react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(contractorGroupsEffect),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(getContractorGroupsWorker),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(deleteContractorGroupWorker),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(getNoContractorGroupsWorker),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(addContractorToGroupWorker);import{takeLatest,put}from'redux-saga/effects';import{getContractorGroups,setContractorGroups,deleteContractorGroup,getNoContractorGroups,setNoContractorGroups,addContractorToGroup}from'../actions';import{Flash}from'../../../../common/flash/Flash';import{ContractorApiServices}from'../../services/contractors.api';export function contractorGroupsEffect(){return _regeneratorRuntime.wrap(function contractorGroupsEffect$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return takeLatest(getContractorGroups,getContractorGroupsWorker);case 2:_context.next=4;return takeLatest(deleteContractorGroup,deleteContractorGroupWorker);case 4:_context.next=6;return takeLatest(getNoContractorGroups,getNoContractorGroupsWorker);case 6:_context.next=8;return takeLatest(addContractorToGroup,addContractorToGroupWorker);case 8:case\"end\":return _context.stop();}}},_marked);}/** Получить группы контрагента */function getContractorGroupsWorker(_ref){var payload,id,offset,limit,res,message;return _regeneratorRuntime.wrap(function getContractorGroupsWorker$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:payload=_ref.payload;_context2.prev=1;id=payload.id,offset=payload.offset,limit=payload.limit;_context2.next=5;return ContractorApiServices.getContractorGroups({id:id,offset:offset,limit:limit});case 5:res=_context2.sent;_context2.next=8;return put(setContractorGroups({currentContractor:{groups:res}}));case 8:_context2.next=15;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](1);message=_context2.t0.message;_context2.next=15;return Flash.error(message||'Возникла ошибка');case 15:case\"end\":return _context2.stop();}}},_marked2,null,[[1,10]]);}/** удаление контрагента из группы */function deleteContractorGroupWorker(_ref3){var payload,message;return _regeneratorRuntime.wrap(function deleteContractorGroupWorker$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:payload=_ref3.payload;_context3.prev=1;_context3.next=4;return ContractorApiServices.deleteContractorGroup(payload);case 4:_context3.next=11;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](1);message=_context3.t0.message;_context3.next=11;return Flash.error(message||'Возникла ошибка');case 11:case\"end\":return _context3.stop();}}},_marked3,null,[[1,6]]);}/** получение групп, в которых еще нет контрагента */function getNoContractorGroupsWorker(_ref5){var payload,id,offset,limit,res,message;return _regeneratorRuntime.wrap(function getNoContractorGroupsWorker$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:payload=_ref5.payload;_context4.prev=1;id=payload.id,offset=payload.offset,limit=payload.limit;_context4.next=5;return ContractorApiServices.getContractorGroups({id:id,offset:offset,limit:limit,inverseJoin:true});case 5:res=_context4.sent;_context4.next=8;return put(setNoContractorGroups({currentContractor:{newGroups:res}}));case 8:_context4.next=15;break;case 10:_context4.prev=10;_context4.t0=_context4[\"catch\"](1);message=_context4.t0.message;_context4.next=15;return Flash.error(message||'Возникла ошибка');case 15:case\"end\":return _context4.stop();}}},_marked4,null,[[1,10]]);}/** добавление пользователя в группу */function addContractorToGroupWorker(_ref7){var payload,message;return _regeneratorRuntime.wrap(function addContractorToGroupWorker$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:payload=_ref7.payload;_context5.prev=1;_context5.next=4;return ContractorApiServices.addContractorToGroup(payload);case 4:_context5.next=11;break;case 6:_context5.prev=6;_context5.t0=_context5[\"catch\"](1);message=_context5.t0.message;_context5.next=11;return Flash.error(message||'Возникла ошибка');case 11:case\"end\":return _context5.stop();}}},_marked5,null,[[1,6]]);}","map":{"version":3,"sources":["C:/Users/Hovsep/Desktop/local/diflow_react/packages/app/src/pages/contractors/store/sagas/contractorGroups.effect.ts"],"names":["contractorGroupsEffect","getContractorGroupsWorker","deleteContractorGroupWorker","getNoContractorGroupsWorker","addContractorToGroupWorker","takeLatest","put","getContractorGroups","setContractorGroups","deleteContractorGroup","getNoContractorGroups","setNoContractorGroups","addContractorToGroup","Flash","ContractorApiServices","payload","id","offset","limit","res","currentContractor","groups","message","error","inverseJoin","newGroups"],"mappings":"oNAaiBA,sB,iDAePC,yB,iDAoBAC,2B,iDAeAC,2B,iDAkBAC,0B,EAjFV,OAASC,UAAT,CAAqBC,GAArB,KAAgC,oBAAhC,CAEA,OACEC,mBADF,CAEEC,mBAFF,CAGEC,qBAHF,CAIEC,qBAJF,CAKEC,qBALF,CAMEC,oBANF,KAOO,YAPP,CAQA,OAASC,KAAT,KAAsB,gCAAtB,CACA,OAASC,qBAAT,KAAsC,gCAAtC,CAEA,MAAO,SAAUd,CAAAA,sBAAV,kJACL,MAAMK,CAAAA,UAAU,CAACE,mBAAD,CAAsBN,yBAAtB,CAAhB,CADK,uBAEL,MAAMI,CAAAA,UAAU,CAACI,qBAAD,CAAwBP,2BAAxB,CAAhB,CAFK,uBAGL,MAAMG,CAAAA,UAAU,CAACK,qBAAD,CAAwBP,2BAAxB,CAAhB,CAHK,uBAIL,MAAME,CAAAA,UAAU,CAACO,oBAAD,CAAuBR,0BAAvB,CAAhB,CAJK,sDAcP,kCACA,QAAUH,CAAAA,yBAAV,oLAAsCc,OAAtC,MAAsCA,OAAtC,kBAEYC,EAFZ,CAEkCD,OAFlC,CAEYC,EAFZ,CAEgBC,MAFhB,CAEkCF,OAFlC,CAEgBE,MAFhB,CAEwBC,KAFxB,CAEkCH,OAFlC,CAEwBG,KAFxB,kBAGgB,MAAMJ,CAAAA,qBAAqB,CAACP,mBAAtB,CAA0C,CAC1DS,EAAE,CAAFA,EAD0D,CAE1DC,MAAM,CAANA,MAF0D,CAG1DC,KAAK,CAALA,KAH0D,CAA1C,CAAN,CAHhB,OAGUC,GAHV,iCAQI,MAAMb,CAAAA,GAAG,CAACE,mBAAmB,CAAC,CAAEY,iBAAiB,CAAE,CAAEC,MAAM,CAAEF,GAAV,CAArB,CAAD,CAApB,CAAT,CARJ,4FASaG,OATb,cASaA,OATb,mBAUI,MAAMT,CAAAA,KAAK,CAACU,KAAN,CAAYD,OAAO,EAAI,iBAAvB,CAAN,CAVJ,uEAmBA,qCACA,QAAUpB,CAAAA,2BAAV,mKAAwCa,OAAxC,OAAwCA,OAAxC,mCAEI,MAAMD,CAAAA,qBAAqB,CAACL,qBAAtB,CAA4CM,OAA5C,CAAN,CAFJ,0FAGaO,OAHb,cAGaA,OAHb,mBAII,MAAMT,CAAAA,KAAK,CAACU,KAAN,CAAYD,OAAO,EAAI,iBAAvB,CAAN,CAJJ,sEAcA,qDACA,QAAUnB,CAAAA,2BAAV,uLAAwCY,OAAxC,OAAwCA,OAAxC,kBAEYC,EAFZ,CAEkCD,OAFlC,CAEYC,EAFZ,CAEgBC,MAFhB,CAEkCF,OAFlC,CAEgBE,MAFhB,CAEwBC,KAFxB,CAEkCH,OAFlC,CAEwBG,KAFxB,kBAGgB,MAAMJ,CAAAA,qBAAqB,CAACP,mBAAtB,CAA0C,CAC1DS,EAAE,CAAFA,EAD0D,CAE1DC,MAAM,CAANA,MAF0D,CAG1DC,KAAK,CAALA,KAH0D,CAI1DM,WAAW,CAAE,IAJ6C,CAA1C,CAAN,CAHhB,OAGUL,GAHV,iCASI,MAAMb,CAAAA,GAAG,CAACK,qBAAqB,CAAC,CAAES,iBAAiB,CAAE,CAAEK,SAAS,CAAEN,GAAb,CAArB,CAAD,CAAtB,CAAT,CATJ,4FAUaG,OAVb,cAUaA,OAVb,mBAWI,MAAMT,CAAAA,KAAK,CAACU,KAAN,CAAYD,OAAO,EAAI,iBAAvB,CAAN,CAXJ,uEAiBA,uCACA,QAAUlB,CAAAA,0BAAV,kKAAuCW,OAAvC,OAAuCA,OAAvC,mCAEI,MAAMD,CAAAA,qBAAqB,CAACF,oBAAtB,CAA2CG,OAA3C,CAAN,CAFJ,0FAGaO,OAHb,cAGaA,OAHb,mBAII,MAAMT,CAAAA,KAAK,CAACU,KAAN,CAAYD,OAAO,EAAI,iBAAvB,CAAN,CAJJ","sourcesContent":["import { takeLatest, put } from 'redux-saga/effects';\r\n\r\nimport {\r\n  getContractorGroups,\r\n  setContractorGroups,\r\n  deleteContractorGroup,\r\n  getNoContractorGroups,\r\n  setNoContractorGroups,\r\n  addContractorToGroup\r\n} from '../actions';\r\nimport { Flash } from '../../../../common/flash/Flash';\r\nimport { ContractorApiServices } from '../../services/contractors.api';\r\n\r\nexport function* contractorGroupsEffect() {\r\n  yield takeLatest(getContractorGroups, getContractorGroupsWorker);\r\n  yield takeLatest(deleteContractorGroup, deleteContractorGroupWorker);\r\n  yield takeLatest(getNoContractorGroups, getNoContractorGroupsWorker);\r\n  yield takeLatest(addContractorToGroup, addContractorToGroupWorker);\r\n}\r\n\r\ntype GetContractorGroupPayload = {\r\n  id: number;\r\n  inverseJoin?: boolean;\r\n  offset?: number;\r\n  limit?: number;\r\n};\r\n\r\n/** Получить группы контрагента */\r\nfunction* getContractorGroupsWorker({ payload }: { payload: GetContractorGroupPayload }) {\r\n  try {\r\n    const { id, offset, limit } = payload;\r\n    const res = yield ContractorApiServices.getContractorGroups({\r\n      id,\r\n      offset,\r\n      limit\r\n    });\r\n    yield put(setContractorGroups({ currentContractor: { groups: res } }));\r\n  } catch ({ message }) {\r\n    yield Flash.error(message || 'Возникла ошибка');\r\n  }\r\n}\r\n\r\ntype DeleteContractorGroup = {\r\n  groupId: number;\r\n  contractorId: number;\r\n};\r\n\r\n/** удаление контрагента из группы */\r\nfunction* deleteContractorGroupWorker({ payload }: { payload: DeleteContractorGroup }) {\r\n  try {\r\n    yield ContractorApiServices.deleteContractorGroup(payload);\r\n  } catch ({ message }) {\r\n    yield Flash.error(message || 'Возникла ошибка');\r\n  }\r\n}\r\n\r\ntype GetNoContractorGroupPayload = {\r\n  id: number;\r\n  inverseJoin?: boolean;\r\n  offset?: number;\r\n  limit?: number;\r\n};\r\n/** получение групп, в которых еще нет контрагента */\r\nfunction* getNoContractorGroupsWorker({ payload }: { payload: GetNoContractorGroupPayload }) {\r\n  try {\r\n    const { id, offset, limit } = payload;\r\n    const res = yield ContractorApiServices.getContractorGroups({\r\n      id,\r\n      offset,\r\n      limit,\r\n      inverseJoin: true\r\n    });\r\n    yield put(setNoContractorGroups({ currentContractor: { newGroups: res } }));\r\n  } catch ({ message }) {\r\n    yield Flash.error(message || 'Возникла ошибка');\r\n  }\r\n}\r\n\r\ntype Payload = { groupId: number; contractorId: number };\r\n\r\n/** добавление пользователя в группу */\r\nfunction* addContractorToGroupWorker({ payload }: { payload: Payload }) {\r\n  try {\r\n    yield ContractorApiServices.addContractorToGroup(payload);\r\n  } catch ({ message }) {\r\n    yield Flash.error(message || 'Возникла ошибка');\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}